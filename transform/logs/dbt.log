[0m01:00:09.318978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafacde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf791990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf791cd0>]}


============================== 01:00:09.323348 | ae773a85-4304-4662-b90c-1de66c4a9683 ==============================
[0m01:00:09.323348 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:00:09.323739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/transform/logs', 'profiles_dir': '/opt/transform/profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:09.371894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae773a85-4304-4662-b90c-1de66c4a9683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf83dc50>]}
[0m01:00:09.377954 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:09.378764 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:09.379813 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09104275, "process_user_time": 0.6873, "process_kernel_time": 0.069231, "process_mem_max_rss": "96896", "process_in_blocks": "6440", "process_out_blocks": "1659"}
[0m01:00:09.380129 [debug] [MainThread]: Command `dbt deps` succeeded at 01:00:09.380048 after 0.09 seconds
[0m01:00:09.380341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf791390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7fcf90>]}
[0m01:00:09.380543 [debug] [MainThread]: Flushing usage events
[0m01:00:10.190299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc476d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce44190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce44950>]}


============================== 01:00:10.191985 | 4806f7ff-ebe1-45d3-85c9-bba317527985 ==============================
[0m01:00:10.191985 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:00:10.192399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/transform/profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/transform/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:00:10.293652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb04290>]}
[0m01:00:10.318825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efda110>]}
[0m01:00:10.319372 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m01:00:10.350980 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:00:10.351546 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:00:10.351798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb05850>]}
[0m01:00:10.738593 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:00:10.738970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f9a590>]}
[0m01:00:10.861013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9710c450>]}
[0m01:00:10.919467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97be0810>]}
[0m01:00:10.919819 [info ] [MainThread]: Found 3 models, 9 data tests, 421 macros
[0m01:00:10.921150 [info ] [MainThread]: 
[0m01:00:10.921568 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:00:10.924156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:00:10.943140 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:00:10.943451 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:00:10.943658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:10.951020 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m01:00:10.951817 [debug] [ThreadPool]: On list_f1: Close
[0m01:00:10.952959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_silver)
[0m01:00:10.953221 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_silver"
"
[0m01:00:10.956437 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:00:10.956637 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:00:10.956795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:10.960580 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:00:10.961402 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:00:10.961624 [debug] [ThreadPool]: On create_f1_main_silver: BEGIN
[0m01:00:10.961894 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:00:10.962066 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:00:10.962243 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
    
        create schema if not exists "f1"."main_silver"
    
[0m01:00:10.962535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:00:10.962961 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:00:10.963140 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:00:10.963349 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:00:10.964402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:00:10.964572 [debug] [ThreadPool]: On create_f1_main_silver: Close
[0m01:00:10.975053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_silver, now list_f1_main_silver)
[0m01:00:10.977982 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:00:10.978273 [debug] [ThreadPool]: On list_f1_main_silver: BEGIN
[0m01:00:10.978554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:10.982368 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:00:10.982583 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:00:10.982751 [debug] [ThreadPool]: On list_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_silver"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_silver'
    and table_catalog = 'f1'
  
[0m01:00:10.995032 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m01:00:10.995731 [debug] [ThreadPool]: On list_f1_main_silver: ROLLBACK
[0m01:00:10.996133 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_silver'
[0m01:00:10.996322 [debug] [ThreadPool]: On list_f1_main_silver: Close
[0m01:00:10.997517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97194e90>]}
[0m01:00:10.997828 [debug] [MainThread]: Using duckdb connection "master"
[0m01:00:10.998016 [debug] [MainThread]: On master: BEGIN
[0m01:00:10.998208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:11.002297 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m01:00:11.002520 [debug] [MainThread]: On master: COMMIT
[0m01:00:11.002703 [debug] [MainThread]: Using duckdb connection "master"
[0m01:00:11.002887 [debug] [MainThread]: On master: COMMIT
[0m01:00:11.003215 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:00:11.003410 [debug] [MainThread]: On master: Close
[0m01:00:11.004184 [info ] [MainThread]: Concurrency: 8 threads (target='local')
[0m01:00:11.004444 [info ] [MainThread]: 
[0m01:00:11.010582 [debug] [Thread-1 (]: Began running node model.f1_transform.laps
[0m01:00:11.010792 [debug] [Thread-2 (]: Began running node model.f1_transform.results
[0m01:00:11.011005 [debug] [Thread-3 (]: Began running node model.f1_transform.weather
[0m01:00:11.011333 [info ] [Thread-1 (]: 1 of 12 START sql table model main_silver.laps ................................. [RUN]
[0m01:00:11.011712 [info ] [Thread-2 (]: 2 of 12 START sql table model main_silver.results .............................. [RUN]
[0m01:00:11.012085 [info ] [Thread-3 (]: 3 of 12 START sql table model main_silver.weather .............................. [RUN]
[0m01:00:11.012518 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.f1_transform.laps'
[0m01:00:11.013398 [debug] [Thread-1 (]: Began compiling node model.f1_transform.laps
[0m01:00:11.013167 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.f1_transform.weather'
[0m01:00:11.012844 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.f1_transform.results'
[0m01:00:11.017553 [debug] [Thread-2 (]: Began compiling node model.f1_transform.results
[0m01:00:11.017278 [debug] [Thread-3 (]: Began compiling node model.f1_transform.weather
[0m01:00:11.016975 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_transform.laps"
[0m01:00:11.018495 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.results"
[0m01:00:11.019485 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.weather"
[0m01:00:11.021097 [debug] [Thread-1 (]: Began executing node model.f1_transform.laps
[0m01:00:11.033200 [debug] [Thread-2 (]: Began executing node model.f1_transform.results
[0m01:00:11.033398 [debug] [Thread-3 (]: Began executing node model.f1_transform.weather
[0m01:00:11.038242 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_transform.laps"
[0m01:00:11.039760 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.results"
[0m01:00:11.041136 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.weather"
[0m01:00:11.043137 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:00:11.043401 [debug] [Thread-2 (]: On model.f1_transform.results: BEGIN
[0m01:00:11.043557 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:00:11.043726 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:00:11.044012 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:00:11.044187 [debug] [Thread-3 (]: On model.f1_transform.weather: BEGIN
[0m01:00:11.044733 [debug] [Thread-1 (]: On model.f1_transform.laps: BEGIN
[0m01:00:11.046181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:11.045368 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:00:11.049159 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m01:00:11.049333 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:00:11.049752 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m01:00:11.050341 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:00:11.050132 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:00:11.049890 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:00:11.051000 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src;
    );
  
  
[0m01:00:11.050785 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src;
    );
  
  
[0m01:00:11.050532 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src;
    );
  
  
[0m01:00:11.052698 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src;
    );
  
  
[0m01:00:11.052287 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src;
    );
  
  
[0m01:00:11.051869 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src;
    );
  
  
[0m01:00:11.053411 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:00:11.053175 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:00:11.052917 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m01:00:11.053662 [debug] [Thread-2 (]: On model.f1_transform.results: ROLLBACK
[0m01:00:11.053988 [debug] [Thread-1 (]: On model.f1_transform.laps: ROLLBACK
[0m01:00:11.054403 [debug] [Thread-3 (]: On model.f1_transform.weather: ROLLBACK
[0m01:00:11.056200 [debug] [Thread-2 (]: Failed to rollback 'model.f1_transform.results'
[0m01:00:11.057364 [debug] [Thread-1 (]: Failed to rollback 'model.f1_transform.laps'
[0m01:00:11.058493 [debug] [Thread-3 (]: Failed to rollback 'model.f1_transform.weather'
[0m01:00:11.059176 [debug] [Thread-3 (]: On model.f1_transform.weather: Close
[0m01:00:11.058959 [debug] [Thread-1 (]: On model.f1_transform.laps: Close
[0m01:00:11.058706 [debug] [Thread-2 (]: On model.f1_transform.results: Close
[0m01:00:11.060352 [debug] [Thread-3 (]: Runtime Error in model weather (models/silver/weather.sql)
  Parser Error: syntax error at or near ";"
[0m01:00:11.061536 [debug] [Thread-1 (]: Runtime Error in model laps (models/silver/laps.sql)
  Parser Error: syntax error at or near ";"
[0m01:00:11.064160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b47790>]}
[0m01:00:11.064001 [debug] [Thread-2 (]: Runtime Error in model results (models/silver/results.sql)
  Parser Error: syntax error at or near ";"
[0m01:00:11.062554 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b50ad0>]}
[0m01:00:11.064496 [error] [Thread-1 (]: 1 of 12 ERROR creating sql table model main_silver.laps ........................ [[31mERROR[0m in 0.05s]
[0m01:00:11.064813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4806f7ff-ebe1-45d3-85c9-bba317527985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98552390>]}
[0m01:00:11.065306 [error] [Thread-3 (]: 3 of 12 ERROR creating sql table model main_silver.weather ..................... [[31mERROR[0m in 0.05s]
[0m01:00:11.065663 [debug] [Thread-1 (]: Finished running node model.f1_transform.laps
[0m01:00:11.065997 [error] [Thread-2 (]: 2 of 12 ERROR creating sql table model main_silver.results ..................... [[31mERROR[0m in 0.05s]
[0m01:00:11.066447 [debug] [Thread-3 (]: Finished running node model.f1_transform.weather
[0m01:00:11.067222 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:00:11.067455 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:00:11.067632 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:00:11.067870 [debug] [Thread-2 (]: Finished running node model.f1_transform.results
[0m01:00:11.068469 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:00:11.068653 [info ] [Thread-5 (]: 4 of 12 SKIP test not_null_laps_round .......................................... [[33mSKIP[0m]
[0m01:00:11.068847 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:00:11.069062 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:00:11.069322 [info ] [Thread-6 (]: 5 of 12 SKIP test not_null_laps_season ......................................... [[33mSKIP[0m]
[0m01:00:11.069634 [info ] [Thread-7 (]: 6 of 12 SKIP test not_null_laps_session_code ................................... [[33mSKIP[0m]
[0m01:00:11.070145 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:00:11.070345 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:00:11.070538 [info ] [Thread-4 (]: 7 of 12 SKIP test not_null_weather_round ....................................... [[33mSKIP[0m]
[0m01:00:11.070885 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:00:11.071144 [info ] [Thread-1 (]: 8 of 12 SKIP test not_null_weather_season ...................................... [[33mSKIP[0m]
[0m01:00:11.071489 [info ] [Thread-8 (]: 9 of 12 SKIP test not_null_weather_session_code ................................ [[33mSKIP[0m]
[0m01:00:11.071831 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:00:11.072116 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:00:11.072388 [info ] [Thread-3 (]: 10 of 12 SKIP test not_null_results_round ...................................... [[33mSKIP[0m]
[0m01:00:11.072650 [info ] [Thread-2 (]: 11 of 12 SKIP test not_null_results_season ..................................... [[33mSKIP[0m]
[0m01:00:11.072991 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:00:11.073314 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:00:11.073600 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:00:11.073865 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:00:11.074504 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:00:11.074744 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:00:11.075168 [info ] [Thread-5 (]: 12 of 12 SKIP test not_null_results_session_code ............................... [[33mSKIP[0m]
[0m01:00:11.076177 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:00:11.077325 [debug] [MainThread]: Using duckdb connection "master"
[0m01:00:11.077548 [debug] [MainThread]: On master: BEGIN
[0m01:00:11.077726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:11.081878 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m01:00:11.082105 [debug] [MainThread]: On master: COMMIT
[0m01:00:11.082285 [debug] [MainThread]: Using duckdb connection "master"
[0m01:00:11.082440 [debug] [MainThread]: On master: COMMIT
[0m01:00:11.082662 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:00:11.082828 [debug] [MainThread]: On master: Close
[0m01:00:11.083632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:11.083824 [debug] [MainThread]: Connection 'list_f1_main_silver' was properly closed.
[0m01:00:11.083973 [debug] [MainThread]: Connection 'model.f1_transform.laps' was properly closed.
[0m01:00:11.084122 [debug] [MainThread]: Connection 'model.f1_transform.results' was properly closed.
[0m01:00:11.084255 [debug] [MainThread]: Connection 'model.f1_transform.weather' was properly closed.
[0m01:00:11.084519 [info ] [MainThread]: 
[0m01:00:11.084722 [info ] [MainThread]: Finished running 3 table models, 9 data tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m01:00:11.085377 [debug] [MainThread]: Command end result
[0m01:00:11.104674 [info ] [MainThread]: 
[0m01:00:11.105055 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m01:00:11.105428 [info ] [MainThread]: 
[0m01:00:11.105787 [error] [MainThread]:   Runtime Error in model laps (models/silver/laps.sql)
  Parser Error: syntax error at or near ";"
[0m01:00:11.106039 [info ] [MainThread]: 
[0m01:00:11.106353 [error] [MainThread]:   Runtime Error in model weather (models/silver/weather.sql)
  Parser Error: syntax error at or near ";"
[0m01:00:11.106597 [info ] [MainThread]: 
[0m01:00:11.106893 [error] [MainThread]:   Runtime Error in model results (models/silver/results.sql)
  Parser Error: syntax error at or near ";"
[0m01:00:11.107156 [info ] [MainThread]: 
[0m01:00:11.107427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=9 TOTAL=12
[0m01:00:11.108108 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.9411483, "process_user_time": 1.366895, "process_kernel_time": 0.104681, "process_mem_max_rss": "147812", "process_in_blocks": "3624", "process_out_blocks": "3292", "command_success": false}
[0m01:00:11.108395 [debug] [MainThread]: Command `dbt build` failed at 01:00:11.108345 after 0.94 seconds
[0m01:00:11.108628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca997d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc53f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee1a850>]}
[0m01:00:11.108851 [debug] [MainThread]: Flushing usage events
[0m01:01:33.560527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a513350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8778d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877a9f90>]}


============================== 01:01:33.567793 | f86e2f58-1dbb-4581-ac0a-05cfb5218926 ==============================
[0m01:01:33.567793 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:01:33.568184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/transform/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:01:33.609260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f86e2f58-1dbb-4581-ac0a-05cfb5218926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877c7cd0>]}
[0m01:01:33.616833 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:01:33.618081 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:01:33.618635 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.080881335, "process_user_time": 0.689286, "process_kernel_time": 0.113707, "process_mem_max_rss": "97128", "process_out_blocks": "1659", "process_in_blocks": "0"}
[0m01:01:33.618912 [debug] [MainThread]: Command `dbt deps` succeeded at 01:01:33.618859 after 0.08 seconds
[0m01:01:33.619142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877a9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87770350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b20750>]}
[0m01:01:33.619370 [debug] [MainThread]: Flushing usage events
[0m01:01:34.433245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25f5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2796e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2795ed0>]}


============================== 01:01:34.434800 | 4913d45d-2923-4eb1-9aa3-eba0a05c0824 ==============================
[0m01:01:34.434800 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:01:34.435124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/transform/profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:01:34.524782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2615450>]}
[0m01:01:34.547946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b8e650>]}
[0m01:01:34.548432 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m01:01:34.578776 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:01:34.643836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:01:34.644248 [debug] [MainThread]: Partial parsing: updated file: f1_transform://models/silver/weather.sql
[0m01:01:34.644569 [debug] [MainThread]: Partial parsing: updated file: f1_transform://models/silver/laps.sql
[0m01:01:34.644844 [debug] [MainThread]: Partial parsing: updated file: f1_transform://models/silver/results.sql
[0m01:01:34.743032 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:01:34.743456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdf9410>]}
[0m01:01:34.822829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa468ef50>]}
[0m01:01:34.875802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afe6750>]}
[0m01:01:34.876129 [info ] [MainThread]: Found 3 models, 9 data tests, 421 macros
[0m01:01:34.877422 [info ] [MainThread]: 
[0m01:01:34.877863 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:01:34.880458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:01:34.899040 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:01:34.899350 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:01:34.899559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:34.906060 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:01:34.906845 [debug] [ThreadPool]: On list_f1: Close
[0m01:01:34.908136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_silver)
[0m01:01:34.908408 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_silver"
"
[0m01:01:34.911615 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:01:34.911843 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:01:34.912012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:34.916513 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:01:34.917243 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:01:34.917441 [debug] [ThreadPool]: On create_f1_main_silver: BEGIN
[0m01:01:34.917690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:01:34.917866 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:01:34.918065 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
    
        create schema if not exists "f1"."main_silver"
    
[0m01:01:34.918394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:01:34.918839 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:01:34.919024 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:01:34.919181 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:01:34.919427 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:01:34.919616 [debug] [ThreadPool]: On create_f1_main_silver: Close
[0m01:01:34.920961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_silver, now list_f1_main_silver)
[0m01:01:34.923689 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:01:34.923893 [debug] [ThreadPool]: On list_f1_main_silver: BEGIN
[0m01:01:34.924044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:34.928356 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:01:34.928585 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:01:34.928778 [debug] [ThreadPool]: On list_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_silver"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_silver'
    and table_catalog = 'f1'
  
[0m01:01:34.945700 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:01:34.946418 [debug] [ThreadPool]: On list_f1_main_silver: ROLLBACK
[0m01:01:34.946821 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_silver'
[0m01:01:34.947018 [debug] [ThreadPool]: On list_f1_main_silver: Close
[0m01:01:34.948400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2644790>]}
[0m01:01:34.948724 [debug] [MainThread]: Using duckdb connection "master"
[0m01:01:34.948916 [debug] [MainThread]: On master: BEGIN
[0m01:01:34.949100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:34.954270 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:01:34.954546 [debug] [MainThread]: On master: COMMIT
[0m01:01:34.954708 [debug] [MainThread]: Using duckdb connection "master"
[0m01:01:34.954857 [debug] [MainThread]: On master: COMMIT
[0m01:01:34.955108 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:01:34.955314 [debug] [MainThread]: On master: Close
[0m01:01:34.956184 [info ] [MainThread]: Concurrency: 8 threads (target='local')
[0m01:01:34.956459 [info ] [MainThread]: 
[0m01:01:34.962651 [debug] [Thread-1 (]: Began running node model.f1_transform.laps
[0m01:01:34.962861 [debug] [Thread-2 (]: Began running node model.f1_transform.results
[0m01:01:34.963021 [debug] [Thread-3 (]: Began running node model.f1_transform.weather
[0m01:01:34.963345 [info ] [Thread-1 (]: 1 of 12 START sql table model main_silver.laps ................................. [RUN]
[0m01:01:34.963720 [info ] [Thread-2 (]: 2 of 12 START sql table model main_silver.results .............................. [RUN]
[0m01:01:34.964123 [info ] [Thread-3 (]: 3 of 12 START sql table model main_silver.weather .............................. [RUN]
[0m01:01:34.964535 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.f1_transform.laps'
[0m01:01:34.964849 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.f1_transform.results'
[0m01:01:34.965153 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.f1_transform.weather'
[0m01:01:34.965420 [debug] [Thread-1 (]: Began compiling node model.f1_transform.laps
[0m01:01:34.965685 [debug] [Thread-2 (]: Began compiling node model.f1_transform.results
[0m01:01:34.965925 [debug] [Thread-3 (]: Began compiling node model.f1_transform.weather
[0m01:01:35.000761 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_transform.laps"
[0m01:01:35.001769 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.results"
[0m01:01:35.002668 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.weather"
[0m01:01:35.003964 [debug] [Thread-3 (]: Began executing node model.f1_transform.weather
[0m01:01:35.010675 [debug] [Thread-1 (]: Began executing node model.f1_transform.laps
[0m01:01:35.020616 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.weather"
[0m01:01:35.020820 [debug] [Thread-2 (]: Began executing node model.f1_transform.results
[0m01:01:35.022332 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_transform.laps"
[0m01:01:35.024292 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.results"
[0m01:01:35.025772 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:01:35.026279 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:01:35.026489 [debug] [Thread-3 (]: On model.f1_transform.weather: BEGIN
[0m01:01:35.026759 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:01:35.026985 [debug] [Thread-1 (]: On model.f1_transform.laps: BEGIN
[0m01:01:35.027243 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:01:35.027505 [debug] [Thread-2 (]: On model.f1_transform.results: BEGIN
[0m01:01:35.027747 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:01:35.028337 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:01:35.033273 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:01:35.033497 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m01:01:35.033704 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m01:01:35.033821 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:01:35.034063 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:01:35.034329 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:01:35.034598 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:01:35.034883 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:01:35.035162 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:01:35.412492 [debug] [Thread-3 (]: SQL status: OK in 0.376 seconds
[0m01:01:35.417490 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:01:35.420729 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather__dbt_tmp" rename to "weather"
[0m01:01:35.428641 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:01:35.459051 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:01:35.464444 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:01:35.465571 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:01:35.552059 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m01:01:35.557981 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:01:35.562499 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
drop table if exists "f1"."main_silver"."weather__dbt_backup" cascade
[0m01:01:35.564551 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:01:35.569403 [debug] [Thread-3 (]: On model.f1_transform.weather: Close
[0m01:01:35.577930 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5ec9d0>]}
[0m01:01:35.580661 [info ] [Thread-3 (]: 3 of 12 OK created sql table model main_silver.weather ......................... [[32mOK[0m in 0.61s]
[0m01:01:35.581703 [debug] [Thread-3 (]: Finished running node model.f1_transform.weather
[0m01:01:35.583445 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:01:35.583646 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:01:35.583808 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:01:35.585499 [info ] [Thread-5 (]: 4 of 12 START test not_null_weather_round ...................................... [RUN]
[0m01:01:35.587555 [info ] [Thread-6 (]: 5 of 12 START test not_null_weather_season ..................................... [RUN]
[0m01:01:35.588606 [info ] [Thread-7 (]: 6 of 12 START test not_null_weather_session_code ............................... [RUN]
[0m01:01:35.592448 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_f1_main_silver, now test.f1_transform.not_null_weather_round.80e2ff036f)
[0m01:01:35.595166 [debug] [Thread-6 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:01:35.597173 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:01:35.608727 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:01:35.600598 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:01:35.600004 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:01:35.626134 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:01:35.629488 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:01:35.632024 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:01:35.639504 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:01:35.656530 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:01:35.658654 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:01:35.658902 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:01:35.660175 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:01:35.662970 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:01:35.669270 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:01:35.674975 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: BEGIN
[0m01:01:35.675729 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:01:35.677940 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m01:01:35.670512 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:01:35.675373 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:01:35.685676 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:01:35.687728 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: BEGIN
[0m01:01:35.688773 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: BEGIN
[0m01:01:35.690894 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."weather"
where session_code is null



      
    ) dbt_internal_test
[0m01:01:35.691858 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m01:01:35.694855 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:01:35.697606 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m01:01:35.699517 [debug] [Thread-6 (]: SQL status: OK in 0.008 seconds
[0m01:01:35.711322 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:01:35.709169 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: ROLLBACK
[0m01:01:35.703494 [debug] [Thread-5 (]: SQL status: OK in 0.010 seconds
[0m01:01:35.714612 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_season.773def5ec8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."weather"
where season is null



      
    ) dbt_internal_test
[0m01:01:35.716159 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:01:35.716819 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:01:35.719495 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:01:35.720573 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: Close
[0m01:01:35.721562 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_round.80e2ff036f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."weather"
where round is null



      
    ) dbt_internal_test
[0m01:01:35.723003 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: ROLLBACK
[0m01:01:35.730070 [info ] [Thread-7 (]: 6 of 12 PASS not_null_weather_session_code ..................................... [[32mPASS[0m in 0.13s]
[0m01:01:35.734252 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m01:01:35.736584 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:01:35.738131 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:01:35.741189 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: ROLLBACK
[0m01:01:35.745699 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:01:35.742163 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: Close
[0m01:01:35.747503 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: Close
[0m01:01:35.751688 [info ] [Thread-6 (]: 5 of 12 PASS not_null_weather_season ........................................... [[32mPASS[0m in 0.16s]
[0m01:01:35.752651 [info ] [Thread-5 (]: 4 of 12 PASS not_null_weather_round ............................................ [[32mPASS[0m in 0.16s]
[0m01:01:35.757977 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:01:35.761638 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:01:35.801116 [debug] [Thread-2 (]: SQL status: OK in 0.765 seconds
[0m01:01:35.804719 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:01:35.808941 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results__dbt_tmp" rename to "results"
[0m01:01:35.810406 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:01:35.812831 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:01:35.813147 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:01:35.814951 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:01:35.855509 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m01:01:35.858144 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:01:35.858631 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
drop table if exists "f1"."main_silver"."results__dbt_backup" cascade
[0m01:01:35.861863 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:01:35.865404 [debug] [Thread-2 (]: On model.f1_transform.results: Close
[0m01:01:35.868591 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f54b810>]}
[0m01:01:35.871062 [info ] [Thread-2 (]: 2 of 12 OK created sql table model main_silver.results ......................... [[32mOK[0m in 0.90s]
[0m01:01:35.873229 [debug] [Thread-2 (]: Finished running node model.f1_transform.results
[0m01:01:35.875889 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:01:35.876116 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:01:35.876322 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:01:35.879549 [info ] [Thread-4 (]: 7 of 12 START test not_null_results_round ...................................... [RUN]
[0m01:01:35.880352 [info ] [Thread-3 (]: 8 of 12 START test not_null_results_season ..................................... [RUN]
[0m01:01:35.882458 [info ] [Thread-8 (]: 9 of 12 START test not_null_results_session_code ............................... [RUN]
[0m01:01:35.883490 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:01:35.885712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_transform.weather, now test.f1_transform.not_null_results_season.4571c4d0da)
[0m01:01:35.887907 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:01:35.889749 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:01:35.891480 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:01:35.894100 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:01:35.899933 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:01:35.904696 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:01:35.908123 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:01:35.909156 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:01:35.910585 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:01:35.910790 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:01:35.911224 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:01:35.913759 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:01:35.915070 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:01:35.915256 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:01:35.916370 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: BEGIN
[0m01:01:35.916577 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:01:35.916827 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:01:35.917117 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:01:35.917311 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: BEGIN
[0m01:01:35.917842 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:01:35.918554 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:01:35.918313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:01:35.918030 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: BEGIN
[0m01:01:35.918791 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_round.69e7ee2263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."results"
where round is null



      
    ) dbt_internal_test
[0m01:01:35.919230 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:01:35.920761 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:01:35.921945 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:01:35.922831 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_season.4571c4d0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."results"
where season is null



      
    ) dbt_internal_test
[0m01:01:35.922591 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m01:01:35.922104 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:01:35.923571 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:01:35.923750 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:01:35.924704 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: ROLLBACK
[0m01:01:35.926250 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:01:35.925826 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_session_code.564091e2b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."results"
where session_code is null



      
    ) dbt_internal_test
[0m01:01:35.925517 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: ROLLBACK
[0m01:01:35.927133 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_results_season.4571c4d0da'
[0m01:01:35.927543 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: Close
[0m01:01:35.928140 [info ] [Thread-3 (]: 8 of 12 PASS not_null_results_season ........................................... [[32mPASS[0m in 0.04s]
[0m01:01:35.927744 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:01:35.926514 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: Close
[0m01:01:35.929898 [info ] [Thread-4 (]: 7 of 12 PASS not_null_results_round ............................................ [[32mPASS[0m in 0.05s]
[0m01:01:35.929479 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: ROLLBACK
[0m01:01:35.928572 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:01:35.930408 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:01:35.930798 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:01:35.931487 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: Close
[0m01:01:35.931856 [info ] [Thread-8 (]: 9 of 12 PASS not_null_results_session_code ..................................... [[32mPASS[0m in 0.04s]
[0m01:01:35.932389 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:01:36.056004 [debug] [Thread-1 (]: SQL status: OK in 1.020 seconds
[0m01:01:36.057844 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:01:36.058105 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps__dbt_tmp" rename to "laps"
[0m01:01:36.058691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:01:36.059427 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:01:36.059660 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:01:36.059890 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:01:36.452618 [debug] [Thread-1 (]: SQL status: OK in 0.392 seconds
[0m01:01:36.454128 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:01:36.454393 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
drop table if exists "f1"."main_silver"."laps__dbt_backup" cascade
[0m01:01:36.454866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:01:36.455617 [debug] [Thread-1 (]: On model.f1_transform.laps: Close
[0m01:01:36.707208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4913d45d-2923-4eb1-9aa3-eba0a05c0824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f767d0>]}
[0m01:01:36.707717 [info ] [Thread-1 (]: 1 of 12 OK created sql table model main_silver.laps ............................ [[32mOK[0m in 1.74s]
[0m01:01:36.708170 [debug] [Thread-1 (]: Finished running node model.f1_transform.laps
[0m01:01:36.708768 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:01:36.708946 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:01:36.709108 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:01:36.709339 [info ] [Thread-6 (]: 10 of 12 START test not_null_laps_round ........................................ [RUN]
[0m01:01:36.709690 [info ] [Thread-5 (]: 11 of 12 START test not_null_laps_season ....................................... [RUN]
[0m01:01:36.710032 [info ] [Thread-2 (]: 12 of 12 START test not_null_laps_session_code ................................. [RUN]
[0m01:01:36.710376 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_season.773def5ec8, now test.f1_transform.not_null_laps_round.c55865a754)
[0m01:01:36.710673 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_round.80e2ff036f, now test.f1_transform.not_null_laps_season.6c89aefec5)
[0m01:01:36.710970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_transform.results, now test.f1_transform.not_null_laps_session_code.ccd0209ff1)
[0m01:01:36.711210 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_laps_round.c55865a754
[0m01:01:36.711492 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:01:36.711741 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:01:36.713891 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:01:36.715889 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:01:36.718050 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:01:36.719016 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_laps_round.c55865a754
[0m01:01:36.720203 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:01:36.720453 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:01:36.720619 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:01:36.721824 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:01:36.722941 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:01:36.723141 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:01:36.723658 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: BEGIN
[0m01:01:36.723971 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:01:36.724123 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:01:36.724379 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:01:36.724505 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: BEGIN
[0m01:01:36.725027 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: BEGIN
[0m01:01:36.728136 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:01:36.728448 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:01:36.731276 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m01:01:36.732092 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:01:36.731928 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:01:36.731488 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m01:01:36.732833 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:01:36.732631 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:01:36.732336 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_round.c55865a754"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."laps"
where round is null



      
    ) dbt_internal_test
[0m01:01:36.733022 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_season.6c89aefec5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."laps"
where season is null



      
    ) dbt_internal_test
[0m01:01:36.733270 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."laps"
where session_code is null



      
    ) dbt_internal_test
[0m01:01:36.733936 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:01:36.734459 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m01:01:36.734674 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:01:36.735428 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: ROLLBACK
[0m01:01:36.737062 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_laps_round.c55865a754'
[0m01:01:36.736764 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: ROLLBACK
[0m01:01:36.736107 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: ROLLBACK
[0m01:01:36.737881 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_laps_season.6c89aefec5'
[0m01:01:36.737621 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_laps_session_code.ccd0209ff1'
[0m01:01:36.737275 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: Close
[0m01:01:36.738712 [info ] [Thread-6 (]: 10 of 12 PASS not_null_laps_round .............................................. [[32mPASS[0m in 0.03s]
[0m01:01:36.738340 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: Close
[0m01:01:36.738085 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: Close
[0m01:01:36.739047 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:01:36.739443 [info ] [Thread-2 (]: 12 of 12 PASS not_null_laps_session_code ....................................... [[32mPASS[0m in 0.03s]
[0m01:01:36.740118 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:01:36.740584 [info ] [Thread-5 (]: 11 of 12 PASS not_null_laps_season ............................................. [[32mPASS[0m in 0.03s]
[0m01:01:36.741031 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:01:36.742281 [debug] [MainThread]: Using duckdb connection "master"
[0m01:01:36.742524 [debug] [MainThread]: On master: BEGIN
[0m01:01:36.742692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:36.747990 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:01:36.748231 [debug] [MainThread]: On master: COMMIT
[0m01:01:36.748466 [debug] [MainThread]: Using duckdb connection "master"
[0m01:01:36.748657 [debug] [MainThread]: On master: COMMIT
[0m01:01:36.748950 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:01:36.749143 [debug] [MainThread]: On master: Close
[0m01:01:36.750053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:36.750253 [debug] [MainThread]: Connection 'test.f1_transform.not_null_laps_season.6c89aefec5' was properly closed.
[0m01:01:36.750431 [debug] [MainThread]: Connection 'model.f1_transform.laps' was properly closed.
[0m01:01:36.750609 [debug] [MainThread]: Connection 'test.f1_transform.not_null_laps_session_code.ccd0209ff1' was properly closed.
[0m01:01:36.750753 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_season.4571c4d0da' was properly closed.
[0m01:01:36.750902 [debug] [MainThread]: Connection 'test.f1_transform.not_null_laps_round.c55865a754' was properly closed.
[0m01:01:36.751070 [debug] [MainThread]: Connection 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a' was properly closed.
[0m01:01:36.751235 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_round.69e7ee2263' was properly closed.
[0m01:01:36.751391 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_session_code.564091e2b6' was properly closed.
[0m01:01:36.751642 [info ] [MainThread]: 
[0m01:01:36.751897 [info ] [MainThread]: Finished running 3 table models, 9 data tests in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m01:01:36.753015 [debug] [MainThread]: Command end result
[0m01:01:36.784520 [info ] [MainThread]: 
[0m01:01:36.784839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:01:36.785159 [info ] [MainThread]: 
[0m01:01:36.785381 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:01:36.785990 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.374572, "process_user_time": 2.141135, "process_kernel_time": 0.441673, "process_mem_max_rss": "249992", "process_out_blocks": "42660", "process_in_blocks": "0"}
[0m01:01:36.786265 [debug] [MainThread]: Command `dbt build` succeeded at 01:01:36.786212 after 2.37 seconds
[0m01:01:36.786512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73504d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7350490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd34f50>]}
[0m01:01:36.786737 [debug] [MainThread]: Flushing usage events
[0m01:09:10.600297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05ded10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07d3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07d3550>]}


============================== 01:09:10.604612 | 7565e504-0b20-4c17-96ca-b7358278ec8f ==============================
[0m01:09:10.604612 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:09:10.604972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/transform/profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/transform/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:09:10.650023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7565e504-0b20-4c17-96ca-b7358278ec8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06add90>]}
[0m01:09:10.660585 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:09:10.661689 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:09:10.662656 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.090474166, "process_user_time": 0.714642, "process_kernel_time": 0.119954, "process_mem_max_rss": "96464", "process_in_blocks": "100688", "process_out_blocks": "1659"}
[0m01:09:10.662960 [debug] [MainThread]: Command `dbt deps` succeeded at 01:09:10.662891 after 0.09 seconds
[0m01:09:10.663206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05e8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa063fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52f84d0>]}
[0m01:09:10.663435 [debug] [MainThread]: Flushing usage events
[0m01:09:11.527121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82447e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8260a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82804650>]}


============================== 01:09:11.528690 | 2a17475d-d1ec-4096-a476-23483758a86b ==============================
[0m01:09:11.528690 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:09:11.528996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/transform/logs', 'version_check': 'True', 'profiles_dir': '/opt/transform/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:09:11.684242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f39e9d0>]}
[0m01:09:11.707368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84986910>]}
[0m01:09:11.707868 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m01:09:11.743781 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:09:11.786699 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:09:11.787124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8392ead0>]}
[0m01:09:12.177493 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:09:12.177885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbcb8d0>]}
[0m01:09:12.298087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb47990>]}
[0m01:09:12.356319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b791fd0>]}
[0m01:09:12.356636 [info ] [MainThread]: Found 5 models, 17 data tests, 422 macros
[0m01:09:12.358204 [info ] [MainThread]: 
[0m01:09:12.358622 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:09:12.361430 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:09:12.361783 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:09:12.391209 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:09:12.391431 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:09:12.391656 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:09:12.391901 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:09:12.392130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:12.392345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:12.420823 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m01:09:12.421076 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m01:09:12.421952 [debug] [ThreadPool]: On list_f1: Close
[0m01:09:12.422649 [debug] [ThreadPool]: On list_f1: Close
[0m01:09:12.424116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_gold)
[0m01:09:12.424516 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_gold"
"
[0m01:09:12.424291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_silver)
[0m01:09:12.427820 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:09:12.428103 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_silver"
"
[0m01:09:12.428300 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:09:12.429425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:12.429250 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:09:12.429892 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:09:12.432295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:12.435475 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:09:12.435636 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:09:12.436907 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:09:12.437093 [debug] [ThreadPool]: On create_f1_main_silver: BEGIN
[0m01:09:12.436325 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:09:12.437539 [debug] [ThreadPool]: On create_f1_main_gold: BEGIN
[0m01:09:12.437372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:09:12.437902 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:09:12.438056 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
    
        create schema if not exists "f1"."main_silver"
    
[0m01:09:12.437756 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:09:12.438473 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:09:12.438612 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
    
        create schema if not exists "f1"."main_gold"
    
[0m01:09:12.438341 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:09:12.439254 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:09:12.439400 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:09:12.439529 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:09:12.438844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:09:12.440132 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:09:12.440287 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:09:12.440424 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:09:12.439745 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:09:12.440756 [debug] [ThreadPool]: On create_f1_main_silver: Close
[0m01:09:12.441657 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:09:12.441823 [debug] [ThreadPool]: On create_f1_main_gold: Close
[0m01:09:12.467142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_gold, now list_f1_main_gold)
[0m01:09:12.467558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_silver, now list_f1_main_silver)
[0m01:09:12.471628 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:09:12.471815 [debug] [ThreadPool]: On list_f1_main_silver: BEGIN
[0m01:09:12.471968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:12.470222 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:09:12.472468 [debug] [ThreadPool]: On list_f1_main_gold: BEGIN
[0m01:09:12.473144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:12.478559 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m01:09:12.479015 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:09:12.479240 [debug] [ThreadPool]: On list_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_silver"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_silver'
    and table_catalog = 'f1'
  
[0m01:09:12.478846 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:09:12.483281 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:09:12.483496 [debug] [ThreadPool]: On list_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_gold"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_gold'
    and table_catalog = 'f1'
  
[0m01:09:12.496527 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:09:12.497449 [debug] [ThreadPool]: On list_f1_main_silver: ROLLBACK
[0m01:09:12.496693 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m01:09:12.498196 [debug] [ThreadPool]: On list_f1_main_gold: ROLLBACK
[0m01:09:12.498708 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_gold'
[0m01:09:12.498849 [debug] [ThreadPool]: On list_f1_main_gold: Close
[0m01:09:12.498502 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_silver'
[0m01:09:12.499343 [debug] [ThreadPool]: On list_f1_main_silver: Close
[0m01:09:12.500873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f39f210>]}
[0m01:09:12.501188 [debug] [MainThread]: Using duckdb connection "master"
[0m01:09:12.501359 [debug] [MainThread]: On master: BEGIN
[0m01:09:12.501498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:09:12.507055 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m01:09:12.507296 [debug] [MainThread]: On master: COMMIT
[0m01:09:12.507454 [debug] [MainThread]: Using duckdb connection "master"
[0m01:09:12.507601 [debug] [MainThread]: On master: COMMIT
[0m01:09:12.507831 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:09:12.507999 [debug] [MainThread]: On master: Close
[0m01:09:12.508883 [info ] [MainThread]: Concurrency: 8 threads (target='local')
[0m01:09:12.509188 [info ] [MainThread]: 
[0m01:09:12.515137 [debug] [Thread-1 (]: Began running node model.f1_transform.laps
[0m01:09:12.515348 [debug] [Thread-2 (]: Began running node model.f1_transform.results
[0m01:09:12.515530 [debug] [Thread-3 (]: Began running node model.f1_transform.weather
[0m01:09:12.515906 [info ] [Thread-1 (]: 1 of 22 START sql table model main_silver.laps ................................. [RUN]
[0m01:09:12.516350 [info ] [Thread-2 (]: 2 of 22 START sql table model main_silver.results .............................. [RUN]
[0m01:09:12.516728 [info ] [Thread-3 (]: 3 of 22 START sql table model main_silver.weather .............................. [RUN]
[0m01:09:12.517142 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.f1_transform.laps'
[0m01:09:12.517440 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.f1_transform.results'
[0m01:09:12.517736 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.f1_transform.weather'
[0m01:09:12.517935 [debug] [Thread-1 (]: Began compiling node model.f1_transform.laps
[0m01:09:12.518171 [debug] [Thread-2 (]: Began compiling node model.f1_transform.results
[0m01:09:12.518401 [debug] [Thread-3 (]: Began compiling node model.f1_transform.weather
[0m01:09:12.521908 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_transform.laps"
[0m01:09:12.522837 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.results"
[0m01:09:12.523865 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.weather"
[0m01:09:12.525266 [debug] [Thread-1 (]: Began executing node model.f1_transform.laps
[0m01:09:12.525555 [debug] [Thread-2 (]: Began executing node model.f1_transform.results
[0m01:09:12.537168 [debug] [Thread-3 (]: Began executing node model.f1_transform.weather
[0m01:09:12.541801 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_transform.laps"
[0m01:09:12.543296 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.results"
[0m01:09:12.544766 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.weather"
[0m01:09:12.546196 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:09:12.546482 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:09:12.546981 [debug] [Thread-1 (]: On model.f1_transform.laps: BEGIN
[0m01:09:12.546759 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:09:12.546636 [debug] [Thread-2 (]: On model.f1_transform.results: BEGIN
[0m01:09:12.547195 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:09:12.547477 [debug] [Thread-3 (]: On model.f1_transform.weather: BEGIN
[0m01:09:12.547727 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:09:12.548346 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:09:12.553727 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:09:12.554509 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:09:12.554364 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m01:09:12.554174 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m01:09:12.555247 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:09:12.555001 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:09:12.554735 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:09:12.555459 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:09:12.555728 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:09:13.125002 [debug] [Thread-3 (]: SQL status: OK in 0.568 seconds
[0m01:09:13.130152 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:09:13.132136 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather" rename to "weather__dbt_backup"
[0m01:09:13.135913 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:09:13.140933 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:09:13.146295 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather__dbt_tmp" rename to "weather"
[0m01:09:13.150955 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:09:13.177821 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:09:13.184060 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:09:13.190298 [debug] [Thread-2 (]: SQL status: OK in 0.634 seconds
[0m01:09:13.190535 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:09:13.192637 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:09:13.196449 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results" rename to "results__dbt_backup"
[0m01:09:13.201189 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:09:13.204761 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:09:13.206136 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results__dbt_tmp" rename to "results"
[0m01:09:13.208422 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:09:13.211224 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:09:13.213528 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:09:13.214522 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:09:13.261295 [debug] [Thread-3 (]: SQL status: OK in 0.067 seconds
[0m01:09:13.266399 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:09:13.268612 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
drop table if exists "f1"."main_silver"."weather__dbt_backup" cascade
[0m01:09:13.298282 [debug] [Thread-2 (]: SQL status: OK in 0.083 seconds
[0m01:09:13.301578 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:09:13.301776 [debug] [Thread-3 (]: SQL status: OK in 0.031 seconds
[0m01:09:13.307657 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
drop table if exists "f1"."main_silver"."results__dbt_backup" cascade
[0m01:09:13.310709 [debug] [Thread-3 (]: On model.f1_transform.weather: Close
[0m01:09:13.317154 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m01:09:13.319756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1c4150>]}
[0m01:09:13.320643 [debug] [Thread-2 (]: On model.f1_transform.results: Close
[0m01:09:13.322322 [info ] [Thread-3 (]: 3 of 22 OK created sql table model main_silver.weather ......................... [[32mOK[0m in 0.80s]
[0m01:09:13.324198 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a119ed0>]}
[0m01:09:13.325891 [debug] [Thread-3 (]: Finished running node model.f1_transform.weather
[0m01:09:13.327188 [info ] [Thread-2 (]: 2 of 22 OK created sql table model main_silver.results ......................... [[32mOK[0m in 0.81s]
[0m01:09:13.330960 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:09:13.333206 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:09:13.333440 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:09:13.334703 [debug] [Thread-2 (]: Finished running node model.f1_transform.results
[0m01:09:13.335554 [info ] [Thread-5 (]: 4 of 22 START test not_null_weather_round ...................................... [RUN]
[0m01:09:13.338790 [info ] [Thread-6 (]: 5 of 22 START test not_null_weather_season ..................................... [RUN]
[0m01:09:13.342449 [info ] [Thread-7 (]: 6 of 22 START test not_null_weather_session_code ............................... [RUN]
[0m01:09:13.345683 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:09:13.345885 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:09:13.346132 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_f1_main_gold, now test.f1_transform.not_null_weather_round.80e2ff036f)
[0m01:09:13.346339 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:09:13.348264 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly list_f1_main_silver, now test.f1_transform.not_null_weather_season.773def5ec8)
[0m01:09:13.349574 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:09:13.352139 [info ] [Thread-4 (]: 7 of 22 START test not_null_results_round ...................................... [RUN]
[0m01:09:13.354792 [info ] [Thread-3 (]: 8 of 22 START test not_null_results_season ..................................... [RUN]
[0m01:09:13.357192 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:09:13.358170 [info ] [Thread-8 (]: 9 of 22 START test not_null_results_session_code ............................... [RUN]
[0m01:09:13.358551 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:09:13.358927 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:09:13.359416 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:09:13.359765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_transform.weather, now test.f1_transform.not_null_results_season.4571c4d0da)
[0m01:09:13.366055 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:09:13.366552 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:09:13.368685 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:09:13.370693 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:09:13.370984 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:09:13.371317 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:09:13.371977 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:09:13.375011 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:09:13.377123 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:09:13.377527 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:09:13.379472 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:09:13.379778 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:09:13.381750 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:09:13.390462 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:09:13.392201 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:09:13.393020 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:09:13.394202 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:09:13.394567 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:09:13.396264 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:09:13.396501 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:09:13.396953 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:09:13.397107 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:09:13.398352 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:09:13.399232 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:09:13.400611 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:09:13.401068 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:09:13.401252 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: BEGIN
[0m01:09:13.401516 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: BEGIN
[0m01:09:13.403328 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: BEGIN
[0m01:09:13.404375 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:09:13.404838 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: BEGIN
[0m01:09:13.405421 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:09:13.405599 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:09:13.405882 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:09:13.406131 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:09:13.406413 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: BEGIN
[0m01:09:13.406651 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:09:13.406944 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: BEGIN
[0m01:09:13.407745 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.407891 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.409587 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:09:13.408472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:09:13.408906 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.409068 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:09:13.409340 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:09:13.408316 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.411331 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:09:13.410219 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.410446 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:09:13.410905 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.411078 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_round.80e2ff036f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."weather"
where round is null



      
    ) dbt_internal_test
[0m01:09:13.409826 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_season.773def5ec8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."weather"
where season is null



      
    ) dbt_internal_test
[0m01:09:13.411522 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."weather"
where session_code is null



      
    ) dbt_internal_test
[0m01:09:13.411784 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:09:13.412104 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_round.69e7ee2263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."results"
where round is null



      
    ) dbt_internal_test
[0m01:09:13.412388 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:09:13.414454 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.414629 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m01:09:13.414919 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_season.4571c4d0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."results"
where season is null



      
    ) dbt_internal_test
[0m01:09:13.415098 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m01:09:13.415637 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:09:13.415911 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_session_code.564091e2b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."results"
where session_code is null



      
    ) dbt_internal_test
[0m01:09:13.417942 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: ROLLBACK
[0m01:09:13.418709 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: ROLLBACK
[0m01:09:13.419753 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: ROLLBACK
[0m01:09:13.420185 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:09:13.420828 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: ROLLBACK
[0m01:09:13.421553 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:09:13.421880 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:09:13.422270 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:09:13.422615 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:09:13.423549 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: ROLLBACK
[0m01:09:13.423840 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:09:13.424065 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: Close
[0m01:09:13.424848 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: ROLLBACK
[0m01:09:13.425174 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: Close
[0m01:09:13.425525 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: Close
[0m01:09:13.425870 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_results_season.4571c4d0da'
[0m01:09:13.426169 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: Close
[0m01:09:13.427377 [info ] [Thread-6 (]: 5 of 22 PASS not_null_weather_season ........................................... [[32mPASS[0m in 0.08s]
[0m01:09:13.427828 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:09:13.428278 [info ] [Thread-7 (]: 6 of 22 PASS not_null_weather_session_code ..................................... [[32mPASS[0m in 0.08s]
[0m01:09:13.428707 [info ] [Thread-5 (]: 4 of 22 PASS not_null_weather_round ............................................ [[32mPASS[0m in 0.08s]
[0m01:09:13.429002 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: Close
[0m01:09:13.429386 [info ] [Thread-4 (]: 7 of 22 PASS not_null_results_round ............................................ [[32mPASS[0m in 0.07s]
[0m01:09:13.429786 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:09:13.430164 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: Close
[0m01:09:13.430486 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:09:13.430834 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:09:13.431283 [info ] [Thread-3 (]: 8 of 22 PASS not_null_results_season ........................................... [[32mPASS[0m in 0.07s]
[0m01:09:13.431651 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:09:13.432233 [info ] [Thread-8 (]: 9 of 22 PASS not_null_results_session_code ..................................... [[32mPASS[0m in 0.07s]
[0m01:09:13.432999 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:09:13.433527 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:09:13.508536 [debug] [Thread-1 (]: SQL status: OK in 0.953 seconds
[0m01:09:13.513928 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:09:13.514186 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps" rename to "laps__dbt_backup"
[0m01:09:13.514765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:09:13.516277 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:09:13.516519 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps__dbt_tmp" rename to "laps"
[0m01:09:13.516918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:09:13.517565 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:09:13.517794 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:09:13.518017 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:09:13.945452 [debug] [Thread-1 (]: SQL status: OK in 0.427 seconds
[0m01:09:13.946961 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:09:13.947230 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
drop table if exists "f1"."main_silver"."laps__dbt_backup" cascade
[0m01:09:13.950434 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:09:13.951183 [debug] [Thread-1 (]: On model.f1_transform.laps: Close
[0m01:09:14.202309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d42250>]}
[0m01:09:14.202822 [info ] [Thread-1 (]: 1 of 22 OK created sql table model main_silver.laps ............................ [[32mOK[0m in 1.69s]
[0m01:09:14.203196 [debug] [Thread-1 (]: Finished running node model.f1_transform.laps
[0m01:09:14.203840 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:09:14.203995 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:09:14.204184 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:09:14.204391 [info ] [Thread-2 (]: 10 of 22 START test not_null_laps_round ........................................ [RUN]
[0m01:09:14.204701 [info ] [Thread-6 (]: 11 of 22 START test not_null_laps_season ....................................... [RUN]
[0m01:09:14.205021 [info ] [Thread-7 (]: 12 of 22 START test not_null_laps_session_code ................................. [RUN]
[0m01:09:14.205559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_transform.results, now test.f1_transform.not_null_laps_round.c55865a754)
[0m01:09:14.205880 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_season.773def5ec8, now test.f1_transform.not_null_laps_season.6c89aefec5)
[0m01:09:14.206223 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_session_code.2cbdf7ee2a, now test.f1_transform.not_null_laps_session_code.ccd0209ff1)
[0m01:09:14.206466 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_laps_round.c55865a754
[0m01:09:14.206718 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:09:14.206969 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:09:14.209043 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:09:14.211061 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:09:14.213969 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:09:14.215394 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_laps_round.c55865a754
[0m01:09:14.216626 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:09:14.216819 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:09:14.217433 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:09:14.218620 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:09:14.218954 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:09:14.219918 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:09:14.220291 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_round.c55865a754: BEGIN
[0m01:09:14.220892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:09:14.220676 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:09:14.221498 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:09:14.224145 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: BEGIN
[0m01:09:14.224896 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:09:14.224652 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: BEGIN
[0m01:09:14.227471 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m01:09:14.228211 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:09:14.227932 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m01:09:14.227728 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m01:09:14.228989 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:09:14.228837 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m01:09:14.228428 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_season.6c89aefec5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."laps"
where season is null



      
    ) dbt_internal_test
[0m01:09:14.229200 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_round.c55865a754: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_round.c55865a754"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."laps"
where round is null



      
    ) dbt_internal_test
[0m01:09:14.229443 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:09:14.230102 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:09:14.230642 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."laps"
where session_code is null



      
    ) dbt_internal_test
[0m01:09:14.230804 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:09:14.231669 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: ROLLBACK
[0m01:09:14.233218 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_laps_season.6c89aefec5'
[0m01:09:14.232952 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m01:09:14.232619 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_round.c55865a754: ROLLBACK
[0m01:09:14.234428 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_laps_round.c55865a754'
[0m01:09:14.234143 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: ROLLBACK
[0m01:09:14.233434 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: Close
[0m01:09:14.234636 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_round.c55865a754: Close
[0m01:09:14.234942 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_laps_session_code.ccd0209ff1'
[0m01:09:14.235301 [info ] [Thread-6 (]: 11 of 22 PASS not_null_laps_season ............................................. [[32mPASS[0m in 0.03s]
[0m01:09:14.236367 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:09:14.236072 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: Close
[0m01:09:14.235697 [info ] [Thread-2 (]: 10 of 22 PASS not_null_laps_round .............................................. [[32mPASS[0m in 0.03s]
[0m01:09:14.237134 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:09:14.237752 [info ] [Thread-7 (]: 12 of 22 PASS not_null_laps_session_code ....................................... [[32mPASS[0m in 0.03s]
[0m01:09:14.238174 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:09:14.238665 [debug] [Thread-4 (]: Began running node model.f1_transform.driver_session_summary
[0m01:09:14.238957 [info ] [Thread-4 (]: 13 of 22 START sql table model main_gold.driver_session_summary ................ [RUN]
[0m01:09:14.239273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_round.69e7ee2263, now model.f1_transform.driver_session_summary)
[0m01:09:14.239512 [debug] [Thread-4 (]: Began compiling node model.f1_transform.driver_session_summary
[0m01:09:14.241192 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_transform.driver_session_summary"
[0m01:09:14.242096 [debug] [Thread-4 (]: Began executing node model.f1_transform.driver_session_summary
[0m01:09:14.243685 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_transform.driver_session_summary"
[0m01:09:14.244380 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:09:14.244582 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: BEGIN
[0m01:09:14.244773 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:09:14.250986 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m01:09:14.251265 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:09:14.251501 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."driver_session_summary__dbt_tmp"
  
    as (
      WITH laps AS (
  SELECT * FROM "f1"."main_silver"."laps" WHERE lap_time IS NOT NULL
),
driver_base AS (
  SELECT
    season,
    round,
    grand_prix,
    session_code,
    COALESCE(NULLIF(driver, ''), CAST(driver_number AS VARCHAR)) AS driver,
    driver_number,
    team,
    lap_time,
    pit_in_time,
    pit_out_time
  FROM laps
),
ranker AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team, lap_time,
    ROW_NUMBER() OVER (
      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team
      ORDER BY lap_time ASC NULLS LAST
    ) AS rn
  FROM driver_base
),
pb AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps
  FROM ranker
  GROUP BY 1,2,3,4,5,6,7
),
agg AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    COUNT(*) AS laps_total,
    SUM(CASE WHEN pit_in_time IS NULL AND pit_out_time IS NULL THEN 1 ELSE 0 END) AS laps_on_track,
    SUM(CASE WHEN pit_in_time IS NOT NULL OR  pit_out_time IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,
    MIN(lap_time) AS best_lap_time
  FROM driver_base
  GROUP BY 1,2,3,4,5,6,7
)
SELECT
  a.season, a.round, a.grand_prix, a.session_code,
  a.driver, a.driver_number, a.team,
  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,
  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps
FROM agg a
LEFT JOIN pb
  ON  a.season       = pb.season
  AND a.round        = pb.round
  AND a.grand_prix   = pb.grand_prix
  AND a.session_code = pb.session_code
  AND a.driver       = pb.driver
  AND a.driver_number= pb.driver_number
  AND a.team         = pb.team
    );
  
  
[0m01:09:14.256169 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."driver_session_summary__dbt_tmp"
  
    as (
      WITH laps AS (
  SELECT * FROM "f1"."main_silver"."laps" WHERE lap_time IS NOT NULL
),
driver_base AS (
  SELECT
    season,
    round,
    grand_prix,
    session_code,
    COALESCE(NULLIF(driver, ''), CAST(driver_number AS VARCHAR)) AS driver,
    driver_number,
    team,
    lap_time,
    pit_in_time,
    pit_out_time
  FROM laps
),
ranker AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team, lap_time,
    ROW_NUMBER() OVER (
      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team
      ORDER BY lap_time ASC NULLS LAST
    ) AS rn
  FROM driver_base
),
pb AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps
  FROM ranker
  GROUP BY 1,2,3,4,5,6,7
),
agg AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    COUNT(*) AS laps_total,
    SUM(CASE WHEN pit_in_time IS NULL AND pit_out_time IS NULL THEN 1 ELSE 0 END) AS laps_on_track,
    SUM(CASE WHEN pit_in_time IS NOT NULL OR  pit_out_time IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,
    MIN(lap_time) AS best_lap_time
  FROM driver_base
  GROUP BY 1,2,3,4,5,6,7
)
SELECT
  a.season, a.round, a.grand_prix, a.session_code,
  a.driver, a.driver_number, a.team,
  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,
  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps
FROM agg a
LEFT JOIN pb
  ON  a.season       = pb.season
  AND a.round        = pb.round
  AND a.grand_prix   = pb.grand_prix
  AND a.session_code = pb.session_code
  AND a.driver       = pb.driver
  AND a.driver_number= pb.driver_number
  AND a.team         = pb.team
    );
  
  
[0m01:09:14.256542 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m01:09:14.256814 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: ROLLBACK
[0m01:09:14.260815 [debug] [Thread-4 (]: Failed to rollback 'model.f1_transform.driver_session_summary'
[0m01:09:14.261022 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: Close
[0m01:09:14.262998 [debug] [Thread-4 (]: Runtime Error in model driver_session_summary (models/gold/driver_session_summary.sql)
  Binder Error: Referenced column "lap_time" not found in FROM clause!
  Candidate bindings: "laps.laptime", "laps.lapstarttime", "laps.lapnumber", "laps.pitintime", "laps.lapstartdate"
  LINE 12: ...: "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
  
    
      
      
  
      create  table
        "f1"."main_gold"."driver_session_summary__dbt_tmp"
    
      as (
        WITH laps AS (
    SELECT * FROM "f1"."main_silver"."laps" WHERE lap_time IS NOT NULL
                                                     ^
[0m01:09:14.263316 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a17475d-d1ec-4096-a476-23483758a86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d23d10>]}
[0m01:09:14.263654 [error] [Thread-4 (]: 13 of 22 ERROR creating sql table model main_gold.driver_session_summary ....... [[31mERROR[0m in 0.02s]
[0m01:09:14.263986 [debug] [Thread-4 (]: Finished running node model.f1_transform.driver_session_summary
[0m01:09:14.264688 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:09:14.264870 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:09:14.265040 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:09:14.265205 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:09:14.265422 [info ] [Thread-8 (]: 14 of 22 SKIP test not_null_driver_session_summary_driver ...................... [[33mSKIP[0m]
[0m01:09:14.265745 [info ] [Thread-1 (]: 15 of 22 SKIP test not_null_driver_session_summary_round ....................... [[33mSKIP[0m]
[0m01:09:14.266064 [info ] [Thread-5 (]: 16 of 22 SKIP test not_null_driver_session_summary_season ...................... [[33mSKIP[0m]
[0m01:09:14.266387 [info ] [Thread-6 (]: 17 of 22 SKIP test not_null_driver_session_summary_session_code ................ [[33mSKIP[0m]
[0m01:09:14.266743 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:09:14.267002 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:09:14.267270 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:09:14.267511 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:09:14.268205 [debug] [Thread-7 (]: Began running node model.f1_transform.team_event_summary
[0m01:09:14.268407 [info ] [Thread-7 (]: 18 of 22 SKIP relation main_gold.team_event_summary ............................ [[33mSKIP[0m]
[0m01:09:14.268671 [debug] [Thread-7 (]: Finished running node model.f1_transform.team_event_summary
[0m01:09:14.269095 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:09:14.269275 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:09:14.269426 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:09:14.269557 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:09:14.269762 [info ] [Thread-4 (]: 19 of 22 SKIP test not_null_team_event_summary_round ........................... [[33mSKIP[0m]
[0m01:09:14.270059 [info ] [Thread-2 (]: 20 of 22 SKIP test not_null_team_event_summary_season .......................... [[33mSKIP[0m]
[0m01:09:14.270343 [info ] [Thread-8 (]: 21 of 22 SKIP test not_null_team_event_summary_session_code .................... [[33mSKIP[0m]
[0m01:09:14.271509 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:09:14.270979 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:09:14.271283 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:09:14.270663 [info ] [Thread-1 (]: 22 of 22 SKIP test not_null_team_event_summary_team ............................ [[33mSKIP[0m]
[0m01:09:14.272092 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:09:14.273233 [debug] [MainThread]: Using duckdb connection "master"
[0m01:09:14.273445 [debug] [MainThread]: On master: BEGIN
[0m01:09:14.273599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:09:14.278923 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:09:14.279166 [debug] [MainThread]: On master: COMMIT
[0m01:09:14.279329 [debug] [MainThread]: Using duckdb connection "master"
[0m01:09:14.279474 [debug] [MainThread]: On master: COMMIT
[0m01:09:14.279718 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:09:14.279903 [debug] [MainThread]: On master: Close
[0m01:09:14.280786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:14.280967 [debug] [MainThread]: Connection 'test.f1_transform.not_null_weather_round.80e2ff036f' was properly closed.
[0m01:09:14.281133 [debug] [MainThread]: Connection 'test.f1_transform.not_null_laps_season.6c89aefec5' was properly closed.
[0m01:09:14.281341 [debug] [MainThread]: Connection 'model.f1_transform.laps' was properly closed.
[0m01:09:14.281490 [debug] [MainThread]: Connection 'test.f1_transform.not_null_laps_round.c55865a754' was properly closed.
[0m01:09:14.281645 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_season.4571c4d0da' was properly closed.
[0m01:09:14.281788 [debug] [MainThread]: Connection 'test.f1_transform.not_null_laps_session_code.ccd0209ff1' was properly closed.
[0m01:09:14.281933 [debug] [MainThread]: Connection 'model.f1_transform.driver_session_summary' was properly closed.
[0m01:09:14.282087 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_session_code.564091e2b6' was properly closed.
[0m01:09:14.282335 [info ] [MainThread]: 
[0m01:09:14.282541 [info ] [MainThread]: Finished running 5 table models, 17 data tests in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m01:09:14.283645 [debug] [MainThread]: Command end result
[0m01:09:14.312695 [info ] [MainThread]: 
[0m01:09:14.313004 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:09:14.313302 [info ] [MainThread]: 
[0m01:09:14.313635 [error] [MainThread]:   Runtime Error in model driver_session_summary (models/gold/driver_session_summary.sql)
  Binder Error: Referenced column "lap_time" not found in FROM clause!
  Candidate bindings: "laps.laptime", "laps.lapstarttime", "laps.lapnumber", "laps.pitintime", "laps.lapstartdate"
  LINE 12: ...: "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
  
    
      
      
  
      create  table
        "f1"."main_gold"."driver_session_summary__dbt_tmp"
    
      as (
        WITH laps AS (
    SELECT * FROM "f1"."main_silver"."laps" WHERE lap_time IS NOT NULL
                                                     ^
[0m01:09:14.313886 [info ] [MainThread]: 
[0m01:09:14.314213 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=9 TOTAL=22
[0m01:09:14.314799 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.8095217, "process_user_time": 2.4959, "process_kernel_time": 0.487692, "process_mem_max_rss": "254380", "process_in_blocks": "85480", "process_out_blocks": "43905", "command_success": false}
[0m01:09:14.315070 [debug] [MainThread]: Command `dbt build` failed at 01:09:14.315016 after 2.81 seconds
[0m01:09:14.315311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8247d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82446010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82781490>]}
[0m01:09:14.315507 [debug] [MainThread]: Flushing usage events
[0m01:10:38.089756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0aad4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0aaf150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0aada90>]}


============================== 01:10:38.093518 | 9066439e-64a6-47b8-9291-a9157b0fd988 ==============================
[0m01:10:38.093518 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:10:38.093876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/transform/profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/transform/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:38.136685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9066439e-64a6-47b8-9291-a9157b0fd988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b193d0>]}
[0m01:10:38.142751 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:10:38.144027 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:10:38.144671 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.07696183, "process_user_time": 0.700333, "process_kernel_time": 0.080922, "process_mem_max_rss": "97016", "process_out_blocks": "1659", "process_in_blocks": "0"}
[0m01:10:38.145025 [debug] [MainThread]: Command `dbt deps` succeeded at 01:10:38.144962 after 0.08 seconds
[0m01:10:38.145262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a904d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ae7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0aca350>]}
[0m01:10:38.145496 [debug] [MainThread]: Flushing usage events
[0m01:10:38.953994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ac6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff888f79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff888f7290>]}


============================== 01:10:38.955485 | 0b97cfdd-bce7-474c-b148-a3f6a178181f ==============================
[0m01:10:38.955485 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:10:38.955835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/transform/profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:39.045191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8896a850>]}
[0m01:10:39.068693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae2a250>]}
[0m01:10:39.069133 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m01:10:39.099917 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:10:39.153636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:10:39.154064 [debug] [MainThread]: Partial parsing: updated file: f1_transform://models/gold/driver_session_summary.sql
[0m01:10:39.250507 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:10:39.250949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84da1dd0>]}
[0m01:10:39.323443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a02ed0>]}
[0m01:10:39.389030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8111d750>]}
[0m01:10:39.389356 [info ] [MainThread]: Found 5 models, 17 data tests, 422 macros
[0m01:10:39.391076 [info ] [MainThread]: 
[0m01:10:39.391488 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:10:39.394115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:10:39.394474 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:10:39.415255 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:10:39.415485 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:10:39.416060 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:10:39.416335 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:10:39.416561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:39.416815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:39.423928 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m01:10:39.424142 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m01:10:39.424869 [debug] [ThreadPool]: On list_f1: Close
[0m01:10:39.425514 [debug] [ThreadPool]: On list_f1: Close
[0m01:10:39.426734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_gold)
[0m01:10:39.427146 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_gold"
"
[0m01:10:39.426919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_silver)
[0m01:10:39.430536 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:10:39.430819 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_silver"
"
[0m01:10:39.431021 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:10:39.464367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:39.464102 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:10:39.464968 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:10:39.466936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:39.469449 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:10:39.470402 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:10:39.470613 [debug] [ThreadPool]: On create_f1_main_gold: BEGIN
[0m01:10:39.470913 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:10:39.471115 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:10:39.471300 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
    
        create schema if not exists "f1"."main_gold"
    
[0m01:10:39.471677 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:10:39.472116 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:10:39.472303 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:10:39.472485 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:10:39.472751 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:10:39.472962 [debug] [ThreadPool]: On create_f1_main_gold: Close
[0m01:10:39.469696 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:10:39.473764 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:10:39.474056 [debug] [ThreadPool]: On create_f1_main_silver: BEGIN
[0m01:10:39.474313 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:10:39.474490 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:10:39.474660 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
    
        create schema if not exists "f1"."main_silver"
    
[0m01:10:39.474928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:10:39.475336 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:10:39.475513 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:10:39.475673 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:10:39.475916 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:10:39.476090 [debug] [ThreadPool]: On create_f1_main_silver: Close
[0m01:10:39.477476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_silver, now list_f1_main_gold)
[0m01:10:39.477755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_gold, now list_f1_main_silver)
[0m01:10:39.481416 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:10:39.481629 [debug] [ThreadPool]: On list_f1_main_silver: BEGIN
[0m01:10:39.481793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:39.480433 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:10:39.482230 [debug] [ThreadPool]: On list_f1_main_gold: BEGIN
[0m01:10:39.484074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:39.486211 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:10:39.486623 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:10:39.486826 [debug] [ThreadPool]: On list_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_silver"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_silver'
    and table_catalog = 'f1'
  
[0m01:10:39.486444 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:10:39.492009 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:10:39.494036 [debug] [ThreadPool]: On list_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_gold"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_gold'
    and table_catalog = 'f1'
  
[0m01:10:39.499330 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m01:10:39.500207 [debug] [ThreadPool]: On list_f1_main_silver: ROLLBACK
[0m01:10:39.501714 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:10:39.506669 [debug] [ThreadPool]: On list_f1_main_gold: ROLLBACK
[0m01:10:39.506945 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_gold'
[0m01:10:39.507140 [debug] [ThreadPool]: On list_f1_main_gold: Close
[0m01:10:39.506036 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_silver'
[0m01:10:39.507544 [debug] [ThreadPool]: On list_f1_main_silver: Close
[0m01:10:39.509070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81154a90>]}
[0m01:10:39.509389 [debug] [MainThread]: Using duckdb connection "master"
[0m01:10:39.509566 [debug] [MainThread]: On master: BEGIN
[0m01:10:39.509727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:10:39.514340 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:10:39.514563 [debug] [MainThread]: On master: COMMIT
[0m01:10:39.514724 [debug] [MainThread]: Using duckdb connection "master"
[0m01:10:39.514885 [debug] [MainThread]: On master: COMMIT
[0m01:10:39.515221 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:10:39.515389 [debug] [MainThread]: On master: Close
[0m01:10:39.516210 [info ] [MainThread]: Concurrency: 8 threads (target='local')
[0m01:10:39.516478 [info ] [MainThread]: 
[0m01:10:39.522350 [debug] [Thread-1 (]: Began running node model.f1_transform.laps
[0m01:10:39.522550 [debug] [Thread-2 (]: Began running node model.f1_transform.results
[0m01:10:39.522741 [debug] [Thread-3 (]: Began running node model.f1_transform.weather
[0m01:10:39.523079 [info ] [Thread-1 (]: 1 of 22 START sql table model main_silver.laps ................................. [RUN]
[0m01:10:39.523479 [info ] [Thread-2 (]: 2 of 22 START sql table model main_silver.results .............................. [RUN]
[0m01:10:39.523831 [info ] [Thread-3 (]: 3 of 22 START sql table model main_silver.weather .............................. [RUN]
[0m01:10:39.524209 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.f1_transform.laps'
[0m01:10:39.524528 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.f1_transform.results'
[0m01:10:39.524840 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.f1_transform.weather'
[0m01:10:39.525073 [debug] [Thread-1 (]: Began compiling node model.f1_transform.laps
[0m01:10:39.525338 [debug] [Thread-2 (]: Began compiling node model.f1_transform.results
[0m01:10:39.525585 [debug] [Thread-3 (]: Began compiling node model.f1_transform.weather
[0m01:10:39.529139 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_transform.laps"
[0m01:10:39.530170 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.results"
[0m01:10:39.531160 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.weather"
[0m01:10:39.532358 [debug] [Thread-1 (]: Began executing node model.f1_transform.laps
[0m01:10:39.532635 [debug] [Thread-3 (]: Began executing node model.f1_transform.weather
[0m01:10:39.540105 [debug] [Thread-2 (]: Began executing node model.f1_transform.results
[0m01:10:39.549142 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_transform.laps"
[0m01:10:39.550647 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.weather"
[0m01:10:39.552657 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.results"
[0m01:10:39.553885 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:10:39.554155 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:10:39.554323 [debug] [Thread-3 (]: On model.f1_transform.weather: BEGIN
[0m01:10:39.554470 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:10:39.554709 [debug] [Thread-2 (]: On model.f1_transform.results: BEGIN
[0m01:10:39.555426 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:10:39.555216 [debug] [Thread-1 (]: On model.f1_transform.laps: BEGIN
[0m01:10:39.554967 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:10:39.555900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:10:39.560675 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m01:10:39.561037 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:10:39.561580 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:10:39.561354 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:10:39.562057 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:10:39.561786 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:10:39.561179 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m01:10:39.563267 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:10:39.564963 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:10:39.850129 [debug] [Thread-2 (]: SQL status: OK in 0.288 seconds
[0m01:10:39.854121 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:10:39.855596 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results" rename to "results__dbt_backup"
[0m01:10:39.856298 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:10:39.859291 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:10:39.860374 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results__dbt_tmp" rename to "results"
[0m01:10:39.860903 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:10:39.871013 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:10:39.872408 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:10:39.872840 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:10:39.903608 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m01:10:39.910017 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:10:39.914095 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
drop table if exists "f1"."main_silver"."results__dbt_backup" cascade
[0m01:10:39.917696 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:10:39.921250 [debug] [Thread-2 (]: On model.f1_transform.results: Close
[0m01:10:39.928270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f62810>]}
[0m01:10:39.930520 [info ] [Thread-2 (]: 2 of 22 OK created sql table model main_silver.results ......................... [[32mOK[0m in 0.40s]
[0m01:10:39.931599 [debug] [Thread-2 (]: Finished running node model.f1_transform.results
[0m01:10:39.932515 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:10:39.932720 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:10:39.932915 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:10:39.934385 [info ] [Thread-5 (]: 4 of 22 START test not_null_results_round ...................................... [RUN]
[0m01:10:39.935224 [info ] [Thread-6 (]: 5 of 22 START test not_null_results_season ..................................... [RUN]
[0m01:10:39.936980 [info ] [Thread-7 (]: 6 of 22 START test not_null_results_session_code ............................... [RUN]
[0m01:10:39.939376 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_f1_main_silver, now test.f1_transform.not_null_results_round.69e7ee2263)
[0m01:10:39.940920 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly list_f1_main_gold, now test.f1_transform.not_null_results_season.4571c4d0da)
[0m01:10:39.942198 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:10:39.943834 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:10:39.945398 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:10:39.946845 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:10:39.954290 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:10:39.957713 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:10:39.960456 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:10:39.966352 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:10:39.967179 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:10:39.975263 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:10:39.976968 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:10:39.978961 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:10:39.986734 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:10:39.988556 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:10:39.990108 [debug] [Thread-3 (]: SQL status: OK in 0.424 seconds
[0m01:10:39.991957 [debug] [Thread-5 (]: On test.f1_transform.not_null_results_round.69e7ee2263: BEGIN
[0m01:10:39.993176 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:10:39.996761 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:10:40.001799 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather" rename to "weather__dbt_backup"
[0m01:10:39.998718 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:10:40.000485 [debug] [Thread-6 (]: On test.f1_transform.not_null_results_season.4571c4d0da: BEGIN
[0m01:10:39.997705 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:10:40.003360 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.007250 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:10:40.007067 [debug] [Thread-5 (]: SQL status: OK in 0.008 seconds
[0m01:10:40.009233 [debug] [Thread-7 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: BEGIN
[0m01:10:40.013422 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:10:40.014674 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m01:10:40.014978 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:10:40.017226 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:10:40.019660 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather__dbt_tmp" rename to "weather"
[0m01:10:40.021016 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:10:40.022655 [debug] [Thread-5 (]: On test.f1_transform.not_null_results_round.69e7ee2263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_round.69e7ee2263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."results"
where round is null



      
    ) dbt_internal_test
[0m01:10:40.024607 [debug] [Thread-7 (]: SQL status: OK in 0.007 seconds
[0m01:10:40.026442 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.027914 [debug] [Thread-6 (]: On test.f1_transform.not_null_results_season.4571c4d0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_season.4571c4d0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."results"
where season is null



      
    ) dbt_internal_test
[0m01:10:40.031223 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:10:40.031880 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m01:10:40.033419 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:10:40.034880 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.035704 [debug] [Thread-7 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_session_code.564091e2b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."results"
where session_code is null



      
    ) dbt_internal_test
[0m01:10:40.037855 [debug] [Thread-5 (]: On test.f1_transform.not_null_results_round.69e7ee2263: ROLLBACK
[0m01:10:40.040738 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:10:40.042207 [debug] [Thread-6 (]: On test.f1_transform.not_null_results_season.4571c4d0da: ROLLBACK
[0m01:10:40.044876 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:10:40.045169 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.046628 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:10:40.049176 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_results_season.4571c4d0da'
[0m01:10:40.049888 [debug] [Thread-5 (]: On test.f1_transform.not_null_results_round.69e7ee2263: Close
[0m01:10:40.051689 [debug] [Thread-7 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: ROLLBACK
[0m01:10:40.053628 [debug] [Thread-6 (]: On test.f1_transform.not_null_results_season.4571c4d0da: Close
[0m01:10:40.054906 [info ] [Thread-5 (]: 4 of 22 PASS not_null_results_round ............................................ [[32mPASS[0m in 0.12s]
[0m01:10:40.057219 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:10:40.059133 [info ] [Thread-6 (]: 5 of 22 PASS not_null_results_season ........................................... [[32mPASS[0m in 0.12s]
[0m01:10:40.060169 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:10:40.060987 [debug] [Thread-7 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: Close
[0m01:10:40.062949 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:10:40.066976 [info ] [Thread-7 (]: 6 of 22 PASS not_null_results_session_code ..................................... [[32mPASS[0m in 0.12s]
[0m01:10:40.070935 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:10:40.103360 [debug] [Thread-3 (]: SQL status: OK in 0.051 seconds
[0m01:10:40.106561 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:10:40.107678 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
drop table if exists "f1"."main_silver"."weather__dbt_backup" cascade
[0m01:10:40.110588 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m01:10:40.112118 [debug] [Thread-3 (]: On model.f1_transform.weather: Close
[0m01:10:40.113539 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89083f10>]}
[0m01:10:40.115842 [info ] [Thread-3 (]: 3 of 22 OK created sql table model main_silver.weather ......................... [[32mOK[0m in 0.59s]
[0m01:10:40.119200 [debug] [Thread-3 (]: Finished running node model.f1_transform.weather
[0m01:10:40.124354 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:10:40.124587 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:10:40.124791 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:10:40.125075 [info ] [Thread-4 (]: 7 of 22 START test not_null_weather_round ...................................... [RUN]
[0m01:10:40.125574 [info ] [Thread-2 (]: 8 of 22 START test not_null_weather_season ..................................... [RUN]
[0m01:10:40.126061 [info ] [Thread-8 (]: 9 of 22 START test not_null_weather_session_code ............................... [RUN]
[0m01:10:40.126516 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:10:40.127424 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:10:40.127175 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:10:40.126856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_transform.results, now test.f1_transform.not_null_weather_season.773def5ec8)
[0m01:10:40.130289 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:10:40.129991 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:10:40.129654 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:10:40.132370 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:10:40.134485 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:10:40.135885 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:10:40.137640 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:10:40.137952 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:10:40.139585 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:10:40.138249 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:10:40.140031 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:10:40.141163 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:10:40.141593 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:10:40.141815 [debug] [Thread-4 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: BEGIN
[0m01:10:40.142207 [debug] [Thread-2 (]: On test.f1_transform.not_null_weather_season.773def5ec8: BEGIN
[0m01:10:40.143238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:10:40.143013 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:10:40.142844 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:10:40.143687 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.144071 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.144284 [debug] [Thread-8 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: BEGIN
[0m01:10:40.144536 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:10:40.145282 [debug] [Thread-2 (]: On test.f1_transform.not_null_weather_season.773def5ec8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_season.773def5ec8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."weather"
where season is null



      
    ) dbt_internal_test
[0m01:10:40.145054 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:10:40.144799 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:10:40.146548 [debug] [Thread-4 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_round.80e2ff036f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."weather"
where round is null



      
    ) dbt_internal_test
[0m01:10:40.146336 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.146164 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.147535 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.147729 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:10:40.148808 [debug] [Thread-2 (]: On test.f1_transform.not_null_weather_season.773def5ec8: ROLLBACK
[0m01:10:40.150300 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:10:40.149924 [debug] [Thread-8 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."weather"
where session_code is null



      
    ) dbt_internal_test
[0m01:10:40.149595 [debug] [Thread-4 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: ROLLBACK
[0m01:10:40.151140 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:10:40.151461 [debug] [Thread-4 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: Close
[0m01:10:40.152054 [info ] [Thread-4 (]: 7 of 22 PASS not_null_weather_round ............................................ [[32mPASS[0m in 0.03s]
[0m01:10:40.151646 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.150541 [debug] [Thread-2 (]: On test.f1_transform.not_null_weather_season.773def5ec8: Close
[0m01:10:40.152562 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:10:40.153386 [debug] [Thread-8 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: ROLLBACK
[0m01:10:40.154523 [info ] [Thread-2 (]: 8 of 22 PASS not_null_weather_season ........................................... [[32mPASS[0m in 0.03s]
[0m01:10:40.155330 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:10:40.155651 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:10:40.155956 [debug] [Thread-8 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: Close
[0m01:10:40.156585 [info ] [Thread-8 (]: 9 of 22 PASS not_null_weather_session_code ..................................... [[32mPASS[0m in 0.03s]
[0m01:10:40.157085 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:10:40.255964 [debug] [Thread-1 (]: SQL status: OK in 0.693 seconds
[0m01:10:40.257727 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:10:40.258006 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps" rename to "laps__dbt_backup"
[0m01:10:40.258582 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.260039 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:10:40.260289 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps__dbt_tmp" rename to "laps"
[0m01:10:40.260724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.261464 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:10:40.261739 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:10:40.262007 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:10:40.658738 [debug] [Thread-1 (]: SQL status: OK in 0.396 seconds
[0m01:10:40.660357 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:10:40.660606 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
drop table if exists "f1"."main_silver"."laps__dbt_backup" cascade
[0m01:10:40.661803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.662595 [debug] [Thread-1 (]: On model.f1_transform.laps: Close
[0m01:10:40.925506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83980710>]}
[0m01:10:40.926048 [info ] [Thread-1 (]: 1 of 22 OK created sql table model main_silver.laps ............................ [[32mOK[0m in 1.40s]
[0m01:10:40.926454 [debug] [Thread-1 (]: Finished running node model.f1_transform.laps
[0m01:10:40.927136 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:10:40.927344 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:10:40.927510 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:10:40.927724 [info ] [Thread-6 (]: 10 of 22 START test not_null_laps_round ........................................ [RUN]
[0m01:10:40.928047 [info ] [Thread-7 (]: 11 of 22 START test not_null_laps_season ....................................... [RUN]
[0m01:10:40.928339 [info ] [Thread-3 (]: 12 of 22 START test not_null_laps_session_code ................................. [RUN]
[0m01:10:40.928836 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_season.4571c4d0da, now test.f1_transform.not_null_laps_round.c55865a754)
[0m01:10:40.929150 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_session_code.564091e2b6, now test.f1_transform.not_null_laps_season.6c89aefec5)
[0m01:10:40.929441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_transform.weather, now test.f1_transform.not_null_laps_session_code.ccd0209ff1)
[0m01:10:40.929672 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_laps_round.c55865a754
[0m01:10:40.929941 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:10:40.930207 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:10:40.933362 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:10:40.935521 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:10:40.937377 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:10:40.938714 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_laps_round.c55865a754
[0m01:10:40.939964 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:10:40.940174 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:10:40.940579 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:10:40.941711 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:10:40.942829 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:10:40.943039 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:10:40.943619 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: BEGIN
[0m01:10:40.943912 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:10:40.944411 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: BEGIN
[0m01:10:40.944242 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:10:40.944786 [debug] [Thread-3 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: BEGIN
[0m01:10:40.944574 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m01:10:40.944091 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:10:40.944947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:10:40.950790 [debug] [Thread-7 (]: SQL status: OK in 0.006 seconds
[0m01:10:40.951072 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m01:10:40.951244 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m01:10:40.951440 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:10:40.952215 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_season.6c89aefec5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."laps"
where season is null



      
    ) dbt_internal_test
[0m01:10:40.951966 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:10:40.951690 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:10:40.953327 [debug] [Thread-3 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."laps"
where session_code is null



      
    ) dbt_internal_test
[0m01:10:40.953075 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_round.c55865a754"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."laps"
where round is null



      
    ) dbt_internal_test
[0m01:10:40.952929 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.953883 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:10:40.954913 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: ROLLBACK
[0m01:10:40.955243 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m01:10:40.955880 [debug] [Thread-3 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: ROLLBACK
[0m01:10:40.957133 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_laps_session_code.ccd0209ff1'
[0m01:10:40.956876 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: ROLLBACK
[0m01:10:40.956216 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_laps_season.6c89aefec5'
[0m01:10:40.957871 [debug] [Thread-7 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: Close
[0m01:10:40.957660 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_laps_round.c55865a754'
[0m01:10:40.957344 [debug] [Thread-3 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: Close
[0m01:10:40.958186 [info ] [Thread-7 (]: 11 of 22 PASS not_null_laps_season ............................................. [[32mPASS[0m in 0.03s]
[0m01:10:40.958513 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: Close
[0m01:10:40.958970 [info ] [Thread-3 (]: 12 of 22 PASS not_null_laps_session_code ....................................... [[32mPASS[0m in 0.03s]
[0m01:10:40.959755 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:10:40.959309 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:10:40.960455 [info ] [Thread-6 (]: 10 of 22 PASS not_null_laps_round .............................................. [[32mPASS[0m in 0.03s]
[0m01:10:40.960921 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:10:40.961372 [debug] [Thread-4 (]: Began running node model.f1_transform.driver_session_summary
[0m01:10:40.961758 [info ] [Thread-4 (]: 13 of 22 START sql table model main_gold.driver_session_summary ................ [RUN]
[0m01:10:40.962183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_round.80e2ff036f, now model.f1_transform.driver_session_summary)
[0m01:10:40.962444 [debug] [Thread-4 (]: Began compiling node model.f1_transform.driver_session_summary
[0m01:10:40.964132 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_transform.driver_session_summary"
[0m01:10:40.965224 [debug] [Thread-4 (]: Began executing node model.f1_transform.driver_session_summary
[0m01:10:40.966832 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_transform.driver_session_summary"
[0m01:10:40.967762 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:10:40.967962 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: BEGIN
[0m01:10:40.968132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:10:40.973277 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m01:10:40.973572 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:10:40.973852 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."driver_session_summary__dbt_tmp"
  
    as (
      WITH laps AS (
  SELECT * FROM "f1"."main_silver"."laps" WHERE laptime IS NOT NULL
),
driver_base AS (
  SELECT
    season,
    round,
    grand_prix,
    session_code,
    COALESCE(NULLIF(driver, ''), CAST(drivernumber AS VARCHAR)) AS driver,
    drivernumber AS driver_number,
    team,
    laptime,
    pitintime,
    pitouttime
  FROM laps
),
ranker AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team, laptime,
    ROW_NUMBER() OVER (
      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team
      ORDER BY laptime ASC NULLS LAST
    ) AS rn
  FROM driver_base
),
pb AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps
  FROM ranker
  GROUP BY 1,2,3,4,5,6,7
),
agg AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    COUNT(*) AS laps_total,
    SUM(CASE WHEN pitintime IS NULL AND pitouttime IS NULL THEN 1 ELSE 0 END) AS laps_on_track,
    SUM(CASE WHEN pitintime IS NOT NULL OR  pitouttime IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,
    MIN(laptime) AS best_lap_time
  FROM driver_base
  GROUP BY 1,2,3,4,5,6,7
)
SELECT
  a.season, a.round, a.grand_prix, a.session_code,
  a.driver, a.driver_number, a.team,
  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,
  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps
FROM agg a
LEFT JOIN pb
  ON  a.season       = pb.season
  AND a.round        = pb.round
  AND a.grand_prix   = pb.grand_prix
  AND a.session_code = pb.session_code
  AND a.driver       = pb.driver
  AND a.driver_number= pb.driver_number
  AND a.team         = pb.team
    );
  
  
[0m01:10:41.004099 [debug] [Thread-4 (]: SQL status: OK in 0.030 seconds
[0m01:10:41.005831 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:10:41.006058 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
alter table "f1"."main_gold"."driver_session_summary__dbt_tmp" rename to "driver_session_summary"
[0m01:10:41.006521 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.007163 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m01:10:41.007389 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:10:41.007610 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m01:10:41.015927 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m01:10:41.017104 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:10:41.017323 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
drop table if exists "f1"."main_gold"."driver_session_summary__dbt_backup" cascade
[0m01:10:41.017657 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.018302 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: Close
[0m01:10:41.058058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f18390>]}
[0m01:10:41.058476 [info ] [Thread-4 (]: 13 of 22 OK created sql table model main_gold.driver_session_summary ........... [[32mOK[0m in 0.10s]
[0m01:10:41.058873 [debug] [Thread-4 (]: Finished running node model.f1_transform.driver_session_summary
[0m01:10:41.059336 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:10:41.059653 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:10:41.059812 [info ] [Thread-8 (]: 14 of 22 START test not_null_driver_session_summary_driver ..................... [RUN]
[0m01:10:41.059989 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:10:41.060249 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:10:41.060486 [info ] [Thread-1 (]: 15 of 22 START test not_null_driver_session_summary_round ...................... [RUN]
[0m01:10:41.060860 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_session_code.2cbdf7ee2a, now test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2)
[0m01:10:41.061137 [info ] [Thread-5 (]: 16 of 22 START test not_null_driver_session_summary_season ..................... [RUN]
[0m01:10:41.061407 [info ] [Thread-3 (]: 17 of 22 START test not_null_driver_session_summary_session_code ............... [RUN]
[0m01:10:41.062488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_session_code.ccd0209ff1, now test.f1_transform.not_null_driver_session_summary_session_code.68938a7773)
[0m01:10:41.062676 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:10:41.062248 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_round.69e7ee2263, now test.f1_transform.not_null_driver_session_summary_season.30188e778b)
[0m01:10:41.061742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_transform.laps, now test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71)
[0m01:10:41.065278 [debug] [Thread-1 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:10:41.064745 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:10:41.065047 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:10:41.061970 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:10:41.067193 [debug] [Thread-1 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:10:41.070491 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:10:41.072560 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:10:41.073343 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:10:41.073787 [debug] [Thread-1 (]: Began executing node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:10:41.074871 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:10:41.075190 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:10:41.076203 [debug] [Thread-1 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:10:41.076425 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:10:41.077606 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:10:41.078297 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:10:41.079321 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:10:41.079800 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: BEGIN
[0m01:10:41.079967 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:10:41.080366 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:10:41.080532 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:10:41.080821 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: BEGIN
[0m01:10:41.081018 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:10:41.081208 [debug] [Thread-5 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: BEGIN
[0m01:10:41.081754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:41.084122 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: BEGIN
[0m01:10:41.084721 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:10:41.086987 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m01:10:41.087544 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m01:10:41.087827 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:10:41.088013 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m01:10:41.088310 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m01:10:41.089323 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:10:41.088833 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:10:41.089094 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:10:41.088537 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:10:41.090356 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."driver_session_summary"
where session_code is null



      
    ) dbt_internal_test
[0m01:10:41.089835 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."driver_session_summary"
where round is null



      
    ) dbt_internal_test
[0m01:10:41.090116 [debug] [Thread-5 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_season.30188e778b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."driver_session_summary"
where season is null



      
    ) dbt_internal_test
[0m01:10:41.089544 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select driver
from "f1"."main_gold"."driver_session_summary"
where driver is null



      
    ) dbt_internal_test
[0m01:10:41.091064 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.091565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.091929 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m01:10:41.092854 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: ROLLBACK
[0m01:10:41.094640 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_session_code.68938a7773'
[0m01:10:41.093639 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: ROLLBACK
[0m01:10:41.094318 [debug] [Thread-5 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: ROLLBACK
[0m01:10:41.092997 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:10:41.094853 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: Close
[0m01:10:41.095154 [debug] [Thread-1 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71'
[0m01:10:41.095465 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_season.30188e778b'
[0m01:10:41.096202 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: ROLLBACK
[0m01:10:41.097427 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2'
[0m01:10:41.096881 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: Close
[0m01:10:41.097146 [debug] [Thread-5 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: Close
[0m01:10:41.096584 [info ] [Thread-3 (]: 17 of 22 PASS not_null_driver_session_summary_session_code ..................... [[32mPASS[0m in 0.03s]
[0m01:10:41.097632 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: Close
[0m01:10:41.097987 [info ] [Thread-1 (]: 15 of 22 PASS not_null_driver_session_summary_round ............................ [[32mPASS[0m in 0.04s]
[0m01:10:41.098364 [info ] [Thread-5 (]: 16 of 22 PASS not_null_driver_session_summary_season ........................... [[32mPASS[0m in 0.04s]
[0m01:10:41.098733 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:10:41.099293 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:10:41.099710 [info ] [Thread-8 (]: 14 of 22 PASS not_null_driver_session_summary_driver ........................... [[32mPASS[0m in 0.04s]
[0m01:10:41.100689 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:10:41.100039 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:10:41.101293 [debug] [Thread-6 (]: Began running node model.f1_transform.team_event_summary
[0m01:10:41.101588 [info ] [Thread-6 (]: 18 of 22 START sql table model main_gold.team_event_summary .................... [RUN]
[0m01:10:41.101861 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_round.c55865a754, now model.f1_transform.team_event_summary)
[0m01:10:41.102080 [debug] [Thread-6 (]: Began compiling node model.f1_transform.team_event_summary
[0m01:10:41.103483 [debug] [Thread-6 (]: Writing injected SQL for node "model.f1_transform.team_event_summary"
[0m01:10:41.104223 [debug] [Thread-6 (]: Began executing node model.f1_transform.team_event_summary
[0m01:10:41.105828 [debug] [Thread-6 (]: Writing runtime sql for node "model.f1_transform.team_event_summary"
[0m01:10:41.106859 [debug] [Thread-6 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:10:41.107079 [debug] [Thread-6 (]: On model.f1_transform.team_event_summary: BEGIN
[0m01:10:41.107280 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:10:41.112340 [debug] [Thread-6 (]: SQL status: OK in 0.005 seconds
[0m01:10:41.112600 [debug] [Thread-6 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:10:41.112811 [debug] [Thread-6 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."team_event_summary__dbt_tmp"
  
    as (
      WITH driver AS (
  SELECT * FROM "f1"."main_gold"."driver_session_summary"
),
race_only AS (
  SELECT * FROM driver WHERE session_code IN ('R','Q','S')
),
team_agg AS (
  SELECT
    season, round, grand_prix, session_code,
    team,
    SUM(laps_on_track) AS team_laps_on_track,
    SUM(pitstops)      AS team_pitstops,
    MIN(best_lap_time) AS team_best_lap_time
  FROM race_only
  GROUP BY 1,2,3,4,5
)
SELECT * FROM team_agg
    );
  
  
[0m01:10:41.120870 [debug] [Thread-6 (]: SQL status: OK in 0.008 seconds
[0m01:10:41.122581 [debug] [Thread-6 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:10:41.122816 [debug] [Thread-6 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
alter table "f1"."main_gold"."team_event_summary__dbt_tmp" rename to "team_event_summary"
[0m01:10:41.123254 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.123916 [debug] [Thread-6 (]: On model.f1_transform.team_event_summary: COMMIT
[0m01:10:41.124118 [debug] [Thread-6 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:10:41.124291 [debug] [Thread-6 (]: On model.f1_transform.team_event_summary: COMMIT
[0m01:10:41.127445 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m01:10:41.128558 [debug] [Thread-6 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:10:41.128783 [debug] [Thread-6 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
drop table if exists "f1"."main_gold"."team_event_summary__dbt_backup" cascade
[0m01:10:41.129144 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.129831 [debug] [Thread-6 (]: On model.f1_transform.team_event_summary: Close
[0m01:10:41.172255 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b97cfdd-bce7-474c-b148-a3f6a178181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88875e50>]}
[0m01:10:41.172674 [info ] [Thread-6 (]: 18 of 22 OK created sql table model main_gold.team_event_summary ............... [[32mOK[0m in 0.07s]
[0m01:10:41.173042 [debug] [Thread-6 (]: Finished running node model.f1_transform.team_event_summary
[0m01:10:41.173651 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:10:41.173855 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:10:41.174023 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:10:41.174217 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:10:41.174382 [info ] [Thread-4 (]: 19 of 22 START test not_null_team_event_summary_round .......................... [RUN]
[0m01:10:41.174686 [info ] [Thread-7 (]: 20 of 22 START test not_null_team_event_summary_season ......................... [RUN]
[0m01:10:41.175042 [info ] [Thread-3 (]: 21 of 22 START test not_null_team_event_summary_session_code ................... [RUN]
[0m01:10:41.175341 [info ] [Thread-1 (]: 22 of 22 START test not_null_team_event_summary_team ........................... [RUN]
[0m01:10:41.175706 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_transform.driver_session_summary, now test.f1_transform.not_null_team_event_summary_round.bddcc074d0)
[0m01:10:41.176000 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_season.6c89aefec5, now test.f1_transform.not_null_team_event_summary_season.19b7a0fa18)
[0m01:10:41.176278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_session_code.68938a7773, now test.f1_transform.not_null_team_event_summary_session_code.e054c7119a)
[0m01:10:41.176554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71, now test.f1_transform.not_null_team_event_summary_team.23b41750d4)
[0m01:10:41.176787 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:10:41.177030 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:10:41.177281 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:10:41.177523 [debug] [Thread-1 (]: Began compiling node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:10:41.179544 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:10:41.181331 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:10:41.184688 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:10:41.186623 [debug] [Thread-1 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:10:41.188472 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:10:41.189698 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:10:41.189911 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:10:41.191447 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:10:41.191705 [debug] [Thread-1 (]: Began executing node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:10:41.192761 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:10:41.193887 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:10:41.194086 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:10:41.195031 [debug] [Thread-1 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:10:41.195626 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: BEGIN
[0m01:10:41.195942 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:10:41.198207 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: BEGIN
[0m01:10:41.196427 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:10:41.196241 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:10:41.198410 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:10:41.198662 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m01:10:41.198931 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: BEGIN
[0m01:10:41.199531 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: BEGIN
[0m01:10:41.201865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:10:41.202151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:41.204609 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m01:10:41.205397 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:10:41.205021 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m01:10:41.205193 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:10:41.206132 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:10:41.205606 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."team_event_summary"
where session_code is null



      
    ) dbt_internal_test
[0m01:10:41.205877 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:10:41.207250 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."team_event_summary"
where round is null



      
    ) dbt_internal_test
[0m01:10:41.206345 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_team.23b41750d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team
from "f1"."main_gold"."team_event_summary"
where team is null



      
    ) dbt_internal_test
[0m01:10:41.207018 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.204810 [debug] [Thread-7 (]: SQL status: OK in 0.006 seconds
[0m01:10:41.207752 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.208342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.209176 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: ROLLBACK
[0m01:10:41.209413 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:10:41.210207 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: ROLLBACK
[0m01:10:41.211062 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: ROLLBACK
[0m01:10:41.211385 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a'
[0m01:10:41.211662 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."team_event_summary"
where season is null



      
    ) dbt_internal_test
[0m01:10:41.211944 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0'
[0m01:10:41.212274 [debug] [Thread-1 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_team.23b41750d4'
[0m01:10:41.212466 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: Close
[0m01:10:41.213709 [info ] [Thread-3 (]: 21 of 22 PASS not_null_team_event_summary_session_code ......................... [[32mPASS[0m in 0.04s]
[0m01:10:41.213216 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m01:10:41.213363 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: Close
[0m01:10:41.212920 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: Close
[0m01:10:41.214068 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:10:41.214857 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: ROLLBACK
[0m01:10:41.215223 [info ] [Thread-1 (]: 22 of 22 PASS not_null_team_event_summary_team ................................. [[32mPASS[0m in 0.04s]
[0m01:10:41.215585 [info ] [Thread-4 (]: 19 of 22 PASS not_null_team_event_summary_round ................................ [[32mPASS[0m in 0.04s]
[0m01:10:41.216227 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18'
[0m01:10:41.216512 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:10:41.216814 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:10:41.217072 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: Close
[0m01:10:41.218458 [info ] [Thread-7 (]: 20 of 22 PASS not_null_team_event_summary_season ............................... [[32mPASS[0m in 0.04s]
[0m01:10:41.218846 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:10:41.219927 [debug] [MainThread]: Using duckdb connection "master"
[0m01:10:41.220151 [debug] [MainThread]: On master: BEGIN
[0m01:10:41.220319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:10:41.225567 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:10:41.225808 [debug] [MainThread]: On master: COMMIT
[0m01:10:41.225966 [debug] [MainThread]: Using duckdb connection "master"
[0m01:10:41.226113 [debug] [MainThread]: On master: COMMIT
[0m01:10:41.226357 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:10:41.226567 [debug] [MainThread]: On master: Close
[0m01:10:41.227516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:41.227712 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_season.30188e778b' was properly closed.
[0m01:10:41.227913 [debug] [MainThread]: Connection 'model.f1_transform.team_event_summary' was properly closed.
[0m01:10:41.228106 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_team.23b41750d4' was properly closed.
[0m01:10:41.228253 [debug] [MainThread]: Connection 'test.f1_transform.not_null_weather_season.773def5ec8' was properly closed.
[0m01:10:41.228403 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a' was properly closed.
[0m01:10:41.228561 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18' was properly closed.
[0m01:10:41.228701 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0' was properly closed.
[0m01:10:41.228844 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2' was properly closed.
[0m01:10:41.229275 [info ] [MainThread]: 
[0m01:10:41.229545 [info ] [MainThread]: Finished running 5 table models, 17 data tests in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m01:10:41.230978 [debug] [MainThread]: Command end result
[0m01:10:41.261024 [info ] [MainThread]: 
[0m01:10:41.261347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:10:41.261672 [info ] [MainThread]: 
[0m01:10:41.261948 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m01:10:41.262527 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.330275, "process_user_time": 2.176173, "process_kernel_time": 0.451294, "process_mem_max_rss": "237976", "process_in_blocks": "1424", "process_out_blocks": "47613"}
[0m01:10:41.262796 [debug] [MainThread]: Command `dbt build` succeeded at 01:10:41.262744 after 2.33 seconds
[0m01:10:41.263027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc317d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5d4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5d53d0>]}
[0m01:10:41.263252 [debug] [MainThread]: Flushing usage events
[0m01:34:57.010940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8835f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886d9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883363d0>]}


============================== 01:34:57.016058 | 8459ef1c-1b86-442d-942a-2667d44f6449 ==============================
[0m01:34:57.016058 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:34:57.016508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/transform/profiles', 'log_path': '/opt/transform/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m01:34:57.062760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8459ef1c-1b86-442d-942a-2667d44f6449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88402250>]}
[0m01:34:57.071994 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:34:57.074079 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:34:57.075037 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09234762, "process_user_time": 0.711367, "process_kernel_time": 0.118561, "process_mem_max_rss": "96164", "process_in_blocks": "100696", "process_out_blocks": "1659"}
[0m01:34:57.075362 [debug] [MainThread]: Command `dbt deps` succeeded at 01:34:57.075285 after 0.09 seconds
[0m01:34:57.075579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88340310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88379450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8837b490>]}
[0m01:34:57.075774 [debug] [MainThread]: Flushing usage events
[0m01:34:57.896671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85996850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859963d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857c6350>]}


============================== 01:34:57.898232 | b177833f-0276-4531-b6f8-997f1d71141f ==============================
[0m01:34:57.898232 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:34:57.898579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/transform/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:34:58.051117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85842490>]}
[0m01:34:58.078120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cda290>]}
[0m01:34:58.078897 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m01:34:58.115046 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:34:58.194199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:34:58.194470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:34:58.212727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80918610>]}
[0m01:34:58.289443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5a7e10>]}
[0m01:34:58.289807 [info ] [MainThread]: Found 5 models, 17 data tests, 422 macros
[0m01:34:58.291758 [info ] [MainThread]: 
[0m01:34:58.292296 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:34:58.295065 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:34:58.295385 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:34:58.323687 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:34:58.323895 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:34:58.324108 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:34:58.324341 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:34:58.324521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:58.324721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:58.378965 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m01:34:58.379198 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m01:34:58.380735 [debug] [ThreadPool]: On list_f1: Close
[0m01:34:58.380100 [debug] [ThreadPool]: On list_f1: Close
[0m01:34:58.382175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_gold)
[0m01:34:58.382655 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_gold"
"
[0m01:34:58.382371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_silver)
[0m01:34:58.386500 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_silver"
"
[0m01:34:58.387489 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:34:58.387681 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:34:58.387834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:58.386189 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:34:58.388311 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:34:58.390098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:58.395112 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m01:34:58.395303 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:34:58.396657 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:34:58.396840 [debug] [ThreadPool]: On create_f1_main_gold: BEGIN
[0m01:34:58.397103 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:58.397293 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:34:58.397480 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
    
        create schema if not exists "f1"."main_gold"
    
[0m01:34:58.397772 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:58.398230 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:34:58.398451 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:34:58.398604 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:34:58.396067 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:34:58.399008 [debug] [ThreadPool]: On create_f1_main_silver: BEGIN
[0m01:34:58.398874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:58.399384 [debug] [ThreadPool]: On create_f1_main_gold: Close
[0m01:34:58.399241 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:58.399715 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:34:58.399880 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
    
        create schema if not exists "f1"."main_silver"
    
[0m01:34:58.400125 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:58.400530 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:34:58.400694 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:34:58.400833 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:34:58.401079 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:58.401225 [debug] [ThreadPool]: On create_f1_main_silver: Close
[0m01:34:58.402652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_silver, now list_f1_main_gold)
[0m01:34:58.402931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_gold, now list_f1_main_silver)
[0m01:34:58.406837 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:34:58.407045 [debug] [ThreadPool]: On list_f1_main_silver: BEGIN
[0m01:34:58.407278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:58.405792 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:34:58.407788 [debug] [ThreadPool]: On list_f1_main_gold: BEGIN
[0m01:34:58.409897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:58.412825 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:34:58.413246 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:34:58.413434 [debug] [ThreadPool]: On list_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_silver"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_silver'
    and table_catalog = 'f1'
  
[0m01:34:58.413075 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:34:58.416812 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:34:58.417042 [debug] [ThreadPool]: On list_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_gold"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_gold'
    and table_catalog = 'f1'
  
[0m01:34:58.427199 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m01:34:58.428372 [debug] [ThreadPool]: On list_f1_main_silver: ROLLBACK
[0m01:34:58.427695 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:34:58.429130 [debug] [ThreadPool]: On list_f1_main_gold: ROLLBACK
[0m01:34:58.429444 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_silver'
[0m01:34:58.429798 [debug] [ThreadPool]: On list_f1_main_silver: Close
[0m01:34:58.429669 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_gold'
[0m01:34:58.430420 [debug] [ThreadPool]: On list_f1_main_gold: Close
[0m01:34:58.431901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813acb50>]}
[0m01:34:58.432198 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:58.432376 [debug] [MainThread]: On master: BEGIN
[0m01:34:58.432518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:34:58.437853 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:34:58.438110 [debug] [MainThread]: On master: COMMIT
[0m01:34:58.438269 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:58.438417 [debug] [MainThread]: On master: COMMIT
[0m01:34:58.438642 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:34:58.438813 [debug] [MainThread]: On master: Close
[0m01:34:58.439671 [info ] [MainThread]: Concurrency: 8 threads (target='local')
[0m01:34:58.439900 [info ] [MainThread]: 
[0m01:34:58.445618 [debug] [Thread-1 (]: Began running node model.f1_transform.laps
[0m01:34:58.445845 [debug] [Thread-2 (]: Began running node model.f1_transform.results
[0m01:34:58.446061 [debug] [Thread-3 (]: Began running node model.f1_transform.weather
[0m01:34:58.446405 [info ] [Thread-1 (]: 1 of 22 START sql table model main_silver.laps ................................. [RUN]
[0m01:34:58.446747 [info ] [Thread-2 (]: 2 of 22 START sql table model main_silver.results .............................. [RUN]
[0m01:34:58.447167 [info ] [Thread-3 (]: 3 of 22 START sql table model main_silver.weather .............................. [RUN]
[0m01:34:58.448244 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.f1_transform.weather'
[0m01:34:58.447987 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.f1_transform.results'
[0m01:34:58.447567 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.f1_transform.laps'
[0m01:34:58.448427 [debug] [Thread-3 (]: Began compiling node model.f1_transform.weather
[0m01:34:58.448644 [debug] [Thread-2 (]: Began compiling node model.f1_transform.results
[0m01:34:58.448828 [debug] [Thread-1 (]: Began compiling node model.f1_transform.laps
[0m01:34:58.452474 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.weather"
[0m01:34:58.453448 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.results"
[0m01:34:58.454427 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_transform.laps"
[0m01:34:58.456277 [debug] [Thread-1 (]: Began executing node model.f1_transform.laps
[0m01:34:58.457203 [debug] [Thread-3 (]: Began executing node model.f1_transform.weather
[0m01:34:58.463551 [debug] [Thread-2 (]: Began executing node model.f1_transform.results
[0m01:34:58.474194 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_transform.laps"
[0m01:34:58.475752 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.weather"
[0m01:34:58.477186 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.results"
[0m01:34:58.478915 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:34:58.479522 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:34:58.479654 [debug] [Thread-2 (]: On model.f1_transform.results: BEGIN
[0m01:34:58.479890 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:34:58.480090 [debug] [Thread-3 (]: On model.f1_transform.weather: BEGIN
[0m01:34:58.480775 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:34:58.480568 [debug] [Thread-1 (]: On model.f1_transform.laps: BEGIN
[0m01:34:58.480327 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:34:58.481241 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:34:58.486901 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m01:34:58.487591 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:34:58.487451 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:34:58.487247 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m01:34:58.488278 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:34:58.488073 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:34:58.487804 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:34:58.488473 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:34:58.488753 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:34:58.992634 [debug] [Thread-3 (]: SQL status: OK in 0.504 seconds
[0m01:34:58.998209 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:34:59.001751 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather" rename to "weather__dbt_backup"
[0m01:34:59.007125 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:34:59.010358 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:34:59.011458 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather__dbt_tmp" rename to "weather"
[0m01:34:59.013642 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:34:59.024365 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:34:59.029114 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:34:59.032063 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:34:59.101722 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m01:34:59.112654 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:34:59.113857 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
drop table if exists "f1"."main_silver"."weather__dbt_backup" cascade
[0m01:34:59.120176 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m01:34:59.124245 [debug] [Thread-3 (]: On model.f1_transform.weather: Close
[0m01:34:59.131850 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85848a50>]}
[0m01:34:59.135287 [info ] [Thread-3 (]: 3 of 22 OK created sql table model main_silver.weather ......................... [[32mOK[0m in 0.68s]
[0m01:34:59.137848 [debug] [Thread-3 (]: Finished running node model.f1_transform.weather
[0m01:34:59.138702 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:34:59.138931 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:34:59.139110 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:34:59.146104 [info ] [Thread-7 (]: 6 of 22 START test not_null_weather_session_code ............................... [RUN]
[0m01:34:59.142977 [info ] [Thread-6 (]: 5 of 22 START test not_null_weather_season ..................................... [RUN]
[0m01:34:59.140381 [info ] [Thread-5 (]: 4 of 22 START test not_null_weather_round ...................................... [RUN]
[0m01:34:59.147942 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:34:59.150157 [debug] [Thread-6 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:34:59.151190 [debug] [Thread-5 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:34:59.156322 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:34:59.159804 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:34:59.162546 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:34:59.170327 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:34:59.177722 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:34:59.185070 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:34:59.196299 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:34:59.198814 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:34:59.207979 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:34:59.211459 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:34:59.212764 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:34:59.220002 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:34:59.228587 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:34:59.230717 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: BEGIN
[0m01:34:59.231831 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:34:59.234212 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:34:59.234378 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:34:59.236566 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: BEGIN
[0m01:34:59.238661 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m01:34:59.240848 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: BEGIN
[0m01:34:59.243091 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m01:34:59.245109 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:34:59.251680 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:34:59.253930 [debug] [Thread-6 (]: SQL status: OK in 0.011 seconds
[0m01:34:59.257792 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."weather"
where session_code is null



      
    ) dbt_internal_test
[0m01:34:59.258226 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m01:34:59.260016 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:34:59.264139 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:34:59.264368 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m01:34:59.266153 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_season.773def5ec8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."weather"
where season is null



      
    ) dbt_internal_test
[0m01:34:59.266550 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_round.80e2ff036f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."weather"
where round is null



      
    ) dbt_internal_test
[0m01:34:59.271160 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: ROLLBACK
[0m01:34:59.273847 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.275587 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.276186 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:34:59.278207 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: ROLLBACK
[0m01:34:59.279447 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: ROLLBACK
[0m01:34:59.280158 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: Close
[0m01:34:59.280753 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:34:59.281282 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:34:59.282689 [info ] [Thread-7 (]: 6 of 22 PASS not_null_weather_session_code ..................................... [[32mPASS[0m in 0.13s]
[0m01:34:59.285262 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: Close
[0m01:34:59.286219 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: Close
[0m01:34:59.287934 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:34:59.291305 [debug] [Thread-2 (]: SQL status: OK in 0.802 seconds
[0m01:34:59.291899 [info ] [Thread-6 (]: 5 of 22 PASS not_null_weather_season ........................................... [[32mPASS[0m in 0.14s]
[0m01:34:59.292947 [info ] [Thread-5 (]: 4 of 22 PASS not_null_weather_round ............................................ [[32mPASS[0m in 0.14s]
[0m01:34:59.295633 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:34:59.296072 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:34:59.296502 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:34:59.296780 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results" rename to "results__dbt_backup"
[0m01:34:59.297899 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:34:59.299569 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:34:59.299877 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results__dbt_tmp" rename to "results"
[0m01:34:59.300531 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:34:59.301496 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:34:59.301774 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:34:59.302097 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:34:59.324830 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m01:34:59.326249 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:34:59.326668 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
drop table if exists "f1"."main_silver"."results__dbt_backup" cascade
[0m01:34:59.327881 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.328657 [debug] [Thread-2 (]: On model.f1_transform.results: Close
[0m01:34:59.329133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0586d0>]}
[0m01:34:59.329603 [info ] [Thread-2 (]: 2 of 22 OK created sql table model main_silver.results ......................... [[32mOK[0m in 0.88s]
[0m01:34:59.330109 [debug] [Thread-2 (]: Finished running node model.f1_transform.results
[0m01:34:59.330672 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:34:59.330939 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:34:59.331183 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:34:59.331483 [info ] [Thread-4 (]: 7 of 22 START test not_null_results_round ...................................... [RUN]
[0m01:34:59.331923 [info ] [Thread-3 (]: 8 of 22 START test not_null_results_season ..................................... [RUN]
[0m01:34:59.332364 [info ] [Thread-8 (]: 9 of 22 START test not_null_results_session_code ............................... [RUN]
[0m01:34:59.332788 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:34:59.333133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_transform.weather, now test.f1_transform.not_null_results_season.4571c4d0da)
[0m01:34:59.333486 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:34:59.333812 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:34:59.334114 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:34:59.334399 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:34:59.336876 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:34:59.338997 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:34:59.341021 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:34:59.343392 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:34:59.344683 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:34:59.344895 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:34:59.345280 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:34:59.348546 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:34:59.346461 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:34:59.349037 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:34:59.349531 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: BEGIN
[0m01:34:59.349776 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:34:59.349946 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:34:59.350677 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: BEGIN
[0m01:34:59.350897 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:34:59.350195 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:34:59.351049 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.351465 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.352187 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:34:59.351942 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:34:59.351671 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: BEGIN
[0m01:34:59.352383 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_session_code.564091e2b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."results"
where session_code is null



      
    ) dbt_internal_test
[0m01:34:59.352723 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_round.69e7ee2263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."results"
where round is null



      
    ) dbt_internal_test
[0m01:34:59.353085 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:34:59.354103 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.354889 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:34:59.355088 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m01:34:59.357045 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:34:59.356795 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: ROLLBACK
[0m01:34:59.356004 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: ROLLBACK
[0m01:34:59.357249 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_season.4571c4d0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."results"
where season is null



      
    ) dbt_internal_test
[0m01:34:59.357680 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:34:59.357982 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:34:59.358810 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: Close
[0m01:34:59.358998 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.360603 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: ROLLBACK
[0m01:34:59.359654 [info ] [Thread-4 (]: 7 of 22 PASS not_null_results_round ............................................ [[32mPASS[0m in 0.03s]
[0m01:34:59.359192 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: Close
[0m01:34:59.361700 [info ] [Thread-8 (]: 9 of 22 PASS not_null_results_session_code ..................................... [[32mPASS[0m in 0.03s]
[0m01:34:59.361289 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:34:59.360943 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_results_season.4571c4d0da'
[0m01:34:59.362703 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: Close
[0m01:34:59.363078 [info ] [Thread-3 (]: 8 of 22 PASS not_null_results_season ........................................... [[32mPASS[0m in 0.03s]
[0m01:34:59.363461 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:34:59.362107 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:34:59.418529 [debug] [Thread-1 (]: SQL status: OK in 0.929 seconds
[0m01:34:59.420368 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:34:59.420649 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps" rename to "laps__dbt_backup"
[0m01:34:59.421237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:34:59.451276 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:34:59.451714 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps__dbt_tmp" rename to "laps"
[0m01:34:59.452328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:34:59.453109 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:34:59.453352 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:34:59.453597 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:34:59.842706 [debug] [Thread-1 (]: SQL status: OK in 0.389 seconds
[0m01:34:59.844149 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:34:59.844395 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
drop table if exists "f1"."main_silver"."laps__dbt_backup" cascade
[0m01:34:59.845573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:34:59.846330 [debug] [Thread-1 (]: On model.f1_transform.laps: Close
[0m01:35:00.085627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e093010>]}
[0m01:35:00.086188 [info ] [Thread-1 (]: 1 of 22 OK created sql table model main_silver.laps ............................ [[32mOK[0m in 1.64s]
[0m01:35:00.086572 [debug] [Thread-1 (]: Finished running node model.f1_transform.laps
[0m01:35:00.087224 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:35:00.087432 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:35:00.087603 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:35:00.087818 [info ] [Thread-6 (]: 10 of 22 START test not_null_laps_round ........................................ [RUN]
[0m01:35:00.088142 [info ] [Thread-5 (]: 11 of 22 START test not_null_laps_season ....................................... [RUN]
[0m01:35:00.088467 [info ] [Thread-2 (]: 12 of 22 START test not_null_laps_session_code ................................. [RUN]
[0m01:35:00.088792 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_season.773def5ec8, now test.f1_transform.not_null_laps_round.c55865a754)
[0m01:35:00.089133 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_round.80e2ff036f, now test.f1_transform.not_null_laps_season.6c89aefec5)
[0m01:35:00.089426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_transform.results, now test.f1_transform.not_null_laps_session_code.ccd0209ff1)
[0m01:35:00.089651 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_laps_round.c55865a754
[0m01:35:00.089922 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:35:00.090172 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:35:00.092222 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:35:00.094150 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:35:00.095984 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:35:00.096913 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_laps_round.c55865a754
[0m01:35:00.098087 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:35:00.098248 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:35:00.099424 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:35:00.100441 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:35:00.100788 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:35:00.101752 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:35:00.102191 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: BEGIN
[0m01:35:00.102756 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:35:00.102566 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:35:00.103461 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:35:00.103679 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: BEGIN
[0m01:35:00.106305 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: BEGIN
[0m01:35:00.106636 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:35:00.106859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:35:00.110898 [debug] [Thread-6 (]: SQL status: OK in 0.008 seconds
[0m01:35:00.111241 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m01:35:00.111452 [debug] [Thread-5 (]: SQL status: OK in 0.005 seconds
[0m01:35:00.112100 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:35:00.111892 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:35:00.111604 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:35:00.112757 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_round.c55865a754"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."laps"
where round is null



      
    ) dbt_internal_test
[0m01:35:00.112550 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."laps"
where session_code is null



      
    ) dbt_internal_test
[0m01:35:00.112299 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_season.6c89aefec5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."laps"
where season is null



      
    ) dbt_internal_test
[0m01:35:00.113358 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.113933 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.114192 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.115009 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: ROLLBACK
[0m01:35:00.115747 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: ROLLBACK
[0m01:35:00.116442 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: ROLLBACK
[0m01:35:00.117340 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_laps_season.6c89aefec5'
[0m01:35:00.117062 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_laps_session_code.ccd0209ff1'
[0m01:35:00.116756 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_laps_round.c55865a754'
[0m01:35:00.118018 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: Close
[0m01:35:00.117805 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: Close
[0m01:35:00.117553 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: Close
[0m01:35:00.118376 [info ] [Thread-6 (]: 10 of 22 PASS not_null_laps_round .............................................. [[32mPASS[0m in 0.03s]
[0m01:35:00.118844 [info ] [Thread-2 (]: 12 of 22 PASS not_null_laps_session_code ....................................... [[32mPASS[0m in 0.03s]
[0m01:35:00.119760 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:35:00.119420 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:35:00.120185 [info ] [Thread-5 (]: 11 of 22 PASS not_null_laps_season ............................................. [[32mPASS[0m in 0.03s]
[0m01:35:00.120887 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:35:00.121321 [debug] [Thread-4 (]: Began running node model.f1_transform.driver_session_summary
[0m01:35:00.121753 [info ] [Thread-4 (]: 13 of 22 START sql table model main_gold.driver_session_summary ................ [RUN]
[0m01:35:00.122168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_round.69e7ee2263, now model.f1_transform.driver_session_summary)
[0m01:35:00.122379 [debug] [Thread-4 (]: Began compiling node model.f1_transform.driver_session_summary
[0m01:35:00.124118 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_transform.driver_session_summary"
[0m01:35:00.126303 [debug] [Thread-4 (]: Began executing node model.f1_transform.driver_session_summary
[0m01:35:00.127782 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_transform.driver_session_summary"
[0m01:35:00.128486 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:35:00.128693 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: BEGIN
[0m01:35:00.128906 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:35:00.134667 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m01:35:00.134946 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:35:00.135225 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."driver_session_summary__dbt_tmp"
  
    as (
      WITH laps AS (
  SELECT * FROM "f1"."main_silver"."laps" WHERE laptime IS NOT NULL
),
driver_base AS (
  SELECT
    season,
    round,
    grand_prix,
    session_code,
    COALESCE(NULLIF(driver, ''), CAST(drivernumber AS VARCHAR)) AS driver,
    drivernumber AS driver_number,
    team,
    laptime,
    pitintime,
    pitouttime
  FROM laps
),
ranker AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team, laptime,
    ROW_NUMBER() OVER (
      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team
      ORDER BY laptime ASC NULLS LAST
    ) AS rn
  FROM driver_base
),
pb AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps
  FROM ranker
  GROUP BY 1,2,3,4,5,6,7
),
agg AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    COUNT(*) AS laps_total,
    SUM(CASE WHEN pitintime IS NULL AND pitouttime IS NULL THEN 1 ELSE 0 END) AS laps_on_track,
    SUM(CASE WHEN pitintime IS NOT NULL OR  pitouttime IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,
    MIN(laptime) AS best_lap_time
  FROM driver_base
  GROUP BY 1,2,3,4,5,6,7
)
SELECT
  a.season, a.round, a.grand_prix, a.session_code,
  a.driver, a.driver_number, a.team,
  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,
  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps
FROM agg a
LEFT JOIN pb
  ON  a.season       = pb.season
  AND a.round        = pb.round
  AND a.grand_prix   = pb.grand_prix
  AND a.session_code = pb.session_code
  AND a.driver       = pb.driver
  AND a.driver_number= pb.driver_number
  AND a.team         = pb.team
    );
  
  
[0m01:35:00.170501 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m01:35:00.172238 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:35:00.172471 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
alter table "f1"."main_gold"."driver_session_summary" rename to "driver_session_summary__dbt_backup"
[0m01:35:00.172904 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.175330 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:35:00.175557 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
alter table "f1"."main_gold"."driver_session_summary__dbt_tmp" rename to "driver_session_summary"
[0m01:35:00.175975 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.176634 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m01:35:00.176851 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:35:00.177044 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m01:35:00.184959 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m01:35:00.186082 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:35:00.186285 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
drop table if exists "f1"."main_gold"."driver_session_summary__dbt_backup" cascade
[0m01:35:00.187034 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:35:00.187641 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: Close
[0m01:35:00.232598 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd2dd10>]}
[0m01:35:00.233052 [info ] [Thread-4 (]: 13 of 22 OK created sql table model main_gold.driver_session_summary ........... [[32mOK[0m in 0.11s]
[0m01:35:00.233444 [debug] [Thread-4 (]: Finished running node model.f1_transform.driver_session_summary
[0m01:35:00.234023 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:35:00.234205 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:35:00.234361 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:35:00.234562 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:35:00.234710 [info ] [Thread-8 (]: 14 of 22 START test not_null_driver_session_summary_driver ..................... [RUN]
[0m01:35:00.235016 [info ] [Thread-1 (]: 15 of 22 START test not_null_driver_session_summary_round ...................... [RUN]
[0m01:35:00.235338 [info ] [Thread-7 (]: 16 of 22 START test not_null_driver_session_summary_season ..................... [RUN]
[0m01:35:00.235670 [info ] [Thread-2 (]: 17 of 22 START test not_null_driver_session_summary_session_code ............... [RUN]
[0m01:35:00.236923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_session_code.ccd0209ff1, now test.f1_transform.not_null_driver_session_summary_session_code.68938a7773)
[0m01:35:00.236380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_transform.laps, now test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71)
[0m01:35:00.236667 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_session_code.2cbdf7ee2a, now test.f1_transform.not_null_driver_session_summary_season.30188e778b)
[0m01:35:00.236076 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_session_code.564091e2b6, now test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2)
[0m01:35:00.237851 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:35:00.237397 [debug] [Thread-1 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:35:00.237643 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:35:00.237142 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:35:00.239876 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:35:00.241695 [debug] [Thread-1 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:35:00.243642 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:35:00.245730 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:35:00.247846 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:35:00.250718 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:35:00.250935 [debug] [Thread-1 (]: Began executing node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:35:00.251107 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:35:00.251603 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:35:00.252859 [debug] [Thread-1 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:35:00.254118 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:35:00.255451 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:35:00.255666 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:35:00.256964 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: BEGIN
[0m01:35:00.256807 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:35:00.256541 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:35:00.257146 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m01:35:00.257578 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:35:00.257771 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: BEGIN
[0m01:35:00.258718 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m01:35:00.258461 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: BEGIN
[0m01:35:00.257987 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: BEGIN
[0m01:35:00.259335 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:35:00.261396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:00.267809 [debug] [Thread-7 (]: SQL status: OK in 0.009 seconds
[0m01:35:00.268042 [debug] [Thread-8 (]: SQL status: OK in 0.011 seconds
[0m01:35:00.268408 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:35:00.268588 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:35:00.268740 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m01:35:00.269659 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:35:00.269219 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_season.30188e778b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."driver_session_summary"
where season is null



      
    ) dbt_internal_test
[0m01:35:00.269470 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:35:00.268961 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:35:00.269839 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."driver_session_summary"
where session_code is null



      
    ) dbt_internal_test
[0m01:35:00.270295 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."driver_session_summary"
where round is null



      
    ) dbt_internal_test
[0m01:35:00.270569 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select driver
from "f1"."main_gold"."driver_session_summary"
where driver is null



      
    ) dbt_internal_test
[0m01:35:00.270748 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m01:35:00.271343 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.271660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.272575 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: ROLLBACK
[0m01:35:00.272747 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m01:35:00.273438 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: ROLLBACK
[0m01:35:00.274122 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: ROLLBACK
[0m01:35:00.274445 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_season.30188e778b'
[0m01:35:00.275126 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: ROLLBACK
[0m01:35:00.275398 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_session_code.68938a7773'
[0m01:35:00.275696 [debug] [Thread-1 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71'
[0m01:35:00.275923 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: Close
[0m01:35:00.276160 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2'
[0m01:35:00.276367 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: Close
[0m01:35:00.276610 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: Close
[0m01:35:00.276988 [info ] [Thread-7 (]: 16 of 22 PASS not_null_driver_session_summary_season ........................... [[32mPASS[0m in 0.04s]
[0m01:35:00.277244 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: Close
[0m01:35:00.277606 [info ] [Thread-2 (]: 17 of 22 PASS not_null_driver_session_summary_session_code ..................... [[32mPASS[0m in 0.04s]
[0m01:35:00.277943 [info ] [Thread-1 (]: 15 of 22 PASS not_null_driver_session_summary_round ............................ [[32mPASS[0m in 0.04s]
[0m01:35:00.278340 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:35:00.278842 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:35:00.279529 [info ] [Thread-8 (]: 14 of 22 PASS not_null_driver_session_summary_driver ........................... [[32mPASS[0m in 0.04s]
[0m01:35:00.280387 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:35:00.279750 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:35:00.281016 [debug] [Thread-5 (]: Began running node model.f1_transform.team_event_summary
[0m01:35:00.281344 [info ] [Thread-5 (]: 18 of 22 START sql table model main_gold.team_event_summary .................... [RUN]
[0m01:35:00.281648 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_season.6c89aefec5, now model.f1_transform.team_event_summary)
[0m01:35:00.281883 [debug] [Thread-5 (]: Began compiling node model.f1_transform.team_event_summary
[0m01:35:00.283397 [debug] [Thread-5 (]: Writing injected SQL for node "model.f1_transform.team_event_summary"
[0m01:35:00.284464 [debug] [Thread-5 (]: Began executing node model.f1_transform.team_event_summary
[0m01:35:00.285917 [debug] [Thread-5 (]: Writing runtime sql for node "model.f1_transform.team_event_summary"
[0m01:35:00.286855 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:35:00.287051 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: BEGIN
[0m01:35:00.287215 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:35:00.293265 [debug] [Thread-5 (]: SQL status: OK in 0.006 seconds
[0m01:35:00.293534 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:35:00.293726 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."team_event_summary__dbt_tmp"
  
    as (
      WITH driver AS (
  SELECT * FROM "f1"."main_gold"."driver_session_summary"
),
race_only AS (
  SELECT * FROM driver WHERE session_code IN ('R','Q','S')
),
team_agg AS (
  SELECT
    season, round, grand_prix, session_code,
    team,
    SUM(laps_on_track) AS team_laps_on_track,
    SUM(pitstops)      AS team_pitstops,
    MIN(best_lap_time) AS team_best_lap_time
  FROM race_only
  GROUP BY 1,2,3,4,5
)
SELECT * FROM team_agg
    );
  
  
[0m01:35:00.298691 [debug] [Thread-5 (]: SQL status: OK in 0.005 seconds
[0m01:35:00.301678 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:35:00.301939 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
alter table "f1"."main_gold"."team_event_summary" rename to "team_event_summary__dbt_backup"
[0m01:35:00.302439 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.303819 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:35:00.304035 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
alter table "f1"."main_gold"."team_event_summary__dbt_tmp" rename to "team_event_summary"
[0m01:35:00.304456 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.305123 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: COMMIT
[0m01:35:00.305333 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:35:00.305509 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: COMMIT
[0m01:35:00.308521 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m01:35:00.309616 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:35:00.309807 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
drop table if exists "f1"."main_gold"."team_event_summary__dbt_backup" cascade
[0m01:35:00.310750 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m01:35:00.311396 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: Close
[0m01:35:00.347054 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b177833f-0276-4531-b6f8-997f1d71141f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e015c50>]}
[0m01:35:00.347486 [info ] [Thread-5 (]: 18 of 22 OK created sql table model main_gold.team_event_summary ............... [[32mOK[0m in 0.07s]
[0m01:35:00.347823 [debug] [Thread-5 (]: Finished running node model.f1_transform.team_event_summary
[0m01:35:00.348408 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:35:00.348668 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:35:00.348858 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:35:00.349064 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:35:00.349231 [info ] [Thread-4 (]: 19 of 22 START test not_null_team_event_summary_round .......................... [RUN]
[0m01:35:00.349520 [info ] [Thread-6 (]: 20 of 22 START test not_null_team_event_summary_season ......................... [RUN]
[0m01:35:00.349924 [info ] [Thread-7 (]: 21 of 22 START test not_null_team_event_summary_session_code ................... [RUN]
[0m01:35:00.350241 [info ] [Thread-2 (]: 22 of 22 START test not_null_team_event_summary_team ........................... [RUN]
[0m01:35:00.350620 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_transform.driver_session_summary, now test.f1_transform.not_null_team_event_summary_round.bddcc074d0)
[0m01:35:00.351852 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:35:00.351323 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_season.30188e778b, now test.f1_transform.not_null_team_event_summary_session_code.e054c7119a)
[0m01:35:00.351620 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_session_code.68938a7773, now test.f1_transform.not_null_team_event_summary_team.23b41750d4)
[0m01:35:00.350915 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_round.c55865a754, now test.f1_transform.not_null_team_event_summary_season.19b7a0fa18)
[0m01:35:00.354681 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:35:00.354182 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:35:00.354446 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:35:00.353886 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:35:00.356458 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:35:00.358369 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:35:00.360297 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:35:00.362030 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:35:00.362431 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:35:00.364192 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:35:00.364489 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:35:00.365431 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:35:00.365740 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:35:00.366828 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:35:00.367247 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:35:00.368304 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:35:00.368628 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:35:00.369362 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: BEGIN
[0m01:35:00.369148 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:35:00.368846 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: BEGIN
[0m01:35:00.369574 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:35:00.369705 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:35:00.370507 [debug] [Thread-2 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: BEGIN
[0m01:35:00.370140 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:35:00.369923 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: BEGIN
[0m01:35:00.370718 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:35:00.373109 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m01:35:00.375624 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m01:35:00.376255 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:35:00.376415 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m01:35:00.376578 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m01:35:00.376722 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m01:35:00.376910 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."team_event_summary"
where season is null



      
    ) dbt_internal_test
[0m01:35:00.377163 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:35:00.377365 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:35:00.377589 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:35:00.378265 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.378429 [debug] [Thread-2 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_team.23b41750d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team
from "f1"."main_gold"."team_event_summary"
where team is null



      
    ) dbt_internal_test
[0m01:35:00.378680 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."team_event_summary"
where round is null



      
    ) dbt_internal_test
[0m01:35:00.378937 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."team_event_summary"
where session_code is null



      
    ) dbt_internal_test
[0m01:35:00.379893 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: ROLLBACK
[0m01:35:00.380480 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.380706 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:35:00.382718 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: ROLLBACK
[0m01:35:00.381393 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m01:35:00.382096 [debug] [Thread-2 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: ROLLBACK
[0m01:35:00.381231 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18'
[0m01:35:00.384194 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: Close
[0m01:35:00.383660 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: ROLLBACK
[0m01:35:00.383984 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_team.23b41750d4'
[0m01:35:00.382990 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0'
[0m01:35:00.385388 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: Close
[0m01:35:00.384855 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a'
[0m01:35:00.385171 [debug] [Thread-2 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: Close
[0m01:35:00.384529 [info ] [Thread-6 (]: 20 of 22 PASS not_null_team_event_summary_season ............................... [[32mPASS[0m in 0.03s]
[0m01:35:00.385662 [info ] [Thread-4 (]: 19 of 22 PASS not_null_team_event_summary_round ................................ [[32mPASS[0m in 0.04s]
[0m01:35:00.385969 [debug] [Thread-7 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: Close
[0m01:35:00.386315 [info ] [Thread-2 (]: 22 of 22 PASS not_null_team_event_summary_team ................................. [[32mPASS[0m in 0.03s]
[0m01:35:00.386684 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:35:00.386978 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:35:00.387475 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:35:00.388309 [info ] [Thread-7 (]: 21 of 22 PASS not_null_team_event_summary_session_code ......................... [[32mPASS[0m in 0.04s]
[0m01:35:00.388722 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:35:00.389962 [debug] [MainThread]: Using duckdb connection "master"
[0m01:35:00.390195 [debug] [MainThread]: On master: BEGIN
[0m01:35:00.390357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:35:00.395699 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:35:00.395956 [debug] [MainThread]: On master: COMMIT
[0m01:35:00.396148 [debug] [MainThread]: Using duckdb connection "master"
[0m01:35:00.396347 [debug] [MainThread]: On master: COMMIT
[0m01:35:00.396607 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:35:00.396792 [debug] [MainThread]: On master: Close
[0m01:35:00.397605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:00.397776 [debug] [MainThread]: Connection 'list_f1_main_silver' was properly closed.
[0m01:35:00.397919 [debug] [MainThread]: Connection 'list_f1_main_gold' was properly closed.
[0m01:35:00.398066 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71' was properly closed.
[0m01:35:00.398222 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_team.23b41750d4' was properly closed.
[0m01:35:00.398369 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_season.4571c4d0da' was properly closed.
[0m01:35:00.398511 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a' was properly closed.
[0m01:35:00.398655 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18' was properly closed.
[0m01:35:00.398797 [debug] [MainThread]: Connection 'model.f1_transform.team_event_summary' was properly closed.
[0m01:35:00.398957 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0' was properly closed.
[0m01:35:00.399099 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2' was properly closed.
[0m01:35:00.399323 [info ] [MainThread]: 
[0m01:35:00.399540 [info ] [MainThread]: Finished running 5 table models, 17 data tests in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m01:35:00.400961 [debug] [MainThread]: Command end result
[0m01:35:00.435613 [info ] [MainThread]: 
[0m01:35:00.435944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:35:00.436264 [info ] [MainThread]: 
[0m01:35:00.436500 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m01:35:00.437094 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.5631084, "process_user_time": 2.132435, "process_kernel_time": 0.49202, "process_mem_max_rss": "269148", "process_in_blocks": "83216", "process_out_blocks": "47260"}
[0m01:35:00.437372 [debug] [MainThread]: Command `dbt build` succeeded at 01:35:00.437317 after 2.56 seconds
[0m01:35:00.437599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7fdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a484410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a484e90>]}
[0m01:35:00.437816 [debug] [MainThread]: Flushing usage events
[0m01:37:03.745661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae840d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae87250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae870d0>]}


============================== 01:37:03.749562 | d7b93943-11b2-4df7-ac4b-e018918cfcc3 ==============================
[0m01:37:03.749562 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:37:03.750027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/transform/profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:37:03.791796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b93943-11b2-4df7-ac4b-e018918cfcc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf4de50>]}
[0m01:37:03.797622 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:37:03.798832 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:37:03.799470 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.080184415, "process_user_time": 0.695757, "process_kernel_time": 0.108961, "process_mem_max_rss": "97204", "process_out_blocks": "1659", "process_in_blocks": "0"}
[0m01:37:03.799781 [debug] [MainThread]: Command `dbt deps` succeeded at 01:37:03.799714 after 0.08 seconds
[0m01:37:03.800014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae909d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaee2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab166fd0>]}
[0m01:37:03.800262 [debug] [MainThread]: Flushing usage events
[0m01:37:04.614931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fc3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f09a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8442b4d0>]}


============================== 01:37:04.616460 | 94c57163-4a46-4a83-9348-c4a4c0792f83 ==============================
[0m01:37:04.616460 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:37:04.616845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/transform/profiles', 'log_path': '/opt/transform/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:37:04.713236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e79050>]}
[0m01:37:04.736467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862d2890>]}
[0m01:37:04.736951 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m01:37:04.767595 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:37:04.830413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:04.830721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:04.848836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef66490>]}
[0m01:37:04.919236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db9fdd0>]}
[0m01:37:04.919609 [info ] [MainThread]: Found 5 models, 17 data tests, 422 macros
[0m01:37:04.921239 [info ] [MainThread]: 
[0m01:37:04.921687 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:37:04.924333 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:37:04.931427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m01:37:04.948087 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:37:04.948318 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m01:37:04.948547 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:37:04.948799 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m01:37:04.949015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:04.949239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:04.986004 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m01:37:04.986253 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m01:37:04.990867 [debug] [ThreadPool]: On list_f1: Close
[0m01:37:04.991523 [debug] [ThreadPool]: On list_f1: Close
[0m01:37:04.992926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_gold)
[0m01:37:04.993320 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_gold"
"
[0m01:37:04.993085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_silver)
[0m01:37:04.996769 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:37:04.997051 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_silver"
"
[0m01:37:04.997260 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:37:04.998461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:04.998256 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:37:04.998960 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m01:37:05.000892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:05.003833 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:37:05.004143 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:37:05.005436 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:37:05.005626 [debug] [ThreadPool]: On create_f1_main_gold: BEGIN
[0m01:37:05.005880 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:05.006064 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:37:05.006265 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
    
        create schema if not exists "f1"."main_gold"
    
[0m01:37:05.006566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:05.007014 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:37:05.007220 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m01:37:05.007401 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m01:37:05.004855 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:37:05.007858 [debug] [ThreadPool]: On create_f1_main_silver: BEGIN
[0m01:37:05.008120 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:05.008330 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:37:05.008527 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
    
        create schema if not exists "f1"."main_silver"
    
[0m01:37:05.007665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:05.008989 [debug] [ThreadPool]: On create_f1_main_gold: Close
[0m01:37:05.008837 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:05.009645 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:37:05.009820 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m01:37:05.009967 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m01:37:05.010199 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:05.010370 [debug] [ThreadPool]: On create_f1_main_silver: Close
[0m01:37:05.011792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_silver, now list_f1_main_gold)
[0m01:37:05.012078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_gold, now list_f1_main_silver)
[0m01:37:05.015773 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:37:05.015957 [debug] [ThreadPool]: On list_f1_main_silver: BEGIN
[0m01:37:05.016110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:05.014783 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:37:05.016561 [debug] [ThreadPool]: On list_f1_main_gold: BEGIN
[0m01:37:05.017373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:05.020860 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:37:05.021325 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m01:37:05.021524 [debug] [ThreadPool]: On list_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_silver"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_silver'
    and table_catalog = 'f1'
  
[0m01:37:05.021111 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:37:05.025360 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m01:37:05.028294 [debug] [ThreadPool]: On list_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_gold"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_gold'
    and table_catalog = 'f1'
  
[0m01:37:05.033988 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m01:37:05.034785 [debug] [ThreadPool]: On list_f1_main_silver: ROLLBACK
[0m01:37:05.035229 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_silver'
[0m01:37:05.035406 [debug] [ThreadPool]: On list_f1_main_silver: Close
[0m01:37:05.037814 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:37:05.038484 [debug] [ThreadPool]: On list_f1_main_gold: ROLLBACK
[0m01:37:05.038742 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_gold'
[0m01:37:05.038926 [debug] [ThreadPool]: On list_f1_main_gold: Close
[0m01:37:05.040347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d6c990>]}
[0m01:37:05.040664 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:05.040842 [debug] [MainThread]: On master: BEGIN
[0m01:37:05.041024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:05.046457 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:37:05.046700 [debug] [MainThread]: On master: COMMIT
[0m01:37:05.046858 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:05.047036 [debug] [MainThread]: On master: COMMIT
[0m01:37:05.047308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:05.047497 [debug] [MainThread]: On master: Close
[0m01:37:05.048342 [info ] [MainThread]: Concurrency: 8 threads (target='local')
[0m01:37:05.048580 [info ] [MainThread]: 
[0m01:37:05.054736 [debug] [Thread-1 (]: Began running node model.f1_transform.laps
[0m01:37:05.054929 [debug] [Thread-2 (]: Began running node model.f1_transform.results
[0m01:37:05.055094 [debug] [Thread-3 (]: Began running node model.f1_transform.weather
[0m01:37:05.055425 [info ] [Thread-1 (]: 1 of 22 START sql table model main_silver.laps ................................. [RUN]
[0m01:37:05.055801 [info ] [Thread-2 (]: 2 of 22 START sql table model main_silver.results .............................. [RUN]
[0m01:37:05.056147 [info ] [Thread-3 (]: 3 of 22 START sql table model main_silver.weather .............................. [RUN]
[0m01:37:05.056534 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.f1_transform.laps'
[0m01:37:05.056850 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.f1_transform.results'
[0m01:37:05.057135 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.f1_transform.weather'
[0m01:37:05.057414 [debug] [Thread-1 (]: Began compiling node model.f1_transform.laps
[0m01:37:05.057687 [debug] [Thread-2 (]: Began compiling node model.f1_transform.results
[0m01:37:05.057937 [debug] [Thread-3 (]: Began compiling node model.f1_transform.weather
[0m01:37:05.061473 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_transform.laps"
[0m01:37:05.062455 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.results"
[0m01:37:05.064144 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.weather"
[0m01:37:05.065333 [debug] [Thread-1 (]: Began executing node model.f1_transform.laps
[0m01:37:05.071432 [debug] [Thread-2 (]: Began executing node model.f1_transform.results
[0m01:37:05.071640 [debug] [Thread-3 (]: Began executing node model.f1_transform.weather
[0m01:37:05.082187 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_transform.laps"
[0m01:37:05.083796 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.results"
[0m01:37:05.085166 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.weather"
[0m01:37:05.087187 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:37:05.087557 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:37:05.088047 [debug] [Thread-2 (]: On model.f1_transform.results: BEGIN
[0m01:37:05.087813 [debug] [Thread-3 (]: On model.f1_transform.weather: BEGIN
[0m01:37:05.087696 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:37:05.088261 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:37:05.088494 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:37:05.088746 [debug] [Thread-1 (]: On model.f1_transform.laps: BEGIN
[0m01:37:05.091573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:37:05.094647 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m01:37:05.094923 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m01:37:05.095106 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:37:05.095278 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:37:05.095960 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:37:05.095721 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:37:05.095469 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:37:05.096727 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:37:05.096177 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m01:37:05.501344 [debug] [Thread-3 (]: SQL status: OK in 0.405 seconds
[0m01:37:05.506272 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:37:05.510437 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather" rename to "weather__dbt_backup"
[0m01:37:05.512786 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:37:05.519089 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:37:05.519556 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather__dbt_tmp" rename to "weather"
[0m01:37:05.522954 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.535007 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:37:05.537342 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:37:05.540772 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m01:37:05.618059 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m01:37:05.622522 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m01:37:05.623620 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
drop table if exists "f1"."main_silver"."weather__dbt_backup" cascade
[0m01:37:05.630045 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m01:37:05.633063 [debug] [Thread-3 (]: On model.f1_transform.weather: Close
[0m01:37:05.639236 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bdf81d0>]}
[0m01:37:05.642358 [info ] [Thread-3 (]: 3 of 22 OK created sql table model main_silver.weather ......................... [[32mOK[0m in 0.58s]
[0m01:37:05.643358 [debug] [Thread-3 (]: Finished running node model.f1_transform.weather
[0m01:37:05.644471 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:37:05.644656 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:37:05.644815 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:37:05.645844 [info ] [Thread-5 (]: 4 of 22 START test not_null_weather_round ...................................... [RUN]
[0m01:37:05.646795 [info ] [Thread-6 (]: 5 of 22 START test not_null_weather_season ..................................... [RUN]
[0m01:37:05.650905 [info ] [Thread-7 (]: 6 of 22 START test not_null_weather_session_code ............................... [RUN]
[0m01:37:05.653712 [debug] [Thread-5 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:37:05.654492 [debug] [Thread-6 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:37:05.656342 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:37:05.660419 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:37:05.664317 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:37:05.667448 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:37:05.675462 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:37:05.678995 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:37:05.682285 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:37:05.696147 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:37:05.696888 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:37:05.704422 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:37:05.712605 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:37:05.717970 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:37:05.719952 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:37:05.728118 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:37:05.729011 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:37:05.729189 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: BEGIN
[0m01:37:05.730773 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:37:05.732806 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: BEGIN
[0m01:37:05.731805 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:37:05.730993 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: BEGIN
[0m01:37:05.734276 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:37:05.740100 [debug] [Thread-5 (]: SQL status: OK in 0.008 seconds
[0m01:37:05.741718 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m01:37:05.742931 [debug] [Thread-7 (]: SQL status: OK in 0.009 seconds
[0m01:37:05.748483 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m01:37:05.746982 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m01:37:05.744757 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m01:37:05.749247 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."weather"
where session_code is null



      
    ) dbt_internal_test
[0m01:37:05.750697 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m01:37:05.760707 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_season.773def5ec8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."weather"
where season is null



      
    ) dbt_internal_test
[0m01:37:05.760129 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m01:37:05.754182 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_round.80e2ff036f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."weather"
where round is null



      
    ) dbt_internal_test
[0m01:37:05.762595 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m01:37:05.766470 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: ROLLBACK
[0m01:37:05.769642 [debug] [Thread-2 (]: SQL status: OK in 0.673 seconds
[0m01:37:05.770631 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m01:37:05.773507 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: ROLLBACK
[0m01:37:05.776108 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m01:37:05.778932 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:37:05.781414 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: ROLLBACK
[0m01:37:05.782185 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m01:37:05.786698 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: Close
[0m01:37:05.788720 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results" rename to "results__dbt_backup"
[0m01:37:05.790584 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m01:37:05.793806 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: Close
[0m01:37:05.797594 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.798518 [info ] [Thread-7 (]: 6 of 22 PASS not_null_weather_session_code ..................................... [[32mPASS[0m in 0.14s]
[0m01:37:05.799875 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: Close
[0m01:37:05.803177 [info ] [Thread-6 (]: 5 of 22 PASS not_null_weather_season ........................................... [[32mPASS[0m in 0.15s]
[0m01:37:05.806610 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:37:05.809002 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m01:37:05.810221 [info ] [Thread-5 (]: 4 of 22 PASS not_null_weather_round ............................................ [[32mPASS[0m in 0.16s]
[0m01:37:05.812617 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_weather_season.773def5ec8
[0m01:37:05.814074 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results__dbt_tmp" rename to "results"
[0m01:37:05.821358 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m01:37:05.825327 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.829077 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:37:05.832381 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:37:05.833561 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m01:37:05.860379 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m01:37:05.861914 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m01:37:05.862173 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
drop table if exists "f1"."main_silver"."results__dbt_backup" cascade
[0m01:37:05.863315 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:37:05.864092 [debug] [Thread-2 (]: On model.f1_transform.results: Close
[0m01:37:05.864437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7bccd0>]}
[0m01:37:05.864835 [info ] [Thread-2 (]: 2 of 22 OK created sql table model main_silver.results ......................... [[32mOK[0m in 0.81s]
[0m01:37:05.865233 [debug] [Thread-2 (]: Finished running node model.f1_transform.results
[0m01:37:05.865741 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:37:05.865995 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:37:05.866225 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:37:05.866471 [info ] [Thread-4 (]: 7 of 22 START test not_null_results_round ...................................... [RUN]
[0m01:37:05.866770 [info ] [Thread-3 (]: 8 of 22 START test not_null_results_season ..................................... [RUN]
[0m01:37:05.867151 [info ] [Thread-8 (]: 9 of 22 START test not_null_results_session_code ............................... [RUN]
[0m01:37:05.867617 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:37:05.868547 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:37:05.868315 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:37:05.867925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_transform.weather, now test.f1_transform.not_null_results_season.4571c4d0da)
[0m01:37:05.871565 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:37:05.871346 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:37:05.871017 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:37:05.873558 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:37:05.875523 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:37:05.877368 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:37:05.878834 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:37:05.879080 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:37:05.879381 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:37:05.881862 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:37:05.883490 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:37:05.929190 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:37:05.929995 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: BEGIN
[0m01:37:05.931281 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:37:05.932084 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:37:05.931048 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:37:05.932534 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:37:05.932670 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m01:37:05.932928 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: BEGIN
[0m01:37:05.933674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:05.933443 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_round.69e7ee2263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."results"
where round is null



      
    ) dbt_internal_test
[0m01:37:05.933171 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: BEGIN
[0m01:37:05.934989 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:37:05.934772 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.934085 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.936475 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m01:37:05.936228 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: ROLLBACK
[0m01:37:05.935366 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.937304 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m01:37:05.937107 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m01:37:05.936695 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_season.4571c4d0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."results"
where season is null



      
    ) dbt_internal_test
[0m01:37:05.937545 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_session_code.564091e2b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."results"
where session_code is null



      
    ) dbt_internal_test
[0m01:37:05.937826 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: Close
[0m01:37:05.938442 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.939079 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.940136 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: ROLLBACK
[0m01:37:05.941592 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m01:37:05.941074 [info ] [Thread-4 (]: 7 of 22 PASS not_null_results_round ............................................ [[32mPASS[0m in 0.07s]
[0m01:37:05.940776 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: ROLLBACK
[0m01:37:05.942915 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_results_season.4571c4d0da'
[0m01:37:05.942595 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_results_round.69e7ee2263
[0m01:37:05.942043 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: Close
[0m01:37:05.943693 [info ] [Thread-8 (]: 9 of 22 PASS not_null_results_session_code ..................................... [[32mPASS[0m in 0.08s]
[0m01:37:05.944069 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m01:37:05.943116 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: Close
[0m01:37:05.944546 [info ] [Thread-3 (]: 8 of 22 PASS not_null_results_season ........................................... [[32mPASS[0m in 0.08s]
[0m01:37:05.944930 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_results_season.4571c4d0da
[0m01:37:05.991234 [debug] [Thread-1 (]: SQL status: OK in 0.893 seconds
[0m01:37:05.992936 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:37:05.993190 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps" rename to "laps__dbt_backup"
[0m01:37:05.993862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.995215 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:37:05.995461 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps__dbt_tmp" rename to "laps"
[0m01:37:05.995883 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:37:05.996733 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:37:05.996983 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:37:05.997267 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m01:37:06.382015 [debug] [Thread-1 (]: SQL status: OK in 0.384 seconds
[0m01:37:06.383526 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m01:37:06.383782 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
drop table if exists "f1"."main_silver"."laps__dbt_backup" cascade
[0m01:37:06.385054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.385909 [debug] [Thread-1 (]: On model.f1_transform.laps: Close
[0m01:37:06.651431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dba1bd0>]}
[0m01:37:06.651947 [info ] [Thread-1 (]: 1 of 22 OK created sql table model main_silver.laps ............................ [[32mOK[0m in 1.59s]
[0m01:37:06.652365 [debug] [Thread-1 (]: Finished running node model.f1_transform.laps
[0m01:37:06.653015 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:37:06.653237 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:37:06.653416 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:37:06.653642 [info ] [Thread-6 (]: 10 of 22 START test not_null_laps_round ........................................ [RUN]
[0m01:37:06.653960 [info ] [Thread-5 (]: 11 of 22 START test not_null_laps_season ....................................... [RUN]
[0m01:37:06.654301 [info ] [Thread-2 (]: 12 of 22 START test not_null_laps_session_code ................................. [RUN]
[0m01:37:06.655223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_transform.results, now test.f1_transform.not_null_laps_session_code.ccd0209ff1)
[0m01:37:06.654957 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_round.80e2ff036f, now test.f1_transform.not_null_laps_season.6c89aefec5)
[0m01:37:06.654653 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_season.773def5ec8, now test.f1_transform.not_null_laps_round.c55865a754)
[0m01:37:06.655424 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:37:06.655668 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:37:06.655886 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_laps_round.c55865a754
[0m01:37:06.657962 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:37:06.659872 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:37:06.661925 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:37:06.663787 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:37:06.664482 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:37:06.665512 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:37:06.665749 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_laps_round.c55865a754
[0m01:37:06.666784 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:37:06.668031 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:37:06.668348 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:37:06.668735 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: BEGIN
[0m01:37:06.668975 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:37:06.669136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:06.669345 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:37:06.669539 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: BEGIN
[0m01:37:06.670132 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: BEGIN
[0m01:37:06.672625 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:37:06.672365 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:37:06.675954 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m01:37:06.676641 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m01:37:06.676424 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m01:37:06.676190 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m01:37:06.677542 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m01:37:06.677219 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m01:37:06.676938 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_round.c55865a754"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."laps"
where round is null



      
    ) dbt_internal_test
[0m01:37:06.677780 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."laps"
where session_code is null



      
    ) dbt_internal_test
[0m01:37:06.678068 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_season.6c89aefec5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."laps"
where season is null



      
    ) dbt_internal_test
[0m01:37:06.678844 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.679437 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.679607 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.680454 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: ROLLBACK
[0m01:37:06.682226 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_laps_round.c55865a754'
[0m01:37:06.681918 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: ROLLBACK
[0m01:37:06.681189 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: ROLLBACK
[0m01:37:06.683015 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_laps_session_code.ccd0209ff1'
[0m01:37:06.682740 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_laps_season.6c89aefec5'
[0m01:37:06.682440 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_round.c55865a754: Close
[0m01:37:06.683800 [info ] [Thread-6 (]: 10 of 22 PASS not_null_laps_round .............................................. [[32mPASS[0m in 0.03s]
[0m01:37:06.683450 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: Close
[0m01:37:06.683208 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: Close
[0m01:37:06.684194 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_laps_round.c55865a754
[0m01:37:06.684636 [info ] [Thread-5 (]: 11 of 22 PASS not_null_laps_season ............................................. [[32mPASS[0m in 0.03s]
[0m01:37:06.686163 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m01:37:06.685777 [info ] [Thread-2 (]: 12 of 22 PASS not_null_laps_session_code ....................................... [[32mPASS[0m in 0.03s]
[0m01:37:06.686603 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m01:37:06.687085 [debug] [Thread-4 (]: Began running node model.f1_transform.driver_session_summary
[0m01:37:06.687423 [info ] [Thread-4 (]: 13 of 22 START sql table model main_gold.driver_session_summary ................ [RUN]
[0m01:37:06.687754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_round.69e7ee2263, now model.f1_transform.driver_session_summary)
[0m01:37:06.688031 [debug] [Thread-4 (]: Began compiling node model.f1_transform.driver_session_summary
[0m01:37:06.689867 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_transform.driver_session_summary"
[0m01:37:06.691804 [debug] [Thread-4 (]: Began executing node model.f1_transform.driver_session_summary
[0m01:37:06.693402 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_transform.driver_session_summary"
[0m01:37:06.694360 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:37:06.694576 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: BEGIN
[0m01:37:06.694769 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:06.700841 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m01:37:06.701150 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:37:06.701458 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."driver_session_summary__dbt_tmp"
  
    as (
      WITH laps AS (
  SELECT * FROM "f1"."main_silver"."laps" WHERE laptime IS NOT NULL
),
driver_base AS (
  SELECT
    season,
    round,
    grand_prix,
    session_code,
    COALESCE(NULLIF(driver, ''), CAST(drivernumber AS VARCHAR)) AS driver,
    drivernumber AS driver_number,
    team,
    laptime,
    pitintime,
    pitouttime
  FROM laps
),
ranker AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team, laptime,
    ROW_NUMBER() OVER (
      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team
      ORDER BY laptime ASC NULLS LAST
    ) AS rn
  FROM driver_base
),
pb AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps
  FROM ranker
  GROUP BY 1,2,3,4,5,6,7
),
agg AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    COUNT(*) AS laps_total,
    SUM(CASE WHEN pitintime IS NULL AND pitouttime IS NULL THEN 1 ELSE 0 END) AS laps_on_track,
    SUM(CASE WHEN pitintime IS NOT NULL OR  pitouttime IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,
    MIN(laptime) AS best_lap_time
  FROM driver_base
  GROUP BY 1,2,3,4,5,6,7
)
SELECT
  a.season, a.round, a.grand_prix, a.session_code,
  a.driver, a.driver_number, a.team,
  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,
  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps
FROM agg a
LEFT JOIN pb
  ON  a.season       = pb.season
  AND a.round        = pb.round
  AND a.grand_prix   = pb.grand_prix
  AND a.session_code = pb.session_code
  AND a.driver       = pb.driver
  AND a.driver_number= pb.driver_number
  AND a.team         = pb.team
    );
  
  
[0m01:37:06.733396 [debug] [Thread-4 (]: SQL status: OK in 0.032 seconds
[0m01:37:06.736072 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:37:06.736340 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
alter table "f1"."main_gold"."driver_session_summary" rename to "driver_session_summary__dbt_backup"
[0m01:37:06.736813 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.738145 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:37:06.738377 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
alter table "f1"."main_gold"."driver_session_summary__dbt_tmp" rename to "driver_session_summary"
[0m01:37:06.738755 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.739442 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m01:37:06.739666 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:37:06.739867 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m01:37:06.748901 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m01:37:06.750041 [debug] [Thread-4 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m01:37:06.750258 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
drop table if exists "f1"."main_gold"."driver_session_summary__dbt_backup" cascade
[0m01:37:06.751082 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.751746 [debug] [Thread-4 (]: On model.f1_transform.driver_session_summary: Close
[0m01:37:06.791324 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3e1510>]}
[0m01:37:06.791770 [info ] [Thread-4 (]: 13 of 22 OK created sql table model main_gold.driver_session_summary ........... [[32mOK[0m in 0.10s]
[0m01:37:06.792136 [debug] [Thread-4 (]: Finished running node model.f1_transform.driver_session_summary
[0m01:37:06.792663 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:37:06.792935 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:37:06.793127 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:37:06.793315 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:37:06.793472 [info ] [Thread-3 (]: 14 of 22 START test not_null_driver_session_summary_driver ..................... [RUN]
[0m01:37:06.793779 [info ] [Thread-1 (]: 15 of 22 START test not_null_driver_session_summary_round ...................... [RUN]
[0m01:37:06.794187 [info ] [Thread-7 (]: 16 of 22 START test not_null_driver_session_summary_season ..................... [RUN]
[0m01:37:06.794548 [info ] [Thread-6 (]: 17 of 22 START test not_null_driver_session_summary_session_code ............... [RUN]
[0m01:37:06.794865 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_season.4571c4d0da, now test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2)
[0m01:37:06.795151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_transform.laps, now test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71)
[0m01:37:06.795451 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_session_code.2cbdf7ee2a, now test.f1_transform.not_null_driver_session_summary_season.30188e778b)
[0m01:37:06.795738 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_round.c55865a754, now test.f1_transform.not_null_driver_session_summary_session_code.68938a7773)
[0m01:37:06.795974 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:37:06.796266 [debug] [Thread-1 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:37:06.796516 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:37:06.796759 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:37:06.798802 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:37:06.800694 [debug] [Thread-1 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:37:06.802603 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:37:06.804532 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:37:06.806863 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:37:06.807087 [debug] [Thread-1 (]: Began executing node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:37:06.808446 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:37:06.808587 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:37:06.809800 [debug] [Thread-1 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:37:06.809935 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:37:06.811120 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:37:06.811607 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:37:06.813661 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: BEGIN
[0m01:37:06.813350 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:37:06.812639 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:37:06.813852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:06.814110 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:37:06.814260 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: BEGIN
[0m01:37:06.814851 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: BEGIN
[0m01:37:06.815476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:06.817283 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:37:06.817718 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m01:37:06.818176 [debug] [Thread-6 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: BEGIN
[0m01:37:06.818594 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:37:06.821037 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m01:37:06.821241 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m01:37:06.821959 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m01:37:06.821555 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:37:06.821759 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m01:37:06.821399 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m01:37:06.822877 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m01:37:06.822416 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m01:37:06.822671 [debug] [Thread-6 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."driver_session_summary"
where session_code is null



      
    ) dbt_internal_test
[0m01:37:06.822152 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select driver
from "f1"."main_gold"."driver_session_summary"
where driver is null



      
    ) dbt_internal_test
[0m01:37:06.823091 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_season.30188e778b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."driver_session_summary"
where season is null



      
    ) dbt_internal_test
[0m01:37:06.823350 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."driver_session_summary"
where round is null



      
    ) dbt_internal_test
[0m01:37:06.823968 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.824122 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.824660 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.827127 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: ROLLBACK
[0m01:37:06.826318 [debug] [Thread-6 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: ROLLBACK
[0m01:37:06.826519 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:37:06.825593 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: ROLLBACK
[0m01:37:06.828683 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2'
[0m01:37:06.827727 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_session_code.68938a7773'
[0m01:37:06.828429 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: ROLLBACK
[0m01:37:06.827455 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_season.30188e778b'
[0m01:37:06.829751 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: Close
[0m01:37:06.829144 [debug] [Thread-6 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: Close
[0m01:37:06.829524 [debug] [Thread-1 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71'
[0m01:37:06.828890 [debug] [Thread-3 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: Close
[0m01:37:06.831104 [info ] [Thread-3 (]: 14 of 22 PASS not_null_driver_session_summary_driver ........................... [[32mPASS[0m in 0.04s]
[0m01:37:06.830448 [info ] [Thread-6 (]: 17 of 22 PASS not_null_driver_session_summary_session_code ..................... [[32mPASS[0m in 0.03s]
[0m01:37:06.830793 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: Close
[0m01:37:06.830058 [info ] [Thread-7 (]: 16 of 22 PASS not_null_driver_session_summary_season ........................... [[32mPASS[0m in 0.03s]
[0m01:37:06.831479 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m01:37:06.831819 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m01:37:06.832224 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m01:37:06.832924 [info ] [Thread-1 (]: 15 of 22 PASS not_null_driver_session_summary_round ............................ [[32mPASS[0m in 0.04s]
[0m01:37:06.833314 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m01:37:06.833823 [debug] [Thread-2 (]: Began running node model.f1_transform.team_event_summary
[0m01:37:06.834120 [info ] [Thread-2 (]: 18 of 22 START sql table model main_gold.team_event_summary .................... [RUN]
[0m01:37:06.834425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_session_code.ccd0209ff1, now model.f1_transform.team_event_summary)
[0m01:37:06.834664 [debug] [Thread-2 (]: Began compiling node model.f1_transform.team_event_summary
[0m01:37:06.836217 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.team_event_summary"
[0m01:37:06.836903 [debug] [Thread-2 (]: Began executing node model.f1_transform.team_event_summary
[0m01:37:06.839428 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.team_event_summary"
[0m01:37:06.840193 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:37:06.840375 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: BEGIN
[0m01:37:06.840540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:06.845594 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m01:37:06.845829 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:37:06.846013 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."team_event_summary__dbt_tmp"
  
    as (
      WITH driver AS (
  SELECT * FROM "f1"."main_gold"."driver_session_summary"
),
race_only AS (
  SELECT * FROM driver WHERE session_code IN ('R','Q','S')
),
team_agg AS (
  SELECT
    season, round, grand_prix, session_code,
    team,
    SUM(laps_on_track) AS team_laps_on_track,
    SUM(pitstops)      AS team_pitstops,
    MIN(best_lap_time) AS team_best_lap_time
  FROM race_only
  GROUP BY 1,2,3,4,5
)
SELECT * FROM team_agg
    );
  
  
[0m01:37:06.855174 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m01:37:06.856991 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:37:06.857229 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
alter table "f1"."main_gold"."team_event_summary" rename to "team_event_summary__dbt_backup"
[0m01:37:06.857648 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.858998 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:37:06.859244 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
alter table "f1"."main_gold"."team_event_summary__dbt_tmp" rename to "team_event_summary"
[0m01:37:06.859683 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.860363 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: COMMIT
[0m01:37:06.860578 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:37:06.860757 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: COMMIT
[0m01:37:06.863117 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m01:37:06.864236 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m01:37:06.864447 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
drop table if exists "f1"."main_gold"."team_event_summary__dbt_backup" cascade
[0m01:37:06.865427 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.866041 [debug] [Thread-2 (]: On model.f1_transform.team_event_summary: Close
[0m01:37:06.913662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c57163-4a46-4a83-9348-c4a4c0792f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86297350>]}
[0m01:37:06.914069 [info ] [Thread-2 (]: 18 of 22 OK created sql table model main_gold.team_event_summary ............... [[32mOK[0m in 0.08s]
[0m01:37:06.914406 [debug] [Thread-2 (]: Finished running node model.f1_transform.team_event_summary
[0m01:37:06.914981 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:37:06.915171 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:37:06.915370 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:37:06.915572 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:37:06.915738 [info ] [Thread-4 (]: 19 of 22 START test not_null_team_event_summary_round .......................... [RUN]
[0m01:37:06.916070 [info ] [Thread-5 (]: 20 of 22 START test not_null_team_event_summary_season ......................... [RUN]
[0m01:37:06.916523 [info ] [Thread-3 (]: 21 of 22 START test not_null_team_event_summary_session_code ................... [RUN]
[0m01:37:06.916853 [info ] [Thread-6 (]: 22 of 22 START test not_null_team_event_summary_team ........................... [RUN]
[0m01:37:06.918058 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_session_code.68938a7773, now test.f1_transform.not_null_team_event_summary_team.23b41750d4)
[0m01:37:06.917552 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_season.6c89aefec5, now test.f1_transform.not_null_team_event_summary_season.19b7a0fa18)
[0m01:37:06.917815 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2, now test.f1_transform.not_null_team_event_summary_session_code.e054c7119a)
[0m01:37:06.918791 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:37:06.918284 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:37:06.918542 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:37:06.917280 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_transform.driver_session_summary, now test.f1_transform.not_null_team_event_summary_round.bddcc074d0)
[0m01:37:06.920803 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:37:06.922546 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:37:06.924343 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:37:06.924663 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:37:06.928341 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:37:06.928511 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:37:06.930119 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:37:06.929035 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:37:06.928696 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:37:06.930459 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:37:06.931541 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:37:06.932671 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:37:06.932866 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:37:06.933854 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:37:06.934375 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: BEGIN
[0m01:37:06.934562 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:37:06.934911 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:37:06.935696 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: BEGIN
[0m01:37:06.935358 [debug] [Thread-5 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: BEGIN
[0m01:37:06.935523 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:37:06.935123 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:06.935857 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:37:06.936049 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:37:06.936267 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: BEGIN
[0m01:37:06.936787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:06.942126 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m01:37:06.942389 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m01:37:06.942660 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m01:37:06.942810 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m01:37:06.942963 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m01:37:06.943194 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m01:37:06.944272 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."team_event_summary"
where round is null



      
    ) dbt_internal_test
[0m01:37:06.943752 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m01:37:06.944018 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_team.23b41750d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team
from "f1"."main_gold"."team_event_summary"
where team is null



      
    ) dbt_internal_test
[0m01:37:06.943431 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m01:37:06.945654 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."team_event_summary"
where session_code is null



      
    ) dbt_internal_test
[0m01:37:06.945208 [debug] [Thread-5 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."team_event_summary"
where season is null



      
    ) dbt_internal_test
[0m01:37:06.945023 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.946023 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.946392 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m01:37:06.948914 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: ROLLBACK
[0m01:37:06.947534 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m01:37:06.948289 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: ROLLBACK
[0m01:37:06.947367 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: ROLLBACK
[0m01:37:06.949229 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a'
[0m01:37:06.949956 [debug] [Thread-5 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: ROLLBACK
[0m01:37:06.950249 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_team.23b41750d4'
[0m01:37:06.950522 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0'
[0m01:37:06.951474 [debug] [Thread-4 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: Close
[0m01:37:06.951004 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18'
[0m01:37:06.951258 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: Close
[0m01:37:06.950711 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: Close
[0m01:37:06.951809 [info ] [Thread-4 (]: 19 of 22 PASS not_null_team_event_summary_round ................................ [[32mPASS[0m in 0.03s]
[0m01:37:06.952063 [debug] [Thread-5 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: Close
[0m01:37:06.952532 [info ] [Thread-6 (]: 22 of 22 PASS not_null_team_event_summary_team ................................. [[32mPASS[0m in 0.03s]
[0m01:37:06.952837 [info ] [Thread-3 (]: 21 of 22 PASS not_null_team_event_summary_session_code ......................... [[32mPASS[0m in 0.04s]
[0m01:37:06.954196 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m01:37:06.953811 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m01:37:06.953247 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m01:37:06.954528 [info ] [Thread-5 (]: 20 of 22 PASS not_null_team_event_summary_season ............................... [[32mPASS[0m in 0.04s]
[0m01:37:06.955293 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m01:37:06.956482 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:06.956711 [debug] [MainThread]: On master: BEGIN
[0m01:37:06.956873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:06.962102 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m01:37:06.962368 [debug] [MainThread]: On master: COMMIT
[0m01:37:06.962530 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:06.962675 [debug] [MainThread]: On master: COMMIT
[0m01:37:06.962902 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:06.963067 [debug] [MainThread]: On master: Close
[0m01:37:06.963894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:06.964081 [debug] [MainThread]: Connection 'list_f1_main_silver' was properly closed.
[0m01:37:06.964229 [debug] [MainThread]: Connection 'list_f1_main_gold' was properly closed.
[0m01:37:06.964381 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71' was properly closed.
[0m01:37:06.964548 [debug] [MainThread]: Connection 'model.f1_transform.team_event_summary' was properly closed.
[0m01:37:06.964684 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a' was properly closed.
[0m01:37:06.964829 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18' was properly closed.
[0m01:37:06.964974 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_team.23b41750d4' was properly closed.
[0m01:37:06.965124 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_season.30188e778b' was properly closed.
[0m01:37:06.965265 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0' was properly closed.
[0m01:37:06.965408 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_session_code.564091e2b6' was properly closed.
[0m01:37:06.965645 [info ] [MainThread]: 
[0m01:37:06.965860 [info ] [MainThread]: Finished running 5 table models, 17 data tests in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m01:37:06.967322 [debug] [MainThread]: Command end result
[0m01:37:06.999433 [info ] [MainThread]: 
[0m01:37:06.999735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:07.000062 [info ] [MainThread]: 
[0m01:37:07.000359 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m01:37:07.001030 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.4081416, "process_user_time": 2.020604, "process_kernel_time": 0.512843, "process_mem_max_rss": "244712", "process_out_blocks": "47259", "process_in_blocks": "0"}
[0m01:37:07.001359 [debug] [MainThread]: Command `dbt build` succeeded at 01:37:07.001309 after 2.41 seconds
[0m01:37:07.001595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e0fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ab8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e521c50>]}
[0m01:37:07.001801 [debug] [MainThread]: Flushing usage events
[0m03:30:48.237146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96220d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9981650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9607a50>]}


============================== 03:30:48.244525 | d54f24d5-4b18-44c8-86b1-20b3f1328650 ==============================
[0m03:30:48.244525 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:30:48.245153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/transform/logs', 'profiles_dir': '/opt/transform/profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:30:48.316437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54f24d5-4b18-44c8-86b1-20b3f1328650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9981010>]}
[0m03:30:48.327116 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:30:48.333202 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:30:48.335617 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1420403, "process_user_time": 1.446686, "process_kernel_time": 0.285866, "process_mem_max_rss": "96524", "process_in_blocks": "8504", "process_out_blocks": "1659"}
[0m03:30:48.338679 [debug] [MainThread]: Command `dbt deps` succeeded at 03:30:48.338506 after 0.15 seconds
[0m03:30:48.339126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb963e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95eca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95dbbd0>]}
[0m03:30:48.339429 [debug] [MainThread]: Flushing usage events
[0m03:30:49.408058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24484d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25ff0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2448550>]}


============================== 03:30:49.409756 | 98f9c883-aef3-4f55-8aae-3da11d08872f ==============================
[0m03:30:49.409756 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:30:49.410161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/transform/profiles', 'log_path': '/opt/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:30:49.584549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24bedd0>]}
[0m03:30:49.616233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4952050>]}
[0m03:30:49.616968 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:30:49.662586 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:30:49.747031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:30:49.747373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:30:49.769055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24ad210>]}
[0m03:30:49.862892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24ac9d0>]}
[0m03:30:49.863522 [info ] [MainThread]: Found 5 models, 17 data tests, 422 macros
[0m03:30:49.870537 [info ] [MainThread]: 
[0m03:30:49.871765 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:30:49.876078 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m03:30:49.876666 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_f1'
[0m03:30:49.922536 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m03:30:49.922861 [debug] [ThreadPool]: Using duckdb connection "list_f1"
[0m03:30:49.923145 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m03:30:49.923434 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"f1"'
    
  
  
[0m03:30:49.923696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:49.923929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:49.981512 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m03:30:49.981872 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m03:30:49.983162 [debug] [ThreadPool]: On list_f1: Close
[0m03:30:49.984003 [debug] [ThreadPool]: On list_f1: Close
[0m03:30:49.987775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_gold)
[0m03:30:49.988009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_f1, now create_f1_main_silver)
[0m03:30:49.988350 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_gold"
"
[0m03:30:49.992476 [debug] [ThreadPool]: Creating schema "database: "f1"
schema: "main_silver"
"
[0m03:30:50.003964 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m03:30:50.007013 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m03:30:50.007319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:50.006287 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m03:30:50.008600 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
        select type from duckdb_databases()
        where database_name='f1'
        and type='sqlite'
    
  
[0m03:30:50.011499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:50.017218 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m03:30:50.017498 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m03:30:50.018483 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m03:30:50.019818 [debug] [ThreadPool]: On create_f1_main_gold: BEGIN
[0m03:30:50.019473 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m03:30:50.020850 [debug] [ThreadPool]: On create_f1_main_silver: BEGIN
[0m03:30:50.020627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:30:50.024118 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m03:30:50.024385 [debug] [ThreadPool]: On create_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_gold"} */

    
    
        create schema if not exists "f1"."main_gold"
    
[0m03:30:50.021952 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:30:50.025409 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m03:30:50.025780 [debug] [ThreadPool]: On create_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "create_f1_main_silver"} */

    
    
        create schema if not exists "f1"."main_silver"
    
[0m03:30:50.025170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:30:50.026990 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:30:50.028907 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m03:30:50.029148 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_silver"
[0m03:30:50.028340 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m03:30:50.029658 [debug] [ThreadPool]: Using duckdb connection "create_f1_main_gold"
[0m03:30:50.029925 [debug] [ThreadPool]: On create_f1_main_gold: COMMIT
[0m03:30:50.029395 [debug] [ThreadPool]: On create_f1_main_silver: COMMIT
[0m03:30:50.030967 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:30:50.031233 [debug] [ThreadPool]: On create_f1_main_silver: Close
[0m03:30:50.030598 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:30:50.031852 [debug] [ThreadPool]: On create_f1_main_gold: Close
[0m03:30:50.035883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_gold, now list_f1_main_gold)
[0m03:30:50.036517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_f1_main_silver, now list_f1_main_silver)
[0m03:30:50.040095 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m03:30:50.042152 [debug] [ThreadPool]: On list_f1_main_gold: BEGIN
[0m03:30:50.042359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:50.041825 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m03:30:50.043198 [debug] [ThreadPool]: On list_f1_main_silver: BEGIN
[0m03:30:50.045656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:50.050580 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:30:50.051416 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_silver"
[0m03:30:50.051814 [debug] [ThreadPool]: On list_f1_main_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_silver"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_silver'
    and table_catalog = 'f1'
  
[0m03:30:50.051078 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m03:30:50.060405 [debug] [ThreadPool]: Using duckdb connection "list_f1_main_gold"
[0m03:30:50.062406 [debug] [ThreadPool]: On list_f1_main_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "connection_name": "list_f1_main_gold"} */
select
      'f1' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_gold'
    and table_catalog = 'f1'
  
[0m03:30:50.070710 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m03:30:50.072031 [debug] [ThreadPool]: On list_f1_main_silver: ROLLBACK
[0m03:30:50.072761 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_silver'
[0m03:30:50.072968 [debug] [ThreadPool]: On list_f1_main_silver: Close
[0m03:30:50.071130 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m03:30:50.074189 [debug] [ThreadPool]: On list_f1_main_gold: ROLLBACK
[0m03:30:50.074500 [debug] [ThreadPool]: Failed to rollback 'list_f1_main_gold'
[0m03:30:50.074690 [debug] [ThreadPool]: On list_f1_main_gold: Close
[0m03:30:50.076312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1ac150>]}
[0m03:30:50.076707 [debug] [MainThread]: Using duckdb connection "master"
[0m03:30:50.076904 [debug] [MainThread]: On master: BEGIN
[0m03:30:50.077067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:30:50.084296 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m03:30:50.084679 [debug] [MainThread]: On master: COMMIT
[0m03:30:50.084890 [debug] [MainThread]: Using duckdb connection "master"
[0m03:30:50.085092 [debug] [MainThread]: On master: COMMIT
[0m03:30:50.085410 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:30:50.085601 [debug] [MainThread]: On master: Close
[0m03:30:50.086590 [info ] [MainThread]: Concurrency: 8 threads (target='local')
[0m03:30:50.086885 [info ] [MainThread]: 
[0m03:30:50.093395 [debug] [Thread-1 (]: Began running node model.f1_transform.laps
[0m03:30:50.093628 [debug] [Thread-2 (]: Began running node model.f1_transform.results
[0m03:30:50.093830 [debug] [Thread-3 (]: Began running node model.f1_transform.weather
[0m03:30:50.094192 [info ] [Thread-1 (]: 1 of 22 START sql table model main_silver.laps ................................. [RUN]
[0m03:30:50.094623 [info ] [Thread-2 (]: 2 of 22 START sql table model main_silver.results .............................. [RUN]
[0m03:30:50.094957 [info ] [Thread-3 (]: 3 of 22 START sql table model main_silver.weather .............................. [RUN]
[0m03:30:50.095327 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.f1_transform.laps'
[0m03:30:50.095649 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.f1_transform.results'
[0m03:30:50.095949 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.f1_transform.weather'
[0m03:30:50.096161 [debug] [Thread-1 (]: Began compiling node model.f1_transform.laps
[0m03:30:50.096425 [debug] [Thread-2 (]: Began compiling node model.f1_transform.results
[0m03:30:50.096664 [debug] [Thread-3 (]: Began compiling node model.f1_transform.weather
[0m03:30:50.100503 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_transform.laps"
[0m03:30:50.101619 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_transform.results"
[0m03:30:50.103519 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.weather"
[0m03:30:50.108908 [debug] [Thread-1 (]: Began executing node model.f1_transform.laps
[0m03:30:50.109140 [debug] [Thread-2 (]: Began executing node model.f1_transform.results
[0m03:30:50.109365 [debug] [Thread-3 (]: Began executing node model.f1_transform.weather
[0m03:30:50.127094 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_transform.laps"
[0m03:30:50.128785 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_transform.results"
[0m03:30:50.130423 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.weather"
[0m03:30:50.132149 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m03:30:50.132470 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m03:30:50.132672 [debug] [Thread-1 (]: On model.f1_transform.laps: BEGIN
[0m03:30:50.132826 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m03:30:50.133061 [debug] [Thread-3 (]: On model.f1_transform.weather: BEGIN
[0m03:30:50.133762 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:30:50.133552 [debug] [Thread-2 (]: On model.f1_transform.results: BEGIN
[0m03:30:50.133303 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:30:50.134332 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:30:50.141053 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m03:30:50.141700 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m03:30:50.141560 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m03:30:50.142218 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m03:30:50.141943 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */

  
    
    

    create  table
      "f1"."main_silver"."results__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m03:30:50.141326 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m03:30:50.142478 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */

  
    
    

    create  table
      "f1"."main_silver"."weather__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m03:30:50.143176 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m03:30:50.145878 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */

  
    
    

    create  table
      "f1"."main_silver"."laps__dbt_tmp"
  
    as (
      with src as (
  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)
)
select
  try_cast(season as integer) as season,
  try_cast(round  as integer) as round,
  cast(grand_prix as varchar) as grand_prix,
  cast(session    as varchar) as session_code,
  * exclude (season, round, grand_prix, session)
from src
    );
  
  
[0m03:30:50.583400 [debug] [Thread-3 (]: SQL status: OK in 0.439 seconds
[0m03:30:50.589548 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m03:30:50.591948 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather" rename to "weather__dbt_backup"
[0m03:30:50.594918 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m03:30:50.598551 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m03:30:50.602892 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
alter table "f1"."main_silver"."weather__dbt_tmp" rename to "weather"
[0m03:30:50.606870 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m03:30:50.623449 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m03:30:50.630381 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m03:30:50.633209 [debug] [Thread-3 (]: On model.f1_transform.weather: COMMIT
[0m03:30:50.699766 [debug] [Thread-3 (]: SQL status: OK in 0.065 seconds
[0m03:30:50.710123 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.weather"
[0m03:30:50.711678 [debug] [Thread-3 (]: On model.f1_transform.weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.weather"} */
drop table if exists "f1"."main_silver"."weather__dbt_backup" cascade
[0m03:30:50.720212 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m03:30:50.725593 [debug] [Thread-3 (]: On model.f1_transform.weather: Close
[0m03:30:50.730273 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9917010>]}
[0m03:30:50.732547 [info ] [Thread-3 (]: 3 of 22 OK created sql table model main_silver.weather ......................... [[32mOK[0m in 0.63s]
[0m03:30:50.734681 [debug] [Thread-3 (]: Finished running node model.f1_transform.weather
[0m03:30:50.741818 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m03:30:50.746575 [info ] [Thread-5 (]: 4 of 22 START test not_null_weather_round ...................................... [RUN]
[0m03:30:50.742476 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m03:30:50.742235 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_weather_season.773def5ec8
[0m03:30:50.749302 [debug] [Thread-5 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m03:30:50.754295 [info ] [Thread-7 (]: 6 of 22 START test not_null_weather_session_code ............................... [RUN]
[0m03:30:50.755799 [info ] [Thread-6 (]: 5 of 22 START test not_null_weather_season ..................................... [RUN]
[0m03:30:50.760928 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_weather_round.80e2ff036f
[0m03:30:50.762799 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m03:30:50.766742 [debug] [Thread-6 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m03:30:50.784577 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m03:30:50.787324 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m03:30:50.791454 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_weather_season.773def5ec8
[0m03:30:50.806977 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m03:30:50.820064 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_weather_round.80e2ff036f
[0m03:30:50.815219 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m03:30:50.839539 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m03:30:50.840436 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m03:30:50.854916 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m03:30:50.861967 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_weather_season.773def5ec8
[0m03:30:50.872683 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_weather_season.773def5ec8"
[0m03:30:50.873279 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m03:30:50.881791 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m03:30:50.882121 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: BEGIN
[0m03:30:50.884648 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: BEGIN
[0m03:30:50.895760 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m03:30:50.892337 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m03:30:50.890463 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m03:30:50.901221 [debug] [Thread-7 (]: SQL status: OK in 0.006 seconds
[0m03:30:50.912689 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"
[0m03:30:50.908366 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: BEGIN
[0m03:30:50.905647 [debug] [Thread-5 (]: SQL status: OK in 0.012 seconds
[0m03:30:50.917739 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."weather"
where session_code is null



      
    ) dbt_internal_test
[0m03:30:50.919230 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m03:30:50.923554 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_weather_round.80e2ff036f"
[0m03:30:50.927538 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m03:30:50.930947 [debug] [Thread-6 (]: SQL status: OK in 0.012 seconds
[0m03:30:50.933120 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_round.80e2ff036f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."weather"
where round is null



      
    ) dbt_internal_test
[0m03:30:50.937898 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: ROLLBACK
[0m03:30:50.938547 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_weather_season.773def5ec8"
[0m03:30:50.943029 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m03:30:50.944638 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_weather_session_code.2cbdf7ee2a'
[0m03:30:50.948348 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_weather_season.773def5ec8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."weather"
where season is null



      
    ) dbt_internal_test
[0m03:30:50.950605 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: ROLLBACK
[0m03:30:50.952130 [debug] [Thread-7 (]: On test.f1_transform.not_null_weather_session_code.2cbdf7ee2a: Close
[0m03:30:50.957008 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m03:30:50.961052 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_weather_round.80e2ff036f'
[0m03:30:50.971861 [info ] [Thread-7 (]: 6 of 22 PASS not_null_weather_session_code ..................................... [[32mPASS[0m in 0.21s]
[0m03:30:50.973822 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: ROLLBACK
[0m03:30:50.975901 [debug] [Thread-5 (]: On test.f1_transform.not_null_weather_round.80e2ff036f: Close
[0m03:30:50.981945 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_weather_session_code.2cbdf7ee2a
[0m03:30:51.001398 [debug] [Thread-2 (]: SQL status: OK in 0.858 seconds
[0m03:30:51.002298 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_weather_season.773def5ec8'
[0m03:30:51.007478 [info ] [Thread-5 (]: 4 of 22 PASS not_null_weather_round ............................................ [[32mPASS[0m in 0.26s]
[0m03:30:51.016360 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m03:30:51.017573 [debug] [Thread-6 (]: On test.f1_transform.not_null_weather_season.773def5ec8: Close
[0m03:30:51.022349 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_weather_round.80e2ff036f
[0m03:30:51.024738 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results" rename to "results__dbt_backup"
[0m03:30:51.025889 [info ] [Thread-6 (]: 5 of 22 PASS not_null_weather_season ........................................... [[32mPASS[0m in 0.26s]
[0m03:30:51.033447 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m03:30:51.034969 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_weather_season.773def5ec8
[0m03:30:51.040836 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m03:30:51.045872 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
alter table "f1"."main_silver"."results__dbt_tmp" rename to "results"
[0m03:30:51.047992 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.055340 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m03:30:51.057980 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m03:30:51.059863 [debug] [Thread-2 (]: On model.f1_transform.results: COMMIT
[0m03:30:51.100041 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m03:30:51.103551 [debug] [Thread-2 (]: Using duckdb connection "model.f1_transform.results"
[0m03:30:51.105959 [debug] [Thread-2 (]: On model.f1_transform.results: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.results"} */
drop table if exists "f1"."main_silver"."results__dbt_backup" cascade
[0m03:30:51.109821 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m03:30:51.112235 [debug] [Thread-2 (]: On model.f1_transform.results: Close
[0m03:30:51.119458 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac01190>]}
[0m03:30:51.120308 [info ] [Thread-2 (]: 2 of 22 OK created sql table model main_silver.results ......................... [[32mOK[0m in 1.02s]
[0m03:30:51.121059 [debug] [Thread-2 (]: Finished running node model.f1_transform.results
[0m03:30:51.122111 [debug] [Thread-4 (]: Began running node test.f1_transform.not_null_results_round.69e7ee2263
[0m03:30:51.122659 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_results_season.4571c4d0da
[0m03:30:51.123175 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m03:30:51.123433 [info ] [Thread-4 (]: 7 of 22 START test not_null_results_round ...................................... [RUN]
[0m03:30:51.124168 [info ] [Thread-3 (]: 8 of 22 START test not_null_results_season ..................................... [RUN]
[0m03:30:51.124779 [info ] [Thread-8 (]: 9 of 22 START test not_null_results_session_code ............................... [RUN]
[0m03:30:51.125427 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m03:30:51.127118 [debug] [Thread-4 (]: Began compiling node test.f1_transform.not_null_results_round.69e7ee2263
[0m03:30:51.126604 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m03:30:51.126008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_transform.weather, now test.f1_transform.not_null_results_season.4571c4d0da)
[0m03:30:51.130678 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_results_season.4571c4d0da
[0m03:30:51.130345 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_results_session_code.564091e2b6
[0m03:30:51.129872 [debug] [Thread-4 (]: Writing injected SQL for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m03:30:51.132801 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m03:30:51.135367 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m03:30:51.137100 [debug] [Thread-4 (]: Began executing node test.f1_transform.not_null_results_round.69e7ee2263
[0m03:30:51.137364 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_results_season.4571c4d0da
[0m03:30:51.141476 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_results_season.4571c4d0da"
[0m03:30:51.138837 [debug] [Thread-4 (]: Writing runtime sql for node "test.f1_transform.not_null_results_round.69e7ee2263"
[0m03:30:51.141698 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_results_session_code.564091e2b6
[0m03:30:51.225845 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m03:30:51.226164 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m03:30:51.226343 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m03:30:51.227004 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: BEGIN
[0m03:30:51.228015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:30:51.227729 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: BEGIN
[0m03:30:51.229078 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:30:51.228926 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.229893 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_results_season.4571c4d0da"
[0m03:30:51.229624 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.230486 [debug] [Thread-4 (]: Using duckdb connection "test.f1_transform.not_null_results_round.69e7ee2263"
[0m03:30:51.230139 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_season.4571c4d0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."results"
where season is null



      
    ) dbt_internal_test
[0m03:30:51.227522 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m03:30:51.230726 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_round.69e7ee2263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."results"
where round is null



      
    ) dbt_internal_test
[0m03:30:51.231869 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.233810 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: ROLLBACK
[0m03:30:51.232957 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m03:30:51.235080 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: ROLLBACK
[0m03:30:51.234227 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_results_season.4571c4d0da'
[0m03:30:51.235958 [debug] [Thread-3 (]: On test.f1_transform.not_null_results_season.4571c4d0da: Close
[0m03:30:51.235590 [debug] [Thread-4 (]: Failed to rollback 'test.f1_transform.not_null_results_round.69e7ee2263'
[0m03:30:51.232097 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: BEGIN
[0m03:30:51.237240 [info ] [Thread-3 (]: 8 of 22 PASS not_null_results_season ........................................... [[32mPASS[0m in 0.11s]
[0m03:30:51.237981 [debug] [Thread-4 (]: On test.f1_transform.not_null_results_round.69e7ee2263: Close
[0m03:30:51.238490 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m03:30:51.239154 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_results_season.4571c4d0da
[0m03:30:51.239638 [info ] [Thread-4 (]: 7 of 22 PASS not_null_results_round ............................................ [[32mPASS[0m in 0.11s]
[0m03:30:51.240923 [debug] [Thread-4 (]: Finished running node test.f1_transform.not_null_results_round.69e7ee2263
[0m03:30:51.240400 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m03:30:51.241372 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_results_session_code.564091e2b6"
[0m03:30:51.241709 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_results_session_code.564091e2b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."results"
where session_code is null



      
    ) dbt_internal_test
[0m03:30:51.242664 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.243722 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: ROLLBACK
[0m03:30:51.244451 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_results_session_code.564091e2b6'
[0m03:30:51.245736 [debug] [Thread-8 (]: On test.f1_transform.not_null_results_session_code.564091e2b6: Close
[0m03:30:51.246726 [info ] [Thread-8 (]: 9 of 22 PASS not_null_results_session_code ..................................... [[32mPASS[0m in 0.12s]
[0m03:30:51.247780 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_results_session_code.564091e2b6
[0m03:30:51.282570 [debug] [Thread-1 (]: SQL status: OK in 1.134 seconds
[0m03:30:51.286476 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m03:30:51.286976 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps" rename to "laps__dbt_backup"
[0m03:30:51.287921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.290036 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m03:30:51.290512 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
alter table "f1"."main_silver"."laps__dbt_tmp" rename to "laps"
[0m03:30:51.291415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.292535 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m03:30:51.292918 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m03:30:51.293341 [debug] [Thread-1 (]: On model.f1_transform.laps: COMMIT
[0m03:30:51.694322 [debug] [Thread-1 (]: SQL status: OK in 0.400 seconds
[0m03:30:51.696771 [debug] [Thread-1 (]: Using duckdb connection "model.f1_transform.laps"
[0m03:30:51.697119 [debug] [Thread-1 (]: On model.f1_transform.laps: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.laps"} */
drop table if exists "f1"."main_silver"."laps__dbt_backup" cascade
[0m03:30:51.698448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:30:51.699569 [debug] [Thread-1 (]: On model.f1_transform.laps: Close
[0m03:30:51.946545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf378450>]}
[0m03:30:51.949374 [info ] [Thread-1 (]: 1 of 22 OK created sql table model main_silver.laps ............................ [[32mOK[0m in 1.85s]
[0m03:30:51.950147 [debug] [Thread-1 (]: Finished running node model.f1_transform.laps
[0m03:30:51.951411 [debug] [Thread-5 (]: Began running node test.f1_transform.not_null_laps_round.c55865a754
[0m03:30:51.951651 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m03:30:51.951939 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m03:30:51.952375 [info ] [Thread-5 (]: 10 of 22 START test not_null_laps_round ........................................ [RUN]
[0m03:30:51.952910 [info ] [Thread-6 (]: 11 of 22 START test not_null_laps_season ....................................... [RUN]
[0m03:30:51.953540 [info ] [Thread-2 (]: 12 of 22 START test not_null_laps_session_code ................................. [RUN]
[0m03:30:51.954250 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_round.80e2ff036f, now test.f1_transform.not_null_laps_round.c55865a754)
[0m03:30:51.954660 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_season.773def5ec8, now test.f1_transform.not_null_laps_season.6c89aefec5)
[0m03:30:51.955038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_transform.results, now test.f1_transform.not_null_laps_session_code.ccd0209ff1)
[0m03:30:51.955448 [debug] [Thread-5 (]: Began compiling node test.f1_transform.not_null_laps_round.c55865a754
[0m03:30:51.955738 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_laps_season.6c89aefec5
[0m03:30:51.956044 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m03:30:51.959739 [debug] [Thread-5 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m03:30:51.962605 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m03:30:51.965585 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m03:30:51.967762 [debug] [Thread-5 (]: Began executing node test.f1_transform.not_null_laps_round.c55865a754
[0m03:30:51.969442 [debug] [Thread-5 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_round.c55865a754"
[0m03:30:51.969662 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_laps_season.6c89aefec5
[0m03:30:51.974018 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m03:30:51.975264 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m03:30:51.976747 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m03:30:51.977584 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m03:30:51.979901 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_round.c55865a754: BEGIN
[0m03:30:51.979634 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m03:30:51.980313 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m03:30:51.980896 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m03:30:51.981155 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: BEGIN
[0m03:30:51.981541 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: BEGIN
[0m03:30:51.982981 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:30:51.982361 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m03:30:51.994496 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m03:30:51.995380 [debug] [Thread-6 (]: SQL status: OK in 0.012 seconds
[0m03:30:51.996927 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_laps_season.6c89aefec5"
[0m03:30:51.996589 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_laps_session_code.ccd0209ff1"
[0m03:30:51.996379 [debug] [Thread-5 (]: SQL status: OK in 0.015 seconds
[0m03:30:52.001041 [debug] [Thread-5 (]: Using duckdb connection "test.f1_transform.not_null_laps_round.c55865a754"
[0m03:30:52.000759 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_silver"."laps"
where session_code is null



      
    ) dbt_internal_test
[0m03:30:52.000424 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_season.6c89aefec5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_silver"."laps"
where season is null



      
    ) dbt_internal_test
[0m03:30:52.003486 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_round.c55865a754: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_laps_round.c55865a754"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_silver"."laps"
where round is null



      
    ) dbt_internal_test
[0m03:30:52.004574 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m03:30:52.006894 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: ROLLBACK
[0m03:30:52.007598 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_laps_session_code.ccd0209ff1'
[0m03:30:52.007887 [debug] [Thread-2 (]: On test.f1_transform.not_null_laps_session_code.ccd0209ff1: Close
[0m03:30:52.005574 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m03:30:52.010150 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: ROLLBACK
[0m03:30:52.008468 [info ] [Thread-2 (]: 12 of 22 PASS not_null_laps_session_code ....................................... [[32mPASS[0m in 0.05s]
[0m03:30:52.013841 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_laps_session_code.ccd0209ff1
[0m03:30:52.013463 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_laps_season.6c89aefec5'
[0m03:30:52.016384 [debug] [Thread-6 (]: On test.f1_transform.not_null_laps_season.6c89aefec5: Close
[0m03:30:52.016768 [info ] [Thread-6 (]: 11 of 22 PASS not_null_laps_season ............................................. [[32mPASS[0m in 0.06s]
[0m03:30:52.019528 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_laps_season.6c89aefec5
[0m03:30:52.007103 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m03:30:52.020938 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_round.c55865a754: ROLLBACK
[0m03:30:52.025466 [debug] [Thread-5 (]: Failed to rollback 'test.f1_transform.not_null_laps_round.c55865a754'
[0m03:30:52.025726 [debug] [Thread-5 (]: On test.f1_transform.not_null_laps_round.c55865a754: Close
[0m03:30:52.029013 [info ] [Thread-5 (]: 10 of 22 PASS not_null_laps_round .............................................. [[32mPASS[0m in 0.07s]
[0m03:30:52.029423 [debug] [Thread-5 (]: Finished running node test.f1_transform.not_null_laps_round.c55865a754
[0m03:30:52.030948 [debug] [Thread-3 (]: Began running node model.f1_transform.driver_session_summary
[0m03:30:52.031417 [info ] [Thread-3 (]: 13 of 22 START sql table model main_gold.driver_session_summary ................ [RUN]
[0m03:30:52.031755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_season.4571c4d0da, now model.f1_transform.driver_session_summary)
[0m03:30:52.031986 [debug] [Thread-3 (]: Began compiling node model.f1_transform.driver_session_summary
[0m03:30:52.033850 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_transform.driver_session_summary"
[0m03:30:52.035354 [debug] [Thread-3 (]: Began executing node model.f1_transform.driver_session_summary
[0m03:30:52.037188 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_transform.driver_session_summary"
[0m03:30:52.038322 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m03:30:52.038543 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: BEGIN
[0m03:30:52.038756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:30:52.045122 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m03:30:52.045445 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m03:30:52.045685 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."driver_session_summary__dbt_tmp"
  
    as (
      WITH laps AS (
  SELECT * FROM "f1"."main_silver"."laps" WHERE laptime IS NOT NULL
),
driver_base AS (
  SELECT
    season,
    round,
    grand_prix,
    session_code,
    COALESCE(NULLIF(driver, ''), CAST(drivernumber AS VARCHAR)) AS driver,
    drivernumber AS driver_number,
    team,
    laptime,
    pitintime,
    pitouttime
  FROM laps
),
ranker AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team, laptime,
    ROW_NUMBER() OVER (
      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team
      ORDER BY laptime ASC NULLS LAST
    ) AS rn
  FROM driver_base
),
pb AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps
  FROM ranker
  GROUP BY 1,2,3,4,5,6,7
),
agg AS (
  SELECT
    season, round, grand_prix, session_code, driver, driver_number, team,
    COUNT(*) AS laps_total,
    SUM(CASE WHEN pitintime IS NULL AND pitouttime IS NULL THEN 1 ELSE 0 END) AS laps_on_track,
    SUM(CASE WHEN pitintime IS NOT NULL OR  pitouttime IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,
    MIN(laptime) AS best_lap_time
  FROM driver_base
  GROUP BY 1,2,3,4,5,6,7
)
SELECT
  a.season, a.round, a.grand_prix, a.session_code,
  a.driver, a.driver_number, a.team,
  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,
  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps
FROM agg a
LEFT JOIN pb
  ON  a.season       = pb.season
  AND a.round        = pb.round
  AND a.grand_prix   = pb.grand_prix
  AND a.session_code = pb.session_code
  AND a.driver       = pb.driver
  AND a.driver_number= pb.driver_number
  AND a.team         = pb.team
    );
  
  
[0m03:30:52.080010 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m03:30:52.083312 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m03:30:52.083591 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
alter table "f1"."main_gold"."driver_session_summary" rename to "driver_session_summary__dbt_backup"
[0m03:30:52.084093 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.085540 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m03:30:52.085770 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
alter table "f1"."main_gold"."driver_session_summary__dbt_tmp" rename to "driver_session_summary"
[0m03:30:52.086145 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.086886 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m03:30:52.087125 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m03:30:52.087331 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: COMMIT
[0m03:30:52.095442 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m03:30:52.096749 [debug] [Thread-3 (]: Using duckdb connection "model.f1_transform.driver_session_summary"
[0m03:30:52.096967 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.driver_session_summary"} */
drop table if exists "f1"."main_gold"."driver_session_summary__dbt_backup" cascade
[0m03:30:52.097928 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m03:30:52.098736 [debug] [Thread-3 (]: On model.f1_transform.driver_session_summary: Close
[0m03:30:52.143549 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac69fd0>]}
[0m03:30:52.144073 [info ] [Thread-3 (]: 13 of 22 OK created sql table model main_gold.driver_session_summary ........... [[32mOK[0m in 0.11s]
[0m03:30:52.144536 [debug] [Thread-3 (]: Finished running node model.f1_transform.driver_session_summary
[0m03:30:52.145072 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m03:30:52.145368 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m03:30:52.145637 [debug] [Thread-7 (]: Began running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m03:30:52.145804 [info ] [Thread-8 (]: 14 of 22 START test not_null_driver_session_summary_driver ..................... [RUN]
[0m03:30:52.146016 [debug] [Thread-2 (]: Began running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m03:30:52.146359 [info ] [Thread-1 (]: 15 of 22 START test not_null_driver_session_summary_round ...................... [RUN]
[0m03:30:52.146686 [info ] [Thread-7 (]: 16 of 22 START test not_null_driver_session_summary_season ..................... [RUN]
[0m03:30:52.147058 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_results_session_code.564091e2b6, now test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2)
[0m03:30:52.147371 [info ] [Thread-2 (]: 17 of 22 START test not_null_driver_session_summary_session_code ............... [RUN]
[0m03:30:52.147693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_transform.laps, now test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71)
[0m03:30:52.148007 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_weather_session_code.2cbdf7ee2a, now test.f1_transform.not_null_driver_session_summary_season.30188e778b)
[0m03:30:52.148250 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m03:30:52.148598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_session_code.ccd0209ff1, now test.f1_transform.not_null_driver_session_summary_session_code.68938a7773)
[0m03:30:52.148874 [debug] [Thread-1 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m03:30:52.149170 [debug] [Thread-7 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m03:30:52.151562 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m03:30:52.151951 [debug] [Thread-2 (]: Began compiling node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m03:30:52.154216 [debug] [Thread-1 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m03:30:52.156331 [debug] [Thread-7 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m03:30:52.158650 [debug] [Thread-2 (]: Writing injected SQL for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m03:30:52.159359 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m03:30:52.159810 [debug] [Thread-1 (]: Began executing node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m03:30:52.162793 [debug] [Thread-1 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m03:30:52.161439 [debug] [Thread-7 (]: Began executing node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m03:30:52.161729 [debug] [Thread-2 (]: Began executing node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m03:30:52.165287 [debug] [Thread-2 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m03:30:52.164104 [debug] [Thread-7 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m03:30:52.161108 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m03:30:52.165745 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m03:30:52.166290 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m03:30:52.166531 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: BEGIN
[0m03:30:52.167192 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m03:30:52.167436 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: BEGIN
[0m03:30:52.167589 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m03:30:52.168523 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: BEGIN
[0m03:30:52.168074 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: BEGIN
[0m03:30:52.168315 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:30:52.167819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:52.168698 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m03:30:52.168968 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m03:30:52.178649 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m03:30:52.178960 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m03:30:52.179100 [debug] [Thread-8 (]: SQL status: OK in 0.010 seconds
[0m03:30:52.179318 [debug] [Thread-7 (]: SQL status: OK in 0.010 seconds
[0m03:30:52.179490 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"
[0m03:30:52.180473 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."driver_session_summary"
where round is null



      
    ) dbt_internal_test
[0m03:30:52.179986 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"
[0m03:30:52.180236 [debug] [Thread-7 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_season.30188e778b"
[0m03:30:52.181602 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_season.30188e778b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."driver_session_summary"
where season is null



      
    ) dbt_internal_test
[0m03:30:52.181180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.181362 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select driver
from "f1"."main_gold"."driver_session_summary"
where driver is null



      
    ) dbt_internal_test
[0m03:30:52.179740 [debug] [Thread-2 (]: Using duckdb connection "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"
[0m03:30:52.183576 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."driver_session_summary"
where session_code is null



      
    ) dbt_internal_test
[0m03:30:52.183084 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: ROLLBACK
[0m03:30:52.182189 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.183985 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m03:30:52.184328 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.184616 [debug] [Thread-1 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71'
[0m03:30:52.185428 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: ROLLBACK
[0m03:30:52.186107 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: ROLLBACK
[0m03:30:52.186821 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: ROLLBACK
[0m03:30:52.187062 [debug] [Thread-1 (]: On test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71: Close
[0m03:30:52.187388 [debug] [Thread-7 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_season.30188e778b'
[0m03:30:52.187724 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2'
[0m03:30:52.188011 [debug] [Thread-2 (]: Failed to rollback 'test.f1_transform.not_null_driver_session_summary_session_code.68938a7773'
[0m03:30:52.188466 [info ] [Thread-1 (]: 15 of 22 PASS not_null_driver_session_summary_round ............................ [[32mPASS[0m in 0.04s]
[0m03:30:52.188751 [debug] [Thread-7 (]: On test.f1_transform.not_null_driver_session_summary_season.30188e778b: Close
[0m03:30:52.189024 [debug] [Thread-8 (]: On test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2: Close
[0m03:30:52.189300 [debug] [Thread-2 (]: On test.f1_transform.not_null_driver_session_summary_session_code.68938a7773: Close
[0m03:30:52.189692 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71
[0m03:30:52.190038 [info ] [Thread-7 (]: 16 of 22 PASS not_null_driver_session_summary_season ........................... [[32mPASS[0m in 0.04s]
[0m03:30:52.190433 [info ] [Thread-8 (]: 14 of 22 PASS not_null_driver_session_summary_driver ........................... [[32mPASS[0m in 0.04s]
[0m03:30:52.192282 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2
[0m03:30:52.191932 [debug] [Thread-7 (]: Finished running node test.f1_transform.not_null_driver_session_summary_season.30188e778b
[0m03:30:52.191679 [info ] [Thread-2 (]: 17 of 22 PASS not_null_driver_session_summary_session_code ..................... [[32mPASS[0m in 0.04s]
[0m03:30:52.192901 [debug] [Thread-2 (]: Finished running node test.f1_transform.not_null_driver_session_summary_session_code.68938a7773
[0m03:30:52.193421 [debug] [Thread-5 (]: Began running node model.f1_transform.team_event_summary
[0m03:30:52.193736 [info ] [Thread-5 (]: 18 of 22 START sql table model main_gold.team_event_summary .................... [RUN]
[0m03:30:52.194014 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_round.c55865a754, now model.f1_transform.team_event_summary)
[0m03:30:52.194224 [debug] [Thread-5 (]: Began compiling node model.f1_transform.team_event_summary
[0m03:30:52.195849 [debug] [Thread-5 (]: Writing injected SQL for node "model.f1_transform.team_event_summary"
[0m03:30:52.196628 [debug] [Thread-5 (]: Began executing node model.f1_transform.team_event_summary
[0m03:30:52.199502 [debug] [Thread-5 (]: Writing runtime sql for node "model.f1_transform.team_event_summary"
[0m03:30:52.200477 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m03:30:52.200700 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: BEGIN
[0m03:30:52.200886 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m03:30:52.206576 [debug] [Thread-5 (]: SQL status: OK in 0.006 seconds
[0m03:30:52.206883 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m03:30:52.207105 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */

  
    
    

    create  table
      "f1"."main_gold"."team_event_summary__dbt_tmp"
  
    as (
      WITH driver AS (
  SELECT * FROM "f1"."main_gold"."driver_session_summary"
),
race_only AS (
  SELECT * FROM driver WHERE session_code IN ('R','Q','S')
),
team_agg AS (
  SELECT
    season, round, grand_prix, session_code,
    team,
    SUM(laps_on_track) AS team_laps_on_track,
    SUM(pitstops)      AS team_pitstops,
    MIN(best_lap_time) AS team_best_lap_time
  FROM race_only
  GROUP BY 1,2,3,4,5
)
SELECT * FROM team_agg
    );
  
  
[0m03:30:52.216403 [debug] [Thread-5 (]: SQL status: OK in 0.009 seconds
[0m03:30:52.218176 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m03:30:52.218477 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
alter table "f1"."main_gold"."team_event_summary" rename to "team_event_summary__dbt_backup"
[0m03:30:52.218983 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.220487 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m03:30:52.220736 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
alter table "f1"."main_gold"."team_event_summary__dbt_tmp" rename to "team_event_summary"
[0m03:30:52.221118 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.221818 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: COMMIT
[0m03:30:52.222025 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m03:30:52.222202 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: COMMIT
[0m03:30:52.224600 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m03:30:52.225999 [debug] [Thread-5 (]: Using duckdb connection "model.f1_transform.team_event_summary"
[0m03:30:52.226297 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "model.f1_transform.team_event_summary"} */
drop table if exists "f1"."main_gold"."team_event_summary__dbt_backup" cascade
[0m03:30:52.228075 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m03:30:52.229286 [debug] [Thread-5 (]: On model.f1_transform.team_event_summary: Close
[0m03:30:52.272791 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f9c883-aef3-4f55-8aae-3da11d08872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1bcbd0>]}
[0m03:30:52.276501 [info ] [Thread-5 (]: 18 of 22 OK created sql table model main_gold.team_event_summary ............... [[32mOK[0m in 0.08s]
[0m03:30:52.280122 [debug] [Thread-5 (]: Finished running node model.f1_transform.team_event_summary
[0m03:30:52.281726 [debug] [Thread-3 (]: Began running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m03:30:52.281947 [debug] [Thread-6 (]: Began running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m03:30:52.282156 [debug] [Thread-1 (]: Began running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m03:30:52.282362 [debug] [Thread-8 (]: Began running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m03:30:52.282633 [info ] [Thread-3 (]: 19 of 22 START test not_null_team_event_summary_round .......................... [RUN]
[0m03:30:52.283015 [info ] [Thread-6 (]: 20 of 22 START test not_null_team_event_summary_season ......................... [RUN]
[0m03:30:52.283349 [info ] [Thread-1 (]: 21 of 22 START test not_null_team_event_summary_session_code ................... [RUN]
[0m03:30:52.283664 [info ] [Thread-8 (]: 22 of 22 START test not_null_team_event_summary_team ........................... [RUN]
[0m03:30:52.284033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_transform.driver_session_summary, now test.f1_transform.not_null_team_event_summary_round.bddcc074d0)
[0m03:30:52.284419 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_laps_season.6c89aefec5, now test.f1_transform.not_null_team_event_summary_season.19b7a0fa18)
[0m03:30:52.284726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71, now test.f1_transform.not_null_team_event_summary_session_code.e054c7119a)
[0m03:30:52.285028 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2, now test.f1_transform.not_null_team_event_summary_team.23b41750d4)
[0m03:30:52.285308 [debug] [Thread-3 (]: Began compiling node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m03:30:52.285587 [debug] [Thread-6 (]: Began compiling node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m03:30:52.285851 [debug] [Thread-1 (]: Began compiling node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m03:30:52.286109 [debug] [Thread-8 (]: Began compiling node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m03:30:52.288547 [debug] [Thread-3 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m03:30:52.290690 [debug] [Thread-6 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m03:30:52.292746 [debug] [Thread-1 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m03:30:52.297133 [debug] [Thread-8 (]: Writing injected SQL for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m03:30:52.298468 [debug] [Thread-3 (]: Began executing node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m03:30:52.298877 [debug] [Thread-6 (]: Began executing node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m03:30:52.303324 [debug] [Thread-3 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m03:30:52.304181 [debug] [Thread-1 (]: Began executing node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m03:30:52.304419 [debug] [Thread-8 (]: Began executing node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m03:30:52.305741 [debug] [Thread-6 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m03:30:52.307279 [debug] [Thread-1 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m03:30:52.308936 [debug] [Thread-8 (]: Writing runtime sql for node "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m03:30:52.310239 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m03:30:52.324266 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m03:30:52.332093 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m03:30:52.332343 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: BEGIN
[0m03:30:52.339264 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: BEGIN
[0m03:30:52.343884 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: BEGIN
[0m03:30:52.344161 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m03:30:52.348309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:30:52.348588 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m03:30:52.348857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:52.349546 [debug] [Thread-8 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: BEGIN
[0m03:30:52.351435 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m03:30:52.356412 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m03:30:52.356716 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m03:30:52.357017 [debug] [Thread-6 (]: SQL status: OK in 0.008 seconds
[0m03:30:52.357214 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m03:30:52.357496 [debug] [Thread-1 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"
[0m03:30:52.357750 [debug] [Thread-3 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"
[0m03:30:52.358027 [debug] [Thread-6 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"
[0m03:30:52.358276 [debug] [Thread-8 (]: Using duckdb connection "test.f1_transform.not_null_team_event_summary_team.23b41750d4"
[0m03:30:52.358564 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_code
from "f1"."main_gold"."team_event_summary"
where session_code is null



      
    ) dbt_internal_test
[0m03:30:52.358823 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_round.bddcc074d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select round
from "f1"."main_gold"."team_event_summary"
where round is null



      
    ) dbt_internal_test
[0m03:30:52.359112 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season
from "f1"."main_gold"."team_event_summary"
where season is null



      
    ) dbt_internal_test
[0m03:30:52.359372 [debug] [Thread-8 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "f1_duckdb", "target_name": "local", "node_id": "test.f1_transform.not_null_team_event_summary_team.23b41750d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team
from "f1"."main_gold"."team_event_summary"
where team is null



      
    ) dbt_internal_test
[0m03:30:52.360080 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.360330 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m03:30:52.360954 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.361132 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m03:30:52.361938 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: ROLLBACK
[0m03:30:52.362685 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: ROLLBACK
[0m03:30:52.363500 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: ROLLBACK
[0m03:30:52.364165 [debug] [Thread-8 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: ROLLBACK
[0m03:30:52.364637 [debug] [Thread-1 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a'
[0m03:30:52.365010 [debug] [Thread-3 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0'
[0m03:30:52.365289 [debug] [Thread-6 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18'
[0m03:30:52.365594 [debug] [Thread-8 (]: Failed to rollback 'test.f1_transform.not_null_team_event_summary_team.23b41750d4'
[0m03:30:52.365880 [debug] [Thread-1 (]: On test.f1_transform.not_null_team_event_summary_session_code.e054c7119a: Close
[0m03:30:52.366115 [debug] [Thread-3 (]: On test.f1_transform.not_null_team_event_summary_round.bddcc074d0: Close
[0m03:30:52.366393 [debug] [Thread-6 (]: On test.f1_transform.not_null_team_event_summary_season.19b7a0fa18: Close
[0m03:30:52.366624 [debug] [Thread-8 (]: On test.f1_transform.not_null_team_event_summary_team.23b41750d4: Close
[0m03:30:52.367028 [info ] [Thread-1 (]: 21 of 22 PASS not_null_team_event_summary_session_code ......................... [[32mPASS[0m in 0.08s]
[0m03:30:52.367430 [info ] [Thread-3 (]: 19 of 22 PASS not_null_team_event_summary_round ................................ [[32mPASS[0m in 0.08s]
[0m03:30:52.367763 [info ] [Thread-6 (]: 20 of 22 PASS not_null_team_event_summary_season ............................... [[32mPASS[0m in 0.08s]
[0m03:30:52.368376 [debug] [Thread-1 (]: Finished running node test.f1_transform.not_null_team_event_summary_session_code.e054c7119a
[0m03:30:52.368882 [info ] [Thread-8 (]: 22 of 22 PASS not_null_team_event_summary_team ................................. [[32mPASS[0m in 0.08s]
[0m03:30:52.369223 [debug] [Thread-3 (]: Finished running node test.f1_transform.not_null_team_event_summary_round.bddcc074d0
[0m03:30:52.369588 [debug] [Thread-6 (]: Finished running node test.f1_transform.not_null_team_event_summary_season.19b7a0fa18
[0m03:30:52.370052 [debug] [Thread-8 (]: Finished running node test.f1_transform.not_null_team_event_summary_team.23b41750d4
[0m03:30:52.372101 [debug] [MainThread]: Using duckdb connection "master"
[0m03:30:52.372393 [debug] [MainThread]: On master: BEGIN
[0m03:30:52.372601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:30:52.379999 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m03:30:52.380408 [debug] [MainThread]: On master: COMMIT
[0m03:30:52.380859 [debug] [MainThread]: Using duckdb connection "master"
[0m03:30:52.381149 [debug] [MainThread]: On master: COMMIT
[0m03:30:52.381769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:30:52.382053 [debug] [MainThread]: On master: Close
[0m03:30:52.383585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:30:52.383832 [debug] [MainThread]: Connection 'list_f1_main_gold' was properly closed.
[0m03:30:52.383993 [debug] [MainThread]: Connection 'list_f1_main_silver' was properly closed.
[0m03:30:52.384143 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_session_code.e054c7119a' was properly closed.
[0m03:30:52.384316 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_session_code.68938a7773' was properly closed.
[0m03:30:52.384463 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_round.bddcc074d0' was properly closed.
[0m03:30:52.384604 [debug] [MainThread]: Connection 'model.f1_transform.team_event_summary' was properly closed.
[0m03:30:52.384746 [debug] [MainThread]: Connection 'test.f1_transform.not_null_driver_session_summary_season.30188e778b' was properly closed.
[0m03:30:52.384885 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_season.19b7a0fa18' was properly closed.
[0m03:30:52.385026 [debug] [MainThread]: Connection 'test.f1_transform.not_null_results_round.69e7ee2263' was properly closed.
[0m03:30:52.385232 [debug] [MainThread]: Connection 'test.f1_transform.not_null_team_event_summary_team.23b41750d4' was properly closed.
[0m03:30:52.385854 [info ] [MainThread]: 
[0m03:30:52.386129 [info ] [MainThread]: Finished running 5 table models, 17 data tests in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m03:30:52.387739 [debug] [MainThread]: Command end result
[0m03:30:52.413805 [info ] [MainThread]: 
[0m03:30:52.414336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:30:52.414665 [info ] [MainThread]: 
[0m03:30:52.414954 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m03:30:52.418364 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0335243, "process_user_time": 2.682437, "process_kernel_time": 0.949453, "process_mem_max_rss": "248076", "process_in_blocks": "5000", "process_out_blocks": "46748"}
[0m03:30:52.420533 [debug] [MainThread]: Command `dbt build` succeeded at 03:30:52.419806 after 3.04 seconds
[0m03:30:52.422191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70f8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70f8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70f96d0>]}
[0m03:30:52.422752 [debug] [MainThread]: Flushing usage events
