{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-11-09T01:37:06.966095Z", "invocation_id": "94c57163-4a46-4a83-9348-c4a4c0792f83", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.062662Z", "completed_at": "2025-11-09T01:37:05.071592Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.083978Z", "completed_at": "2025-11-09T01:37:05.632990Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5778706073760986, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.weather", "compiled": true, "compiled_code": "with src as (\n  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)\n)\nselect\n  try_cast(season as integer) as season,\n  try_cast(round  as integer) as round,\n  cast(grand_prix as varchar) as grand_prix,\n  cast(session    as varchar) as session_code,\n  * exclude (season, round, grand_prix, session)\nfrom src", "relation_name": "\"f1\".\"main_silver\".\"weather\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.680383Z", "completed_at": "2025-11-09T01:37:05.704309Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.718954Z", "completed_at": "2025-11-09T01:37:05.766387Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.1422126293182373, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_silver\".\"weather\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.676184Z", "completed_at": "2025-11-09T01:37:05.696821Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.716751Z", "completed_at": "2025-11-09T01:37:05.773432Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14870834350585938, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_weather_season.773def5ec8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_silver\".\"weather\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.667725Z", "completed_at": "2025-11-09T01:37:05.695990Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.698402Z", "completed_at": "2025-11-09T01:37:05.781346Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.15657758712768555, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_weather_round.80e2ff036f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_silver\".\"weather\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.061711Z", "completed_at": "2025-11-09T01:37:05.071361Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.082436Z", "completed_at": "2025-11-09T01:37:05.864040Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8075900077819824, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.results", "compiled": true, "compiled_code": "with src as (\n  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)\n)\nselect\n  try_cast(season as integer) as season,\n  try_cast(round  as integer) as round,\n  cast(grand_prix as varchar) as grand_prix,\n  cast(session    as varchar) as session_code,\n  * exclude (season, round, grand_prix, session)\nfrom src", "relation_name": "\"f1\".\"main_silver\".\"results\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.868752Z", "completed_at": "2025-11-09T01:37:05.877295Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.877665Z", "completed_at": "2025-11-09T01:37:05.936157Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07354497909545898, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_results_round.69e7ee2263", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_silver\".\"results\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.873796Z", "completed_at": "2025-11-09T01:37:05.879320Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.883644Z", "completed_at": "2025-11-09T01:37:05.940053Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07539772987365723, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_results_session_code.564091e2b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_silver\".\"results\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.871706Z", "completed_at": "2025-11-09T01:37:05.879002Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.879706Z", "completed_at": "2025-11-09T01:37:05.940724Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07661747932434082, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_results_season.4571c4d0da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_silver\".\"results\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:05.058109Z", "completed_at": "2025-11-09T01:37:05.065275Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:05.065601Z", "completed_at": "2025-11-09T01:37:06.385858Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5948903560638428, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.laps", "compiled": true, "compiled_code": "with src as (\n  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)\n)\nselect\n  try_cast(season as integer) as season,\n  try_cast(round  as integer) as round,\n  cast(grand_prix as varchar) as grand_prix,\n  cast(session    as varchar) as session_code,\n  * exclude (season, round, grand_prix, session)\nfrom src", "relation_name": "\"f1\".\"main_silver\".\"laps\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.660144Z", "completed_at": "2025-11-09T01:37:06.665695Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.667144Z", "completed_at": "2025-11-09T01:37:06.680388Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.029184341430664062, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_laps_round.c55865a754", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_silver\".\"laps\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.658185Z", "completed_at": "2025-11-09T01:37:06.664430Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.665881Z", "completed_at": "2025-11-09T01:37:06.681867Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02968287467956543, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_laps_season.6c89aefec5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_silver\".\"laps\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.656085Z", "completed_at": "2025-11-09T01:37:06.663720Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.664585Z", "completed_at": "2025-11-09T01:37:06.681132Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030547618865966797, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_silver\".\"laps\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.688279Z", "completed_at": "2025-11-09T01:37:06.691740Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.691983Z", "completed_at": "2025-11-09T01:37:06.751690Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10350823402404785, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.driver_session_summary", "compiled": true, "compiled_code": "WITH laps AS (\n  SELECT * FROM \"f1\".\"main_silver\".\"laps\" WHERE laptime IS NOT NULL\n),\ndriver_base AS (\n  SELECT\n    season,\n    round,\n    grand_prix,\n    session_code,\n    COALESCE(NULLIF(driver, ''), CAST(drivernumber AS VARCHAR)) AS driver,\n    drivernumber AS driver_number,\n    team,\n    laptime,\n    pitintime,\n    pitouttime\n  FROM laps\n),\nranker AS (\n  SELECT\n    season, round, grand_prix, session_code, driver, driver_number, team, laptime,\n    ROW_NUMBER() OVER (\n      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team\n      ORDER BY laptime ASC NULLS LAST\n    ) AS rn\n  FROM driver_base\n),\npb AS (\n  SELECT\n    season, round, grand_prix, session_code, driver, driver_number, team,\n    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps\n  FROM ranker\n  GROUP BY 1,2,3,4,5,6,7\n),\nagg AS (\n  SELECT\n    season, round, grand_prix, session_code, driver, driver_number, team,\n    COUNT(*) AS laps_total,\n    SUM(CASE WHEN pitintime IS NULL AND pitouttime IS NULL THEN 1 ELSE 0 END) AS laps_on_track,\n    SUM(CASE WHEN pitintime IS NOT NULL OR  pitouttime IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,\n    MIN(laptime) AS best_lap_time\n  FROM driver_base\n  GROUP BY 1,2,3,4,5,6,7\n)\nSELECT\n  a.season, a.round, a.grand_prix, a.session_code,\n  a.driver, a.driver_number, a.team,\n  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,\n  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps\nFROM agg a\nLEFT JOIN pb\n  ON  a.season       = pb.season\n  AND a.round        = pb.round\n  AND a.grand_prix   = pb.grand_prix\n  AND a.session_code = pb.session_code\n  AND a.driver       = pb.driver\n  AND a.driver_number= pb.driver_number\n  AND a.team         = pb.team", "relation_name": "\"f1\".\"main_gold\".\"driver_session_summary\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.796930Z", "completed_at": "2025-11-09T01:37:06.806794Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.807466Z", "completed_at": "2025-11-09T01:37:06.825531Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036290645599365234, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect driver\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere driver is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.802844Z", "completed_at": "2025-11-09T01:37:06.809890Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.811769Z", "completed_at": "2025-11-09T01:37:06.826261Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.034707069396972656, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.800926Z", "completed_at": "2025-11-09T01:37:06.808541Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.810254Z", "completed_at": "2025-11-09T01:37:06.827074Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.03459429740905762, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_season.30188e778b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.799030Z", "completed_at": "2025-11-09T01:37:06.807035Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.808919Z", "completed_at": "2025-11-09T01:37:06.828374Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03775811195373535, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.834821Z", "completed_at": "2025-11-09T01:37:06.836847Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.837056Z", "completed_at": "2025-11-09T01:37:06.865992Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07921004295349121, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.team_event_summary", "compiled": true, "compiled_code": "WITH driver AS (\n  SELECT * FROM \"f1\".\"main_gold\".\"driver_session_summary\"\n),\nrace_only AS (\n  SELECT * FROM driver WHERE session_code IN ('R','Q','S')\n),\nteam_agg AS (\n  SELECT\n    season, round, grand_prix, session_code,\n    team,\n    SUM(laps_on_track) AS team_laps_on_track,\n    SUM(pitstops)      AS team_pitstops,\n    MIN(best_lap_time) AS team_best_lap_time\n  FROM race_only\n  GROUP BY 1,2,3,4,5\n)\nSELECT * FROM team_agg", "relation_name": "\"f1\".\"main_gold\".\"team_event_summary\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.918931Z", "completed_at": "2025-11-09T01:37:06.928454Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.929216Z", "completed_at": "2025-11-09T01:37:06.948862Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03500247001647949, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.920982Z", "completed_at": "2025-11-09T01:37:06.928643Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.931791Z", "completed_at": "2025-11-09T01:37:06.948235Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.034471988677978516, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_team.23b41750d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect team\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere team is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.926710Z", "completed_at": "2025-11-09T01:37:06.930405Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.932985Z", "completed_at": "2025-11-09T01:37:06.947299Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0345609188079834, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_round.bddcc074d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T01:37:06.922770Z", "completed_at": "2025-11-09T01:37:06.928983Z"}, {"name": "execute", "started_at": "2025-11-09T01:37:06.930676Z", "completed_at": "2025-11-09T01:37:06.949904Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.036966800689697266, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere season is null\n\n\n", "relation_name": null}], "elapsed_time": 2.0440733432769775, "args": {"favor_state": false, "partial_parse": true, "write_json": true, "log_path": "/opt/transform/logs", "select": [], "use_colors": true, "profiles_dir": "/opt/transform/profiles", "project_dir": "/opt/transform", "print": true, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "which": "build", "introspect": true, "partial_parse_file_diff": true, "printer_width": 80, "exclude": [], "defer": false, "send_anonymous_usage_stats": true, "strict_mode": false, "export_saved_queries": false, "empty": false, "log_level": "info", "populate_cache": true, "macro_debugging": false, "static_parser": true, "vars": {}, "resource_types": [], "show": false, "include_saved_query": false, "log_format_file": "debug", "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "show_resource_report": false, "use_colors_file": true, "quiet": false, "invocation_command": "dbt build", "enable_legacy_logger": false, "log_format": "default", "version_check": true, "exclude_resource_types": [], "require_resource_names_without_spaces": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level_file": "debug"}}