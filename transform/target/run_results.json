{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-11-09T03:30:52.386372Z", "invocation_id": "98f9c883-aef3-4f55-8aae-3da11d08872f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:50.101874Z", "completed_at": "2025-11-09T03:30:50.109316Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:50.129080Z", "completed_at": "2025-11-09T03:30:50.725476Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6334877014160156, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.weather", "compiled": true, "compiled_code": "with src as (\n  select * from read_parquet('/opt/data/bronze/weather/**/*.parquet', hive_partitioning=1)\n)\nselect\n  try_cast(season as integer) as season,\n  try_cast(round  as integer) as round,\n  cast(grand_prix as varchar) as grand_prix,\n  cast(session    as varchar) as session_code,\n  * exclude (season, round, grand_prix, session)\nfrom src", "relation_name": "\"f1\".\"main_silver\".\"weather\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:50.794643Z", "completed_at": "2025-11-09T03:30:50.840286Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:50.852669Z", "completed_at": "2025-11-09T03:30:50.937755Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.20860838890075684, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_weather_session_code.2cbdf7ee2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_silver\".\"weather\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:50.772587Z", "completed_at": "2025-11-09T03:30:50.819820Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:50.827550Z", "completed_at": "2025-11-09T03:30:50.950486Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.2582123279571533, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_weather_round.80e2ff036f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_silver\".\"weather\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:50.811298Z", "completed_at": "2025-11-09T03:30:50.860764Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:50.869682Z", "completed_at": "2025-11-09T03:30:50.973651Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.2621042728424072, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_weather_season.773def5ec8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_silver\".\"weather\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:50.100816Z", "completed_at": "2025-11-09T03:30:50.109079Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:50.127292Z", "completed_at": "2025-11-09T03:30:51.112154Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0236823558807373, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.results", "compiled": true, "compiled_code": "with src as (\n  select * from read_parquet('/opt/data/bronze/results/**/*.parquet', hive_partitioning=1)\n)\nselect\n  try_cast(season as integer) as season,\n  try_cast(round  as integer) as round,\n  cast(grand_prix as varchar) as grand_prix,\n  cast(session    as varchar) as session_code,\n  * exclude (season, round, grand_prix, session)\nfrom src", "relation_name": "\"f1\".\"main_silver\".\"results\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:51.130874Z", "completed_at": "2025-11-09T03:30:51.137250Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:51.139443Z", "completed_at": "2025-11-09T03:30:51.233729Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11121106147766113, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_results_season.4571c4d0da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_silver\".\"results\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:51.127511Z", "completed_at": "2025-11-09T03:30:51.136991Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:51.137649Z", "completed_at": "2025-11-09T03:30:51.235016Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11433291435241699, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_results_round.69e7ee2263", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_silver\".\"results\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:51.133178Z", "completed_at": "2025-11-09T03:30:51.141622Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:51.143076Z", "completed_at": "2025-11-09T03:30:51.243629Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.12014913558959961, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_results_session_code.564091e2b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_silver\".\"results\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:50.096851Z", "completed_at": "2025-11-09T03:30:50.108816Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:50.109475Z", "completed_at": "2025-11-09T03:30:51.699501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8508539199829102, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.laps", "compiled": true, "compiled_code": "with src as (\n  select * from read_parquet('/opt/data/bronze/laps/**/*.parquet', hive_partitioning=1)\n)\nselect\n  try_cast(season as integer) as season,\n  try_cast(round  as integer) as round,\n  cast(grand_prix as varchar) as grand_prix,\n  cast(session    as varchar) as session_code,\n  * exclude (season, round, grand_prix, session)\nfrom src", "relation_name": "\"f1\".\"main_silver\".\"laps\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:51.963110Z", "completed_at": "2025-11-09T03:30:51.975186Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:51.975643Z", "completed_at": "2025-11-09T03:30:52.006821Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05341339111328125, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_laps_session_code.ccd0209ff1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_silver\".\"laps\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:51.960152Z", "completed_at": "2025-11-09T03:30:51.969592Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:51.972975Z", "completed_at": "2025-11-09T03:30:52.010087Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06212759017944336, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_laps_season.6c89aefec5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_silver\".\"laps\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:51.956265Z", "completed_at": "2025-11-09T03:30:51.967681Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:51.968212Z", "completed_at": "2025-11-09T03:30:52.020875Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07488322257995605, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_laps_round.c55865a754", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_silver\".\"laps\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.032140Z", "completed_at": "2025-11-09T03:30:52.035285Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.035558Z", "completed_at": "2025-11-09T03:30:52.098661Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1117241382598877, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.driver_session_summary", "compiled": true, "compiled_code": "WITH laps AS (\n  SELECT * FROM \"f1\".\"main_silver\".\"laps\" WHERE laptime IS NOT NULL\n),\ndriver_base AS (\n  SELECT\n    season,\n    round,\n    grand_prix,\n    session_code,\n    COALESCE(NULLIF(driver, ''), CAST(drivernumber AS VARCHAR)) AS driver,\n    drivernumber AS driver_number,\n    team,\n    laptime,\n    pitintime,\n    pitouttime\n  FROM laps\n),\nranker AS (\n  SELECT\n    season, round, grand_prix, session_code, driver, driver_number, team, laptime,\n    ROW_NUMBER() OVER (\n      PARTITION BY season, round, grand_prix, session_code, driver, driver_number, team\n      ORDER BY laptime ASC NULLS LAST\n    ) AS rn\n  FROM driver_base\n),\npb AS (\n  SELECT\n    season, round, grand_prix, session_code, driver, driver_number, team,\n    SUM(CASE WHEN rn = 1 THEN 1 ELSE 0 END) AS personal_best_laps\n  FROM ranker\n  GROUP BY 1,2,3,4,5,6,7\n),\nagg AS (\n  SELECT\n    season, round, grand_prix, session_code, driver, driver_number, team,\n    COUNT(*) AS laps_total,\n    SUM(CASE WHEN pitintime IS NULL AND pitouttime IS NULL THEN 1 ELSE 0 END) AS laps_on_track,\n    SUM(CASE WHEN pitintime IS NOT NULL OR  pitouttime IS NOT NULL THEN 1 ELSE 0 END) AS pitstops,\n    MIN(laptime) AS best_lap_time\n  FROM driver_base\n  GROUP BY 1,2,3,4,5,6,7\n)\nSELECT\n  a.season, a.round, a.grand_prix, a.session_code,\n  a.driver, a.driver_number, a.team,\n  a.laps_total, a.laps_on_track, a.pitstops, a.best_lap_time,\n  COALESCE(pb.personal_best_laps, 0) AS personal_best_laps\nFROM agg a\nLEFT JOIN pb\n  ON  a.season       = pb.season\n  AND a.round        = pb.round\n  AND a.grand_prix   = pb.grand_prix\n  AND a.session_code = pb.session_code\n  AND a.driver       = pb.driver\n  AND a.driver_number= pb.driver_number\n  AND a.team         = pb.team", "relation_name": "\"f1\".\"main_gold\".\"driver_session_summary\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.152230Z", "completed_at": "2025-11-09T03:30:52.159755Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.161826Z", "completed_at": "2025-11-09T03:30:52.183013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04074835777282715, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_round.ff7c8fdb71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.149438Z", "completed_at": "2025-11-09T03:30:52.159274Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.160087Z", "completed_at": "2025-11-09T03:30:52.186052Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.04340720176696777, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_driver.2e5c4ae4e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect driver\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere driver is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.154624Z", "completed_at": "2025-11-09T03:30:52.161369Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.163144Z", "completed_at": "2025-11-09T03:30:52.185366Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.04202628135681152, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_season.30188e778b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.156805Z", "completed_at": "2025-11-09T03:30:52.161673Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.164364Z", "completed_at": "2025-11-09T03:30:52.186759Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04307222366333008, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_driver_session_summary_session_code.68938a7773", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_gold\".\"driver_session_summary\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.194392Z", "completed_at": "2025-11-09T03:30:52.196558Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.196833Z", "completed_at": "2025-11-09T03:30:52.229219Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07872438430786133, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.f1_transform.team_event_summary", "compiled": true, "compiled_code": "WITH driver AS (\n  SELECT * FROM \"f1\".\"main_gold\".\"driver_session_summary\"\n),\nrace_only AS (\n  SELECT * FROM driver WHERE session_code IN ('R','Q','S')\n),\nteam_agg AS (\n  SELECT\n    season, round, grand_prix, session_code,\n    team,\n    SUM(laps_on_track) AS team_laps_on_track,\n    SUM(pitstops)      AS team_pitstops,\n    MIN(best_lap_time) AS team_best_lap_time\n  FROM race_only\n  GROUP BY 1,2,3,4,5\n)\nSELECT * FROM team_agg", "relation_name": "\"f1\".\"main_gold\".\"team_event_summary\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.290943Z", "completed_at": "2025-11-09T03:30:52.304047Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.306127Z", "completed_at": "2025-11-09T03:30:52.361866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08227276802062988, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_session_code.e054c7119a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_code\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere session_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.286340Z", "completed_at": "2025-11-09T03:30:52.298398Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.299044Z", "completed_at": "2025-11-09T03:30:52.362628Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08343815803527832, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_round.bddcc074d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect round\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere round is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.288848Z", "completed_at": "2025-11-09T03:30:52.298797Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.304792Z", "completed_at": "2025-11-09T03:30:52.363439Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08334469795227051, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_season.19b7a0fa18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect season\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere season is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-09T03:30:52.295432Z", "completed_at": "2025-11-09T03:30:52.304370Z"}, {"name": "execute", "started_at": "2025-11-09T03:30:52.307957Z", "completed_at": "2025-11-09T03:30:52.364111Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.08384561538696289, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.f1_transform.not_null_team_event_summary_team.23b41750d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect team\nfrom \"f1\".\"main_gold\".\"team_event_summary\"\nwhere team is null\n\n\n", "relation_name": null}], "elapsed_time": 2.5142366886138916, "args": {"empty": false, "include_saved_query": false, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "version_check": true, "require_resource_names_without_spaces": false, "log_level_file": "debug", "use_colors_file": true, "quiet": false, "macro_debugging": false, "use_colors": true, "strict_mode": false, "profiles_dir": "/opt/transform/profiles", "write_json": true, "vars": {}, "partial_parse": true, "print": true, "log_file_max_bytes": 10485760, "log_path": "/opt/transform/logs", "which": "build", "exclude_resource_types": [], "show": false, "exclude": [], "log_format_file": "debug", "send_anonymous_usage_stats": true, "cache_selected_only": false, "select": [], "source_freshness_run_project_hooks": false, "enable_legacy_logger": false, "show_resource_report": false, "log_level": "info", "resource_types": [], "partial_parse_file_diff": true, "indirect_selection": "eager", "invocation_command": "dbt build", "log_format": "default", "defer": false, "project_dir": "/opt/transform", "static_parser": true, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "export_saved_queries": false, "favor_state": false}}